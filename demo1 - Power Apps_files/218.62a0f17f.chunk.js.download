/*! For license information please see 218.62a0f17f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{5824:function(e,t,r){"use strict";function i(e){return!!e&&"loaded"===e.loadingState}function n(e){return!!e&&"loading"===e.loadingState}function o(e){return!!e&&"notStarted"===e.loadingState}function s(e){return!!e&&"loadError"===e.loadingState}function a(e){return!!e&&"notFound"===e.loadingState}function l(e){return o(e)||s(e)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return{loadingState:"loaded",timeLoaded:t,value:e}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return{loadingState:"loading",timeLoadStarted:e}}r.r(t),r.d(t,"isLoaded",(function(){return i})),r.d(t,"isLoading",(function(){return n})),r.d(t,"isNotStarted",(function(){return o})),r.d(t,"isLoadError",(function(){return s})),r.d(t,"isNotFound",(function(){return a})),r.d(t,"needsLoading",(function(){return l})),r.d(t,"loaded",(function(){return c})),r.d(t,"loading",(function(){return d})),r.d(t,"notStarted",(function(){return p})),r.d(t,"loadError",(function(){return u})),r.d(t,"notFound",(function(){return m})),r.d(t,"mutateLoaded",(function(){return h})),r.d(t,"mapLoaded",(function(){return b})),r.d(t,"defaultLoaded",(function(){return g})),r.d(t,"shouldReload",(function(){return f}));var p={loadingState:"notStarted"};function u(e){return{loadingState:"loadError",error:e}}var m={loadingState:"notFound"};function h(e,t){return i(e)?c(t(e.value),e.timeLoaded):e}function b(e,t,r){return i(e)?t(e.value):r}function g(e,t){return b(e,e=>e,t)}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return o(e)||i(e)&&Date.now()-e.timeLoaded<t}},5826:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetDesignerComponents",(function(){return P})),r.d(t,"OptionSetDesignerLoading",(function(){return j})),r.d(t,"OptionSetDesignerLoadError",(function(){return M})),r.d(t,"OptionSetDesigner",(function(){return C}));var i=r(5827),n=r(5829),o=r(5824),s=r(5833),a=r(5834),l=r(5836),c=r(922),d=r(2812),p=r(1573),u=r(1201),m=r(719),h=r(245),b=r(5837),g=r(5844),f=r(5861),v=r(5857);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=Object(m.mergeStyles)({selectors:{"h2.ba-Panel-headerText":{overflowX:"hidden"}}});class N extends h.PureComponent{constructor(e){super(e),this.fetchData=e=>{Object(o.isNotStarted)(this.props.optionSet)?e():Object(o.isLoaded)(this.props.optionSet)&&this.setState({optionSetInProgress:this.props.optionSet.value,originalOptionSet:this.props.optionSet.value,hasBeenModified:!1,explicitChanges:{name:!1,displayName:!1}})},this.fetchOptionSetNameList=e=>{Object(o.isNotStarted)(this.props.optionSetNameList)&&e()},this.prepareComponents=()=>{var{originalOptionSet:e,optionSetInProgress:t}=this.state;if(e&&t)return P(y(y({},this.props),{},{originalOptionSet:e,optionSetInProgress:t,hasBeenModified:this.state.hasBeenModified,onChanged:this.onChanged,onPrepareSave:this.onPrepareSave,memberOpen:this.state.memberOpen}));var{optionSet:r}=this.props;return Object(o.isLoadError)(r)?M(this.props,r.error):j(this.props)},this.onChanged=e=>{if(e.members&&(e.members.some(e=>{if(e.isOpen)return this.setState({memberOpen:!0}),!0})||this.setState({memberOpen:!1})),this.state.originalOptionSet){var t={name:this.state.explicitChanges.name||void 0!==e.name,displayName:this.state.explicitChanges.displayName||void 0!==e.displayName};""===this.state.originalOptionSet.metadataId&&(e.hasOwnProperty("name")||e.hasOwnProperty("displayName"))&&(e=y(y({},e),Object(s.withExplicitNames)(e,t,!0)));var r=y(y({},this.state.optionSetInProgress),e),i=!Object(d.isEqual)(this.state.originalOptionSet,r);this.setState({optionSetInProgress:r,explicitChanges:t,hasBeenModified:i})}else{var n={name:this.state.explicitChanges.name||void 0!==e.name,displayName:this.state.explicitChanges.displayName||void 0!==e.displayName};(e.hasOwnProperty("name")||e.hasOwnProperty("displayName"))&&(e=y(y({},e),Object(s.withExplicitNames)(e,n))),this.setState(t=>({optionSetInProgress:y(y({},t.optionSetInProgress),e),explicitChanges:n,hasBeenModified:!0}))}},this.onPrepareSave=()=>{this.state.optionSetInProgress&&this.props.onSave&&this.props.onUpdate&&(this.state.originalOptionSet&&""===this.state.originalOptionSet.name?this.props.onSave(this.state.optionSetInProgress):this.props.onUpdate(this.state.optionSetInProgress,this.state.originalOptionSet))},this.onDismissed=()=>{this.props.telemetryCallbacks.logData({eventName:v.OptionSetDesignerTelemetryEventsMap.EnumerationDismiss,data:{}}),this.setState({originalOptionSet:void 0,optionSetInProgress:void 0,hasBeenModified:!1})},this.state={originalOptionSet:void 0,optionSetInProgress:void 0,hasBeenModified:!1,explicitChanges:{name:!1,displayName:!1},memberOpen:!1}}componentDidMount(){this.props.onFetch&&this.fetchData(this.props.onFetch),this.props.onFetchOptionSetNameList&&this.fetchOptionSetNameList(this.props.onFetchOptionSetNameList)}componentDidUpdate(e){this.props.cdsDesigner&&Object(o.isNotStarted)(e.optionSet)&&Object(o.isLoaded)(this.props.optionSet)&&this.setState({optionSetInProgress:this.props.optionSet.value,originalOptionSet:this.props.optionSet.value,hasBeenModified:!1,explicitChanges:{name:!1,displayName:!1}})}UNSAFE_componentWillReceiveProps(e){this.props.designerContext===e.designerContext&&this.props.optionSet===e.optionSet||!e.onFetch||(e.onFetch&&this.fetchData(e.onFetch),e.onFetchOptionSetNameList&&this.fetchOptionSetNameList(e.onFetchOptionSetNameList))}componentWillUnmount(){this.setState({originalOptionSet:void 0,optionSetInProgress:void 0,hasBeenModified:!1,explicitChanges:{name:!1,displayName:!1},memberOpen:!1})}render(){var e=this.prepareComponents();if(this.props.formAdapter){var t=this.props.formAdapter;return h.createElement(t,{form:e})}var r=Object(l.wizardPanelPageFormAdapter)(e);return h.createElement(a.WizardPanel,{hidden:"empty"===this.props.designerContext,currentPageKey:"optionset",labels:{closeButtonAriaLabel:this.props.t("Words.cancel")},type:p.PanelType.smallFixedFar,className:D,onDismiss:this.props.onDismiss,onDismissed:this.onDismissed,disableOnLoadAnimation:this.props.disableOnLoadAnimation,isLoading:this.props.isLoading},h.createElement(a.WizardPanelPage,O({},r,{pageKey:"optionset"})))}}function P(e){return{title:Object(f.OptionSetDesignerTitle)(e),description:h.createElement(i.CollapsibleNotificationBar,{notifications:e.notifications,closeAriaLabel:e.t("Words.close"),onDismiss:e.onClearError}),contents:h.createElement(g.OptionSetDesignerContents,e),commands:Object(b.OptionSetDesignerCommands)(e)}}function j(e){return{title:Object(f.OptionSetDesignerLoadingTitle)(e),description:null,contents:h.createElement(n.Stack,{className:"OptionSetDesigner-Loading"},h.createElement(u.Spinner,{size:u.SpinnerSize.medium}))}}function M(e,t){return{title:"Whoops...",description:null,contents:h.createElement("p",{style:{color:"red"}},"There was an error when trying to load the option set: ",t.message)}}var C=Object(c.translateService)("OptionSetDesigner")(N)},5827:function(e,t,r){"use strict";r.r(t),r.d(t,"CollapsibleNotificationBar",(function(){return c}));var i=r(1697),n=r(245),o=r.n(n),s=r(5828),a=r(5832),l=r(5831);class c extends o.a.PureComponent{constructor(){super(...arguments),this.onRenderNotificationBar=(e,t)=>e?o.a.createElement(i.MessageBar,{styles:{root:{marginTop:"14px",marginLeft:"-12px",width:"calc(100% + 24px)"}},className:"WizardPanel-Header-Description",messageBarType:e.notification.type,isMultiline:!1,truncated:!0,onDismiss:Object(a.generateOnDismiss)(this.props.onDismiss,e.notificationIndex,e.notification.isUndismissable)},o.a.createElement(l.SingleNotificationBarMessageContents,{notification:e.notification})):t?t(e):null}render(){var{notifications:e,notificationMode:t,closeAriaLabel:r,onDismiss:i}=this.props;return e.length<=0?null:o.a.createElement(s.NotificationBar,{notifications:e,notificationMode:t,closeAriaLabel:r,onDismiss:i,onRenderNotificationBar:this.onRenderNotificationBar})}}},5828:function(e,t,r){"use strict";r.r(t),r.d(t,"NotificationBar",(function(){return a}));var i=r(245),n=r(5829),o=r(5830),s=r(5831),a=e=>{var{notifications:t,notificationMode:r,closeAriaLabel:a,onRenderNotificationBar:l,onDismiss:c}=e;if(0===t.length)return null;var d=e=>({notification:t[e],notificationIndex:e,closeAriaLabel:a,onDismiss:c});switch(r){case o.NotificationMode.Oldest:var p=d(0);return l?l(p,s.SingleNotificationBar):i.createElement(s.SingleNotificationBar,p);case o.NotificationMode.Newest:var u=d(t.length-1);return l?l(u,s.SingleNotificationBar):i.createElement(s.SingleNotificationBar,u);case o.NotificationMode.AllDescending:return i.createElement(n.Stack,null,t.map((e,r)=>{var n=d(t.length-(r+1));return l?l(n,s.SingleNotificationBar):i.createElement(s.SingleNotificationBar,n)}));default:return i.createElement(n.Stack,null,t.map((e,t)=>{var r=d(t);return l?l(r,s.SingleNotificationBar):i.createElement(s.SingleNotificationBar,r)}))}}},5830:function(e,t,r){"use strict";var i;r.r(t),r.d(t,"NotificationMode",(function(){return i})),function(e){e[e.Oldest=0]="Oldest",e[e.Newest=1]="Newest",e[e.All=2]="All",e[e.AllDescending=3]="AllDescending"}(i||(i={}))},5831:function(e,t,r){"use strict";r.r(t),r.d(t,"SingleNotificationBar",(function(){return l})),r.d(t,"SingleNotificationBarMessageContents",(function(){return c}));var i=r(1090),n=r(1697),o=r(245),s=r.n(o),a=r(5832),l=e=>{var{notification:t,notificationIndex:r,closeAriaLabel:i,onDismiss:o}=e;return s.a.createElement(n.MessageBar,{role:"alert",isMultiline:!0,className:"MessageBar",messageBarType:t.type,dismissButtonAriaLabel:i,onDismiss:Object(a.generateOnDismiss)(o,r,t.isUndismissable)},s.a.createElement(c,{notification:t}))},c=e=>{var{notification:t}=e,{contents:r,link:n}=t;return s.a.createElement(s.a.Fragment,null,r,n?s.a.createElement(i.Link,{href:n.address,target:"_blank"},n.text):null)}},5832:function(e,t,r){"use strict";r.r(t),r.d(t,"generateOnDismiss",(function(){return i}));var i=(e,t,r)=>r?void 0:()=>e&&e(t)},5834:function(e,t,r){"use strict";r.r(t),r.d(t,"WizardPanelPage",(function(){return u})),r.d(t,"WizardPanel",(function(){return m}));var i=r(4013),n=r(2903),o=r(1573),s=r(245),a=r(5835),l=r(1201);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends s.Component{static isWizardPanelPage(e){var t=e;return void 0!==Object(a.pipeIf)(t.props,e=>e.pageKey)}constructor(e){super(e),this.props=e}render(){return s.createElement("div",{role:"presentation",className:Object(n.css)("WizardPanel-Page")},this.props.children)}}class m extends s.Component{constructor(e){super(e),this.props=e,this.currentPage=()=>{var{children:e,currentPageKey:t}=this.props;return s.Children.toArray(e).find(e=>u.isWizardPanelPage(e)&&e.props.pageKey===t)},this.onRenderDescription=(e,t)=>{var r=this.currentPage();if(!e||!r||!r.props.description)return null;var{headerClassName:i}=this.props;return s.createElement("div",{role:"presentation",className:Object(n.css)("WizardPanel-Header",i)},m.renderDescription(r.props.description))},this.footerButtons=()=>{var e=this.currentPage();return e&&e.props.footerButtons&&e.props.footerButtons.map(e=>d(d({},e),{},{dismissableOnClick:e.onClick,primary:e.isPrimary,disabled:e.isDisabled}))},this.onDismissal=()=>{var{onDismissal:e}=this.props;(!e||e())&&this.onDismiss()},this.onLightDismissal=()=>{var{onLightDismissal:e}=this.props;(!e||e())&&this.onDismiss()},this.onDismiss=()=>{var{onDismiss:e}=this.props;e&&e()}}render(){var e=this.props,t=this.currentPage();return s.createElement(i.Panel,{loadingOverlay:this.props.isLoading?{spinnerProps:{size:l.SpinnerSize.large}}:void 0,styles:this.props.disableOnLoadAnimation?{main:{animation:"none"}}:void 0,className:Object(n.css)("WizardPanel",e.className),closeButtonAriaLabel:e.labels.closeButtonAriaLabel,closeButtonType:i.PanelCloseButtonType.Close,dismissOnEscape:!1,footerButtons:this.footerButtons(),hasCloseButton:!0,headerText:t&&t.props.title,isFooterAtBottom:!0,isHiddenOnDismiss:!1,isLightDismiss:!!e.onLightDismissal,isOpen:!e.hidden,onDismiss:this.onDismissal,onDismissed:e.onDismissed,onLightDismissClick:this.onLightDismissal,onRenderSubHeader:this.onRenderDescription,type:e.type||o.PanelType.medium,messageBar:e.messageBar},e.hidden?null:t)}static renderDescription(e){return"string"==typeof e?s.createElement("p",{className:"WizardPanel-Header-Description"},e):e}}},5836:function(e,t,r){"use strict";function i(e){return{title:e.title,description:e.description,children:e.contents,footerButtons:e.commands&&e.commands.map(n)}}function n(e){return{text:e.label,isPrimary:e.isPrimary,isDisabled:e.isDisabled,onClick:e.onAction}}r.r(t),r.d(t,"wizardPanelPageFormAdapter",(function(){return i})),r.d(t,"wizardPanelPageFooterButtonFormCommandAdapter",(function(){return n}))},5837:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetDesignerCommands",(function(){return o}));var i=r(5824),n=r(5838);function o(e){var{optionSetInProgress:t,hasBeenModified:r,onDismiss:o,onPrepareSave:s,t:a,optionSetNameList:l,environmentNamePrefix:c,originalOptionSet:d,memberOpen:p,isLoading:u}=e,m=Object(n.getValidationLabels)(a);return[{label:a("Words.save"),isPrimary:!0,isDisabled:u||p||!r||!Object(n.validateAll)(m)(t,l||Object(i.loaded)([]),c,d.name).overallSuccess,onAction:s},{label:a("Words.cancel"),onAction:o}]}},5838:function(e,t,r){"use strict";r.r(t),r.d(t,"validateAll",(function(){return d})),r.d(t,"validateName",(function(){return p})),r.d(t,"validateDisplayName",(function(){return u})),r.d(t,"validateDescription",(function(){return m})),r.d(t,"doesStartWithALetterAndIsAlphanumeric",(function(){return h})),r.d(t,"getValidationLabels",(function(){return g}));var i=r(5824),n=r(5825),o=r(5839),s=r(5840),a=r(5841),l=r(5842),c=r(5843),d=e=>(t,r,i,n)=>Object(c.validate)({displayName:{value:t.displayName,validator:u(e)},name:{value:t.name,validator:p(e,!t.metadataId,r,i,n)},description:{value:t.description,validator:m(e)}}),p=(e,t,r,a,d)=>{var p;return p=Object(i.isLoaded)(r)?r.value:[],Object(c.iff)(Object(o.constant)(t),Object(c.and)(Object(c.validator)({condition:l.isNotBlank,errorMessage:Object(n.formatString)(e.requiredFieldError,e.name)}),Object(c.validator)({condition:Object(l.isBelowMaxLength)(s.optionSetNameMax),errorMessage:Object(n.formatString)(e.maxLengthExceededError,e.name,s.optionSetNameMax.toString())}),Object(c.validator)({condition:h,errorMessage:e.nameMustStartWithLetterAndBeAlphanumeric}),Object(c.validator)({condition:b(p,a,d),errorMessage:e.nameMustBeUnique})))},u=e=>Object(c.and)(Object(c.validator)({condition:l.isNotBlank,errorMessage:Object(n.formatString)(e.requiredFieldError,e.displayName)}),Object(c.validator)({condition:Object(l.isBelowMaxLength)(s.optionSetDisplayNameMax),errorMessage:Object(n.formatString)(e.maxLengthExceededError,e.displayName,s.optionSetDisplayNameMax.toString())})),m=e=>Object(c.validator)({condition:Object(l.isBelowMaxLength)(s.descriptionMax),errorMessage:Object(n.formatString)(e.maxLengthExceededError,e.description,s.descriptionMax.toString())}),h=e=>Object(a.matches)(/^[A-Za-z]\w*$/)(e),b=(e,t,r)=>i=>{i=i.toLowerCase(),t=t.toLowerCase();var n=i.startsWith(t)?i:t+i,o=!!r&&n===r.toLowerCase(),s=-1!==e.indexOf(n);return o||!s};function g(e){return{requiredFieldError:e("Error.requiredFieldError"),maxLengthExceededError:e("Error.maxLengthExceededError"),nameMustStartWithLetterAndBeAlphanumeric:e("Error.mustStartWithLetterAndContinue"),nameMustBeUnique:e("Error.duplicateNameChoice"),name:e("Words.name").toLowerCase(),displayName:e("Words.displayName").toLowerCase(),description:e("Words.description").toLowerCase()}}},5839:function(e,t,r){"use strict";function i(e,t,r){return e===t||e.length===t.length&&e.every((e,i)=>r(e,t[i]))}function n(e){return arguments.length>0?()=>e:()=>{}}r.r(t),r.d(t,"arrayEquals",(function(){return i})),r.d(t,"constant",(function(){return n}))},5840:function(e,t,r){"use strict";r.r(t),r.d(t,"optionSetNameMax",(function(){return i})),r.d(t,"optionSetDisplayNameMax",(function(){return n})),r.d(t,"optionSetMemberLabelMax",(function(){return o})),r.d(t,"descriptionMax",(function(){return s}));var i=41,n=41,o=70,s=300},5841:function(e,t,r){"use strict";r.r(t),r.d(t,"matches",(function(){return n})),r.d(t,"createPrefixedLocalOptionSetName",(function(){return o}));var i=r(5825),n=e=>t=>e.test(t);function o(e,t,r){if(e){var n=Object(i.applyPrefixToString)(e,t+"_",!0);return Object(i.applyPrefixToString)(n,r,!0)}return""}},5842:function(e,t,r){"use strict";function i(e){return void 0!==e}r.r(t),r.d(t,"isNotUndefined",(function(){return i})),r.d(t,"isNotBlank",(function(){return n})),r.d(t,"isBelowMaxLength",(function(){return o}));var n=e=>i(e)&&e.trim().length>0,o=e=>t=>!t||t.length<=e},5843:function(e,t,r){"use strict";function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var t={},r=!0;return Object.keys(e).forEach(i=>{var n=e[i],o=n.validator(n.value);t[i]=o,o.success||(r=!1)}),{overallSuccess:r,results:t}}function a(e){return s({validation:e}).results.validation}function l(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>t.reduce((t,r)=>t.success?m(r)(e):t,{success:!0})}function c(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{var r={success:!1};for(var i of t)if((r=m(i)(e)).success)return r;return r}}function d(e){return t=>({success:!m(e)(t).success})}function p(e,t,r){return u(d(e),t,r)}function u(e,t,r){return i=>m(e)(i).success?m(t)(i):r?m(r)(i):{success:!0}}function m(e){return t=>{var r=e(t);return"boolean"==typeof r?{success:r}:r}}function h(e,t){return r=>{var i=m(e)(r);return n(n({},i),{},{error:i.error||!i.success?i.error||t:void 0})}}r.r(t),r.d(t,"validate",(function(){return s})),r.d(t,"validateSingle",(function(){return a})),r.d(t,"and",(function(){return l})),r.d(t,"or",(function(){return c})),r.d(t,"not",(function(){return d})),r.d(t,"unless",(function(){return p})),r.d(t,"iff",(function(){return u})),r.d(t,"lift",(function(){return m})),r.d(t,"onError",(function(){return h})),r.d(t,"validator",(function(){return b}));var b=e=>h(e.condition,e.errorMessage)},5844:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetDesignerContents",(function(){return u}));var i=r(5829),n=r(245),o=r(5845),s=r(5846),a=r(5848),l=r(5855);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends n.PureComponent{constructor(){super(...arguments),this.mapMembersForCreator=()=>{var{optionSetInProgress:e,designerContext:t}=this.props;return e.members.map(r=>{var i;return{memberKey:r.value,displayName:r.displayName,isManaged:r.isManaged,value:r.value,isNewMember:(null==e||null===(i=e.members)||void 0===i?void 0:i.length)>1&&("create"===t||this.isMemberNew(r))}})},this.isMemberNew=e=>!this.props.originalOptionSet.members.find(t=>t.value===e.value),this.isOptionSetCreatorDisabled=()=>{var{readonly:e,disableEditsForMissingUpdatePrivilege:t}=this.props,{isCustomizable:r}=this.props.optionSetInProgress;return!!e||t||!(r&&r.value)},this.interceptAdd=e=>d(d({},e),this.generateNewMember()),this.generateNewMember=()=>({value:this.nextMemberValue(),name:this.props.t("OptionSets.defaultItem")}),this.nextMemberValue=()=>{var{optionSetInProgress:e,optionSetValuePrefix:t}=this.props,r=1e4*t;if(e.members.length>0){for(var i=function(t){if(!e.members.find(e=>e.value===t))return{v:t}},n=r;n<r+9999;n++){var o=i(n);if("object"==typeof o)return o.v}return r+9999}return r},this.onMembersChanged=e=>{var t=e.map(e=>({displayName:e.displayName,value:e.value,isManaged:e.isManaged,isOpen:e.isOpen}));Object(o.todov)({},"Need to handle diffing member differences"),this.props.onChanged({members:t})},this.valueValidator=e=>{var{t:t}=this.props,r=t("OptionSetMember.value");return Object(s.makeValueValidator)(e,this.props,this.props.optionSetValuePrefix,{value:r&&r.toLowerCase(),requiredFieldError:t("Error.requiredFieldError"),duplicateValueError:t("OptionSetMember.ChoiceError.duplicateValue"),outOfRangeError:t("OptionSetMember.ChoiceError.outOfRange")})}}render(){return n.createElement(i.Stack,{className:"OptionSetDesigner-Contents"},n.createElement(a.OptionSetDesignerDetails,this.props),n.createElement(l.OptionSetCreator,{minimalMode:this.props.optionSetInProgress.isBoolean,members:this.mapMembersForCreator(),isDisabled:this.isOptionSetCreatorDisabled(),t:this.props.t,tReady:this.props.tReady,interceptAdd:this.interceptAdd,onChanged:this.onMembersChanged,optionSetValueValidator:this.valueValidator(this.props.optionSetInProgress),telemetryCallbacks:this.props.telemetryCallbacks}))}}},5845:function(e,t,r){"use strict";r.r(t),r.d(t,"enableTodoMessages",(function(){return i})),r.d(t,"shown",(function(){return n})),r.d(t,"todov",(function(){return o}));var i=!1,n=new Set;function o(e,t){return i&&!n.has(t)&&(console.error("TODO: ",t),n.add(t)),e}},5846:function(e,t,r){"use strict";r.r(t),r.d(t,"validateMemberName",(function(){return d})),r.d(t,"makeValueValidator",(function(){return p}));var i=r(5825),n=r(2867),o=r(5839),s=r(5840),a=r(5847),l=r(5842),c=r(5843),d=e=>Object(c.and)(Object(c.validator)({condition:l.isNotBlank,errorMessage:Object(i.formatString)(e.requiredFieldError,e.name)}),Object(c.validator)({condition:Object(l.isBelowMaxLength)(s.optionSetMemberLabelMax),errorMessage:Object(i.formatString)(e.maxLengthExceededError,e.name,s.optionSetMemberLabelMax.toString())}));function p(e,t,r,s){return function(t){var l=e&&Object(a.isWithinPrefixRange)(r)||Object(o.constant)(!0),d=1e4*r,p=new Intl.NumberFormat,u=Object(i.formatString)(s.outOfRangeError,p.format(d),p.format(d+9999)),m=Object(n.Map)();for(var h of e.members)m=m.set(h.value,void 0);var b=e&&Object(a.isNotDuplicateValue)(m,t)||Object(o.constant)(!0);return Object(c.and)(Object(c.onError)(e=>void 0!==e,Object(i.formatString)(s.requiredFieldError,s.value)),Object(c.onError)(b,s.duplicateValueError),Object(c.onError)(l,u))}}},5847:function(e,t,r){"use strict";r.r(t),r.d(t,"isNotDuplicateValue",(function(){return i})),r.d(t,"isWithinPrefixRange",(function(){return n}));var i=(e,t)=>r=>r===t||!e.has(r),n=e=>t=>{var r=1e4*e;return t>=r&&t<=r+9999}},5848:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetDesignerDetails",(function(){return h}));var i=r(5849),n=r(5829),o=r(5824),s=r(5833),a=r(5854),l=r(1368),c=r(1429),d=r(245),p=r(5840),u=r(5838),m=r(5843);class h extends d.PureComponent{constructor(){super(...arguments),this.onChanged=e=>t=>this.props.onChanged({[e]:t}),this.onDisplayNameChanged=this.onChanged("displayName"),this.onNameChanged=e=>{this.props.onChanged({name:e.toLowerCase()})},this.onDescriptionChanged=this.onChanged("description"),this.onScopeChanged=(e,t)=>t&&this.onChanged("scope")(t.key),this.isLocalOptionSet=()=>"local"===this.props.optionSetInProgress.scope,this.onValidateDisplayName=e=>{var{t:t}=this.props,r=Object(u.getValidationLabels)(t);return Object(m.validateSingle)({value:e,validator:Object(u.validateDisplayName)(r)}).error||""},this.onValidateName=e=>{var{t:t}=this.props,r=Object(u.getValidationLabels)(t);return Object(m.validateSingle)({value:e,validator:Object(u.validateName)(r,!this.props.optionSetInProgress.metadataId,this.props.optionSetNameList||Object(o.loaded)([]),this.props.environmentNamePrefix,this.props.originalOptionSet.name)}).error||""},this.onValidateDescription=e=>{var{t:t}=this.props,r=Object(u.getValidationLabels)(t);return Object(m.validateSingle)({value:e,validator:Object(u.validateDescription)(r)}).error||""}}render(){var{optionSetInProgress:e,environmentNamePrefix:t,designerContext:r,t:o}=this.props;return d.createElement(n.Stack,{className:"OptionSetDesigner-Details"},d.createElement(c.TextField,{className:"OptionSetDesigner-DisplayNameField",required:!0,validateOnLoad:!1,label:o("Words.displayName"),maxLength:p.optionSetDisplayNameMax,disabled:this.isDisplayNameDisabled,value:e.displayName,onGetErrorMessage:this.onValidateDisplayName,onChange:(e,t)=>this.onDisplayNameChanged(t||"")}),d.createElement(i.MaybePrefixedTextBlock,{className:"OptionSetDesigner-NameField",required:!0,validateOnLoad:!1,label:o("Words.name"),prefix:Object(s.makePrefixFromName)(e,"create"===r,t),styles:{root:{marginTop:8,marginBottom:8}},maxLength:p.optionSetNameMax,disabled:this.isNameDisabled,value:e.name,onGetErrorMessage:this.onValidateName,onChange:(e,t)=>this.onNameChanged(t||"")}),d.createElement(a.ViewMore,{className:"OptionSetDesigner-ViewMore",viewMoreLabel:o("OptionSets.viewMore"),viewLessLabel:o("OptionSets.viewLess")},d.createElement(c.TextField,{className:"OptionSetDesigner-DescriptionField",multiline:!0,rows:4,validateOnLoad:!1,label:o("Words.description"),maxLength:p.descriptionMax,disabled:this.isDescriptionDisabled,value:e.description,onGetErrorMessage:this.onValidateDescription,onChange:(e,t)=>this.onDescriptionChanged(t||"")}),!this.isScopeHidden&&d.createElement(l.ChoiceGroup,{className:"OptionSetDesigner-ScopeField",disabled:this.isScopeDisabled,selectedKey:e.scope,options:[{key:"global",text:o("OptionSets.globalChoice")},{key:"local",text:o("OptionSets.localChoice")}],onChange:this.onScopeChanged})))}get isDisplayNameDisabled(){var{readonly:e,disableEditsForMissingUpdatePrivilege:t}=this.props,{isCustomizable:r}=this.props.optionSetInProgress;return!!e||t||!(r&&r.value)||this.isLocalOptionSet()}get isNameDisabled(){var{designerContext:e,readonly:t,disableEditsForMissingUpdatePrivilege:r}=this.props;return!!t||r||"create"!==e||this.isLocalOptionSet()}get isDescriptionDisabled(){var{readonly:e,disableEditsForMissingUpdatePrivilege:t}=this.props,{isCustomizable:r}=this.props.optionSetInProgress;return!!e||t||!(r&&r.value)||this.isLocalOptionSet()}get isScopeHidden(){var{fieldContext:e}=this.props;return!e}get isScopeDisabled(){var{designerContext:e,fieldContext:t,readonly:r,disableEditsForMissingUpdatePrivilege:i}=this.props;return!!r||i||"create"!==e||!t}}},5854:function(e,t,r){"use strict";r.r(t),r.d(t,"ViewMore",(function(){return l}));var i=r(2903),n=r(687),o=r(1090),s=r(245),a=r(5829);class l extends s.Component{constructor(e){super(e),this.state={isOpen:!1}}render(){var{isOpen:e}=this.state,{topMounted:t,viewLessLabel:r,viewMoreLabel:l,children:c,hasInternalError:d}=this.props,p=d?s.createElement("span",{role:"presentation"},l,"Â ",s.createElement(n.Icon,{iconName:"Error",className:"RelationshipForm-Content-ViewMore-ErrorIcon"})):l;return s.createElement(a.Stack,{className:Object(i.css)("ViewMore-Stack",e?"ViewMore-Stack-Opened":"ViewMore-Stack-Closed",t&&"TopMounted",this.props.className)},e&&s.createElement(a.Stack,{className:"ViewMore-Stack-Contents",defaultFocus:"input,textarea,button"},c),s.createElement(o.Link,{"aria-label":e?r:l,className:Object(i.css)("ViewMore-Toggle",e&&"ViewMore-Closed"),onClick:()=>this.setState({isOpen:!e})},e?r:p))}}},5855:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetCreator",(function(){return b}));var i=r(5829),n=r(5856),o=r(1090),s=r(545),a=r(245),l=r(5857),c=r(5839),d=r(5843),p=r(5858);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}var m=Object(s.classNamesFunction)();class h extends a.PureComponent{get classes(){return m(this.props.styles,{theme:this.props.theme})}constructor(e){super(e),this.addLink=void 0,this.renderFull=()=>{var{t:e}=this.props,{members:t}=this.state,r=this.classes;return a.createElement(i.Stack,{className:Object(s.css)("OptionSetCreator2",r.root)},a.createElement("h2",{className:"OptionSetCreator-Header"},e("OptionSets.items"),t.length?" (".concat(t.length,")"):""),t.map(this.renderMember),!this.isDisabled&&a.createElement(o.Link,{className:Object(s.css)("OptionSetCreator-AddButton",r.addButton),componentref:this.saveLinkReference,onClick:this.addMember},e("OptionSets.addNewItem")))},this.renderMinimal=()=>{var{t:e}=this.props,{members:t}=this.state,r=this.classes;return a.createElement(i.Stack,{className:Object(s.css)("OptionSetCreator2 MinimalOptionSetCreator",r.root)},a.createElement("label",{className:"OptionSetCreator-Header"},e("OptionSets.items")),t.map(this.renderMember))},this.renderMember=(e,t)=>{var{minimalMode:r,optionSetValueValidator:i,t:n}=this.props;return a.createElement(p.OptionSetMember,u({},e,{key:t,classes:this.classes,t:n,tReady:this.props.tReady,minimalMode:r,isDisabled:this.isDisabled,isRemoveDisabled:!1,optionSetValueValidator:i||h.defaultValueValidator,onChanged:this.onMemberChanged,onRemoved:this.onMemberRemoved,onAddMember:this.addMember,onDefocus:this.focusOnAddLink,telemetryCallbacks:this.props.telemetryCallbacks}))},this.addMember=()=>{var e=this.state.members;this.props.telemetryCallbacks.logData({eventName:l.OptionSetDesignerTelemetryEventsMap.EnumerationAddMember,data:{}});var{newMemberKey:t,newMemberValue:r}=this.generateNewMemberProperties(e),i={memberKey:t,displayName:this.props.t("OptionSets.defaultItem"),value:r,isManaged:!1,isNewMember:!0};this.props.interceptAdd&&(i=this.props.interceptAdd(i));var n=this.state.members.concat(i);this.setState({members:n}),this.props.onChanged&&this.props.onChanged(n)},this.onMemberChanged=e=>{var t=this.state.members.map(t=>t.memberKey===e.memberKey?e:t);this.setState({members:t}),this.props.onChanged&&this.props.onChanged(t)},this.onMemberRemoved=e=>{var t=this.state.members.filter(t=>t.memberKey!==e.memberKey);this.setState({members:t}),this.props.onChanged&&this.props.onChanged(t)},this.saveLinkReference=e=>{e&&!this.addLink&&(this.addLink=e)},this.focusOnAddLink=()=>{this.addLink&&this.addLink.focus()},this.state={members:e.members}}UNSAFE_componentWillReceiveProps(e){e&&(Object(c.arrayEquals)(this.props.members,e.members,(e,t)=>e.memberKey===t.memberKey)||this.setState({members:e.members}))}render(){var{minimalMode:e}=this.props;return e?this.renderMinimal():this.renderFull()}get isDisabled(){return!!this.props.isDisabled}generateNewMemberProperties(e){var t=Object(n.maxElement)(e,e=>e.value),r=Object(n.maxElement)(e,e=>e.memberKey),i=t?t.value+1:1;return{newMemberKey:r?r.memberKey+1:1,newMemberValue:i}}}h.defaultValueValidator=Object(c.constant)(Object(d.lift)(Object(c.constant)(!0)));var b=Object(s.styled)(h,e=>{var{theme:t}=e;return{root:{width:"100%",marginRight:"18px",selectors:{h2:{fontSize:"18px",fontWeight:"300",margin:"0",marginTop:"16px",marginBottom:"4px"},label:{color:"black",fontSize:"14px",fontWeight:"400",margin:"0",marginTop:"8px",marginBottom:"4px"}}},addButton:{margin:"6px 10px"},container:{margin:"2px 4px 4px"},quickEntry:{flex:"1",selectors:{".ms-TextField-wrapper":{borderBottom:"none"},input:{borderBottom:"1px dotted",borderBottomColor:t.palette.neutralLight},"input:hover":{borderBottom:"1px solid",borderBottomColor:t.palette.neutralLight},"input:focus, input:active":{borderBottom:"1px solid",borderBottomColor:t.palette.themePrimary}}},contextMenuButton:{selectors:{"&:disabled":{background:"transparent !important"}}}}})},5857:function(e,t,r){"use strict";var i;r.r(t),r.d(t,"OptionSetDesignerTelemetryEventsMap",(function(){return i})),function(e){e.EnumerationsUpdate="Enumerations.Update",e.EnumerationsOpen="Enumerations.OpenEnumeration.Clicked",e.EnumerationNew="Enumerations.NewEnumeration.Clicked",e.EnumerationDismiss="Enumerations.Dismiss.Clicked",e.EnumerationAddMember="Enumerations.AddMember.Clicked",e.EnumerationOpenMember="Enumerations.OpenMember.Clicked",e.EnumerationDeleteMember="Enumerations.DeleteMember.Clicked",e.EnumerationDelete="Enumerations.Delete",e.EnumerationsLoad="Enumerations.Load",e.LoadCachedOptionSetsList="Enumerations.LoadCachedOptionSetsList",e.EnumerationLoad="Enumerations.LoadSingle",e.EnumerationsReceiveFailed="Enumerations.ReceiveListFailed",e.EnumerationReceiveFailed="Enumerations.ReceiveFailed",e.EnumerationPublishFailed="Enumerations.PublishFailed",e.EnumerationUpdateFailed="Enumerations.UpdateFailed",e.EnumerationDeleteFailed="Enumerations.DeleteFailed"}(i||(i={}))},5858:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetMember",(function(){return O}));var i=r(5859),n=r(5860),o=r(5829),s=r(684),a=r(1429),l=r(1240),c=r(545),d=r(245),p=r(5857),u=r(5839),m=r(5840),h=r(5846),b=r(5843);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class O extends d.PureComponent{constructor(e){var t;super(e),t=this,this.quickEntryTextField=void 0,this.inProgressValidations=()=>{var{optionSetValueValidator:e,value:t,isNewMember:r}=this.props,{inProgressValue:i}=this.state,{displayName:n,value:o}=i||{};return Object(b.validate)({name:{value:n,validator:Object(h.validateMemberName)(this.memberNameValidationErrorMessages())},value:{value:o,validator:Object(b.iff)(Object(u.constant)(!!r),e(t))}})},this.quickEditValidations=()=>{var{displayName:e}=this.props;return Object(b.validate)({name:{value:e,validator:Object(h.validateMemberName)(this.memberNameValidationErrorMessages())}})},this.updateName=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t.props.onChanged&&t.props.onChanged(f(f({},t.props),{},{displayName:r}))},this.expandDetailedEdit=()=>{this.props.telemetryCallbacks.logData({eventName:p.OptionSetDesignerTelemetryEventsMap.EnumerationOpenMember,data:{}}),this.props.onChanged&&this.props.onChanged(f(f({},this.props),{},{isOpen:!0})),this.setState({inProgressValue:this.props})},this.updateInProgress=e=>t=>{this.state.inProgressValue&&this.setState({inProgressValue:f(f({},this.state.inProgressValue),{},{[e]:t})})},this.updateInProgressDisplayName=this.updateInProgress("displayName"),this.updateInProgressValue=this.updateInProgress("value"),this.validationError=e=>t=>()=>e().results[t].error||"",this.inProgressDisplayNameError=this.validationError(this.inProgressValidations)("name"),this.inProgressValueError=this.validationError(this.inProgressValidations)("value"),this.quickEditNameError=this.validationError(this.quickEditValidations)("name"),this.saveDetailedEdit=()=>{this.state.inProgressValue&&this.props.onChanged&&this.props.onChanged(this.state.inProgressValue),this.setState({inProgressValue:void 0})},this.collapseDetailedEdit=()=>{this.props.onChanged&&this.props.onChanged(f(f({},this.props),{},{isOpen:!1})),this.setState({inProgressValue:void 0})},this.remove=()=>{this.props.onRemoved&&(this.props.telemetryCallbacks.logData({eventName:p.OptionSetDesignerTelemetryEventsMap.EnumerationDeleteMember,data:{}}),this.props.onRemoved(this.props))},this.onKeyDown=e=>{!this.props.onDefocus||"Escape"!==e.key&&27!==e.which&&27!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.props.onDefocus())},this.onKeyPress=e=>{!this.props.onAddMember||"Enter"!==e.key&&13!==e.which&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.props.onAddMember())},this.saveTextFieldReference=e=>{e&&!this.quickEntryTextField&&(this.quickEntryTextField=e),this.focusIfNecessary()},this.focusIfNecessary=()=>{this.state.shouldFocus&&this.tryFocusOnQuickEntryTextField()&&this.setState({shouldFocus:!1})},this.tryFocusOnQuickEntryTextField=()=>!!this.quickEntryTextField&&(this.quickEntryTextField.focus(),this.quickEntryTextField.select(),!0),this.memberNameValidationErrorMessages=()=>{var e;return{requiredFieldError:this.props.t("Error.requiredFieldError"),maxLengthExceededError:this.props.t("Error.maxLengthExceededError"),name:null===(e=this.props.t("Words.name"))||void 0===e?void 0:e.toLowerCase()}},this.state={inProgressValue:void 0,shouldFocus:!!e.isNewMember}}render(){var{classes:e,isNewMember:t,displayName:r,minimalMode:p,t:u}=this.props,{inProgressValue:h}=this.state,{overallSuccess:b}=this.inProgressValidations();return this.focusIfNecessary(),d.createElement(o.Stack,{className:Object(c.css)("OptionSetMember-Container",e.container)},d.createElement(i.Line,{className:"OptionSetMember"},d.createElement(a.TextField,{underlined:!0,className:Object(c.css)("OptionSetMember-QuickEntry",e.quickEntry),validateOnLoad:!1,onGetErrorMessage:this.quickEditNameError,ariaLabel:u("Words.name"),maxLength:m.optionSetMemberLabelMax,disabled:this.isQuickEditDisabled,value:r,componentRef:this.saveTextFieldReference,onChange:this.updateName,onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress}),d.createElement(l.TooltipHost,{content:u("memberCommandList"),calloutProps:{gapSpace:0}},d.createElement(s.IconButton,{className:Object(c.css)("OptionSetMember-ContextMenuButton",e.contextMenuButton),menuIconProps:{iconName:"More"},ariaLabel:u("memberCommandList"),menuProps:{items:[{key:"more",name:u("OptionSets.viewMore"),onClick:this.expandDetailedEdit,disabled:p},{key:"remove",name:u("Words.remove"),disabled:this.isQuickEditDisabled||this.isRemoveDisabled||p,onClick:this.remove}]}}))),h&&d.createElement(o.Stack,{className:"OptionSetMember-Details"},d.createElement(a.TextField,{className:"OptionSetMember-Details-DisplayName",required:!0,maxLength:m.optionSetMemberLabelMax,validateOnLoad:!1,label:u("Words.name"),disabled:this.isDetailedDisabled,value:h.displayName,onChange:(e,t)=>this.updateInProgressDisplayName(t||""),onGetErrorMessage:this.inProgressDisplayNameError}),d.createElement(n.IntegerEdit,{className:"OptionSetMember-Details-Value",required:!0,validateOnLoad:!1,label:u("OptionSetMember.value"),disabled:this.isDetailedDisabled||!t,value:h.value,onChanged:this.updateInProgressValue,errorMessage:this.inProgressValueError()}),d.createElement(i.Line,null,d.createElement(s.ActionButton,{className:"OptionSetMember-Details-SaveButton",iconProps:{iconName:"Accept"},disabled:this.isDetailedDisabled||!b,onClick:this.saveDetailedEdit},u("Words.save")),d.createElement(s.ActionButton,{className:"OptionSetMember-Details-CancelButton",iconProps:{iconName:"Cancel"},onClick:this.collapseDetailedEdit},u("Words.cancel")))))}get isQuickEditDisabled(){return!(!this.props.isDisabled&&!this.isExpanded)}get isDetailedDisabled(){return!!this.props.isDisabled}get isRemoveDisabled(){return!!this.props.isRemoveDisabled}get isExpanded(){return void 0!==this.state.inProgressValue}}},5860:function(e,t,r){"use strict";r.r(t),r.d(t,"ValidatedNumericalEdit",(function(){return l})),r.d(t,"NumberEdit",(function(){return c})),r.d(t,"IntegerEdit",(function(){return d})),r.d(t,"NaturalNumberEdit",(function(){return p}));var i=r(2903),n=r(1429),o=r(245),s=r(5856);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}class l extends o.Component{constructor(e){var t;super(e),t=this,this.format=new Intl.NumberFormat,this.saveInput=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!(r=r.replace(/,/g,""))||t.isValid(r)?t.setState({stringValue:r,lastValidValue:r}):t.setState({stringValue:r})},this.publish=()=>{var{lastValidValue:e}=this.state,t=e?Number(e.replace(/,/g,"")):void 0;t!==this.props.value&&this.props.onChanged&&this.props.onChanged(t),this.setState({stringValue:e||""})},this.state={stringValue:e&&void 0!==e.value?this.getString(e.value):"",lastValidValue:e&&void 0!==e.value?this.getString(e.value):""}}UNSAFE_componentWillReceiveProps(e){e&&this.setState({stringValue:void 0!==e.value?this.getString(e.value):"",lastValidValue:void 0!==e.value?this.getString(e.value):""})}getString(e){return this.format.format(e)}render(){return o.createElement(n.TextField,a({},this.props,{className:Object(i.css)("Form-TextField","Form-NumericalField",this.props.className),value:this.state.stringValue,onChange:this.saveInput,onBlur:this.publish,validateOnLoad:!1}))}}class c extends l{isValid(e){return Object(s.isFinite)(Number(e))}}class d extends l{isValid(e){return Object(s.isInteger)(Number(e))}}class p extends l{isValid(e){return Object(s.isInteger)(Number(e))&&Number(e)>=0}}},5861:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetDesignerTitle",(function(){return i})),r.d(t,"OptionSetDesignerLoadingTitle",(function(){return n}));var i=e=>{var{designerContext:t,t:r}=e;return r("create"===t?"OptionSetPanel.newChoice":"OptionSetPanel.editChoice")},n=e=>{var{t:t}=e;return t("Loading.loadingChoice")}},6645:function(e,t,r){"use strict";r.r(t),r.d(t,"TooltipButton",(function(){return s}));var i=r(545),n=r(6646),o=r(6647),s=Object(i.styled)(n.TooltipButtonBase,o.getStyles,void 0,{scope:"TooltipButton"})},6646:function(e,t,r){"use strict";r.r(t),r.d(t,"TooltipButtonBase",(function(){return h}));var i=r(2898),n=r(684),o=r(1837),s=r(545),a=r(790),l=r(245);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=Object(s.classNamesFunction)(),h=e=>{var t,r,d,u,{calloutContent:h,tooltipId:b,iconButtonProps:g,infoIconLabel:f,infoIconButtonLabel:v,iconDistance:O,tooltipDistance:S,styles:y,theme:E,className:D}=e,[N,{toggle:P}]=Object(i.useBoolean)(!1),j=Object(i.useId)("callout-button"),M=null!=b?b:j,C=m(y,{theme:E,className:D,iconDistance:O,tooltipDistance:S});return h=l.createElement(s.DelayedRender,null,l.createElement(o.Text,null,h)),l.createElement(l.Fragment,null,l.createElement("div",{className:C.root},l.createElement(n.IconButton,c({},g,{ariaLabel:v,id:M,styles:null===(t=C.subComponentStyles)||void 0===t||null===(r=t.iconButton)||void 0===r?void 0:r.call(t,{}),onClick:P,iconProps:p({iconName:"Info",ariaLabel:f},null==g?void 0:g.iconProps)}))),N&&l.createElement(a.FocusTrapCallout,{focusTrapProps:{isClickableOutsideFocusTrap:!0},role:"alertdialog",styles:null===(d=C.subComponentStyles)||void 0===d||null===(u=d.callout)||void 0===u?void 0:u.call(d,{}),gapSpace:S||0,onDismiss:P,directionalHint:a.DirectionalHint.topCenter,target:"#".concat(M),"aria-live":"assertive",setInitialFocus:!0},h))}},6647:function(e,t,r){"use strict";function i(e){var{className:t,iconDistance:r,tooltipDistance:i}=e;return{root:[t],subComponentStyles:{iconButton:{root:{top:"".concat(r||i,"px")}},callout:{root:{padding:8,width:364}}}}}r.r(t),r.d(t,"getStyles",(function(){return i}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/218.62a0f17f.chunk.js.map