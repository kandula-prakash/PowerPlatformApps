(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/45.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[45],{"/A5N":function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return E}));var a=n("odYE"),r=n("iZ7K"),o=n("SAYH"),i=n("Wc7r"),s=n("8i4h"),c=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t){if(!e||!t)return null;const n=t.substring(t.lastIndexOf("/")+1),i=n.indexOf("("),s=n.substring(0,i),c=n.substring(i+1,n.indexOf(")"));if(!s||!c)return null;const u=Object(r.n)(e,s);return new a.a(u,new o.a(c))}function l(e){let t=e.urlParameters;if(!t)return null;"PATCH"===e.method&&t.indexOf(i.UPLOAD_FILENAME_URL_FRAGMENT)>0&&(t=t.substring(0,t.lastIndexOf("/")));let n=t.substring(t.lastIndexOf("/")+1);const a=n.indexOf("("),r=n.indexOf("?");let o=-1;a>0&&r>0?o=Math.min(a,r):a>0?o=a:r>0?o=r:a<0&&"DELETE"===e.method&&(t=t.substr(0,t.lastIndexOf("/")),n=t.substring(t.lastIndexOf("/")+1),o=n.indexOf("("));return o>0?n.substring(0,o):n}function d(e,t){const n=l(t);return n&&Object(r.n)(e,n)}function p(e){const t=e.indexOf("fetchXml=");return t>0?decodeURIComponent(e.substring(t+"fetchXml=".length)):null}function E(e,t,n,a){const r=n.additionalHeaders["x-ms-mdl-etn-name"];switch(t){case c.d.CREATE:case c.d.UPDATE:case c.d.DELETE:case c.d.RETRIEVE:{const e=-1!==n.urlParameters.indexOf("/$ref")?t===c.d.UPDATE?c.c.Associate:c.c.Disassociate:null;n.additionalParameters=Object(s.a)(t,a,r,e)}break;case c.d.RETRIEVE_MULTIPLE:n.additionalParameters=Object(s.a)(t,a,r,c.c.CustomQuery)}}},Gqub:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e=""){e&&e.startsWith("/")&&(e=window.location.origin+e);const t=new Blob([`importScripts('${e}');`],{type:"application/javascript"});return window.URL.createObjectURL(t)}n.d(t,"a",(function(){return a}))},"gw5+":function(e,t,n){"use strict";n.r(t),n.d(t,"retrieveFunctionalComponentsInformation",(function(){return c})),n.d(t,"getLibraryMetadata",(function(){return u})),n.d(t,"getLatestSASURLParam",(function(){return l}));var a=n("Zvo8"),r=n("Bl5B"),o=n("Er26"),i=n("plj2"),s=n("aMuN");function c(e,t=[]){return{type:"retrieveFunctionalComponentsInformation.async",async execute({dispatch:n,getState:a},o){const c=await async function(e,t,n,a,r=[]){var o,s;if(t&&e&&e.AppHostClient){const c=[];for(const p in t){const E=[],f=t[p].logicalName,m=await u(f,e,a,r);if(!(null===(o=null==m?void 0:m.componentLibraryPackageDetails)||void 0===o?void 0:o.componentNameMap)||0===Object.keys(null===(s=null==m?void 0:m.componentLibraryPackageDetails)||void 0===s?void 0:s.componentNameMap).length){a.warn(`${Object(i.a)()} Found 0 components for library ${f}`);continue}const O=await l(p,e.AppHostClient,n,m,!0),g=m.webPlayerPackageDetails.host,h=m.componentLibraryPackageDetails.expressionRuntime["/js/expressionruntime.js"],b=d(p,f,m.componentLibraryPackageDetails);g&&O&&b&&E.push(...b.map(e=>({libraryId:p,libraryName:e.libraryName,componentName:e.componentName,dependencyURL:e.dependencyURL,scriptURL:e.scriptURL}))),c.push({components:E,initScript:m.webPlayerPackageDetails.host+"js/init.js",expressionRuntimeScript:h})}return c}return null}(o,Object(r.j)(a()),a,e,t);var E;return n((E=c,{type:"updateFunctionalComponents.async",execute({dispatch:e,getState:t},n){const a=Object(r.h)(t());return e(Object(s.f)(Object.assign(Object.assign({},a),{functionalComponentLibraries:p(E),dependenciesFetched:!1}))),Promise.resolve()}})),c}}}async function u(e,t,n,a=[]){const r=performance.now();let s;try{const c=t.AppHostClient;s=setTimeout(()=>{null==n||n.warn(`${Object(i.a)()} getChildComponentLibraryMetadataAsync took more than 60s ${e}`)},6e4);const u=c.getChildComponentLibraryMetadataAsync(e,!0);return await u}catch(t){null==n||n.warn(`${Object(i.a)()} Error when trying to get component library details for ${e}`)}finally{window.clearTimeout(s);const e=performance.now()-r;a.push({name:o.g.LIBRARY_METADATA_RETRIEVAL,value:e})}}async function l(e,t,n,o,i=!1){let s=Object(a.b)("library_token_"+e);return s&&!i||(await async function(e,t,n,o,i=!1){if(t&&e){let s=Object(a.b)("library_token_"+t);s&&!i||(s=(o=o||await e.getChildComponentLibraryMetadataAsync(Object(r.k)(n(),t),!0)).webPlayerPackageDetails.queryString,Object(a.c)("library_token_"+t,s,o.webPlayerPackageDetails.timeUntilSASRenewalInMs/864e5,null,2))}}(t,e,n,o,i),s=Object(a.b)("library_token_"+e)),s}function d(e,t,n){var a,r;if(n){const o=[];for(const i in n.componentNameMap)o.push({libraryId:e,libraryName:t,componentName:i,dependencyURL:null===(a=n.componentNameMap[i].dependencyInfo)||void 0===a?void 0:a.split("?")[0],scriptURL:null===(r=n.componentNameMap[i].initJs)||void 0===r?void 0:r.split("?")[0]});return o}return null}function p(e){const t={};for(const n of e)for(const e of n.components){let a;a=t[e.libraryName]?t[e.libraryName]:{logicalName:e.libraryName,components:{},initScript:void 0,expressionRuntimeScript:void 0},a.expressionRuntimeScript=n.expressionRuntimeScript,a.initScript=n.initScript,a.components[e.componentName]={dependencies:void 0,dependencyURL:e.dependencyURL,scriptURL:e.scriptURL},t[e.libraryId]=a}return t}},hWcn:function(e,t,n){"use strict";n.d(t,"a",(function(){return V})),n.d(t,"q",(function(){return W})),n.d(t,"i",(function(){return G})),n.d(t,"t",(function(){return z})),n.d(t,"o",(function(){return Q})),n.d(t,"m",(function(){return X})),n.d(t,"g",(function(){return J})),n.d(t,"f",(function(){return K})),n.d(t,"l",(function(){return Z})),n.d(t,"k",(function(){return ee})),n.d(t,"j",(function(){return te})),n.d(t,"c",(function(){return ne})),n.d(t,"r",(function(){return re})),n.d(t,"e",(function(){return oe})),n.d(t,"s",(function(){return ie})),n.d(t,"n",(function(){return ce})),n.d(t,"h",(function(){return ue})),n.d(t,"p",(function(){return de})),n.d(t,"d",(function(){return pe})),n.d(t,"b",(function(){return Ee}));var a=n("D4rv"),r=n("Wc7r"),o=n("+wex"),i=n("dozL"),s=n("w1eR"),c=n("fU7K"),u=n("odYE"),l=n("UwOy"),d=n("SAYH"),p=n("504W"),E=n("dj6u"),f=n("sZ+8"),m=n("17x/"),O=n("GYEz"),g=n("4ciL"),h=n("sNgR"),b=n("/A5N"),R=n("SRlt"),v=n("q/4y"),y=n("NvOS"),w=n("iZ7K"),j=n("g22U"),N=n("Er26"),S=n("XvL5"),_=n("/oKV"),T=n("aRLb"),I=n("vNXc"),P=n("E5IU"),x=n("uIhY"),A=n("Bl5B"),C=n("plj2"),D=n("x/aW"),M=n("l0Rp"),H=n("FfwU"),$=n("UKgB"),U=n("zJrS"),L=n("f07+"),k=n("3ybi"),F=n("Hevb"),q=n("z+5+"),Y=n("zBbx"),B=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * NOTE: ODataBuilder should ONLY be referenced from other ModernDataLayer files and NOT from "generic" UCI files.
 *       This avoids having ODataBuilder being incorrectly bundled into app.js (which should only contains files needed for
 *       boot) If there is functionality needed else where, then those functions should be moved into there own file so the whole
 *       ODatabuilder does NOT need to be referenced.
 */
const V="x-ms-mdl-etn-name";function W(e,t,n,a,r){return{urlParameters:e,body:t,method:n,expressionRuntimeCall:a,additionalHeaders:r}}function G(e){const t=[r.HEADER.ACCEPT,r.HEADER.PREFER,r.HEADER.AUTO_DISASSOCIATE,r.HEADER.IF_MATCH,r.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION,r.HEADER.MSCRM_RETURN_NOTIFICATIONS,r.HEADER.CONTENT_TYPE,r.HEADER.CLIENT_REQUEST_ID,r.HEADER.SESSION_ID,r.HEADER.CORRELATION_ID,r.HEADER.SOURCE_ID,r.HEADER.VIEW_ID_HINT,r.HEADER.PAGESIZE_HINT,r.HEADER.PAGE_NUMBER_HINT,r.HEADER.SEARCH_HINT,r.HEADER.FILTER_HINT,r.HEADER.ORDERBY_HINT,r.HEADER.LINK_HINT,r.HEADER.EXECUTION_HINT,V],n={};for(const a of t)e.hasOwnProperty(a)&&(n[a]=e[a]);return n[r.HEADER.CONTENT_TYPE]||(n[r.HEADER.CONTENT_TYPE]=r.HEADER_VALUES.APPLICATION_JSON),n}function z(e,t,n,a){const r=Object(o.getMaxPageSizeFromPrefer)(Object(q.d)(e));Object(q.I)(r,t)}function Q(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}function X(e){return{type:"odatabuilder.fromquerystate.async",execute({getState:t},n){const a=n.TraceManager.getTracer(N.k.ODataBuilder);a.info(se()+" Create a SerializedRequest from Query State.");const o=e.viewId&&d.a.toString(e.viewId),i=Object(w.o)(t(),e.entityLogicalName);if(!i){const n=[];throw n.push({name:"EntityDescriptorPresent",value:!!Object(w.h)(t(),e.entityLogicalName)}),null==a||a.error(`The entitySet name for ${e.entityLogicalName} in QueryState request is null!`,n),B.a.fromErrorCode(t(),-2147098612,e.entityLogicalName)}const s={urlParameters:`${i}?fetchXml=${encodeURIComponent(e.fetchXml)}`,additionalHeaders:{[r.HEADER.PREFER]:r.HEADER_VALUES.ANNOTATIONS,[r.HEADER.ACCEPT]:r.HEADER_VALUES.APPLICATION_JSON,[r.HEADER.SOURCE_ID]:o},method:"GET",additionalParameters:{[j.a.TYPE]:j.d.RETRIEVE_MULTIPLE,[j.a.SUB_TYPE]:e&&e.queryContext?e.queryContext:j.c.RetrieveMultipleOther,[j.a.SOURCE]:j.b.Default,[N.e]:e.entityLogicalName}};return function(e,t,n){t.viewId&&!t.isCustomView&&(e.additionalHeaders[r.HEADER.VIEW_ID_HINT]=d.a.toString(t.viewId));t.pageSize&&(e.additionalHeaders[r.HEADER.PAGESIZE_HINT]=t.pageSize.toFixed());t.pageNumber&&(e.additionalHeaders[r.HEADER.PAGE_NUMBER_HINT]=t.pageNumber.toFixed());t.searchString&&(e.additionalHeaders[r.HEADER.SEARCH_HINT]=t.searchString);if(t.expression)try{e.additionalHeaders[r.HEADER.FILTER_HINT]=Object(v.d)(t.expression)}catch(e){n.error(`${se()} Failed to add Filter hint with error: ${null==e?void 0:e.message}.`)}t.sorts&&t.sorts.length>0&&(e.additionalHeaders[r.HEADER.ORDERBY_HINT]=t.sorts.toString());t.selects&&t.selects.length>0&&(e.additionalHeaders[r.HEADER.SELECT_HINT]=t.selects.toString());t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[r.HEADER.LINK_HINT]=t.linkEntities.toString());t.contextFiltersAndIds&&t.contextFiltersAndIds.length>0&&(e.additionalHeaders[r.HEADER.CONTEXT_FILTER]=t.contextFiltersAndIds.toString());t.mergeQuickFindViewId&&(e.additionalHeaders[r.HEADER.MERGE_QUICKFIND]=d.a.toString(t.mergeQuickFindViewId))}(s,e,a),Promise.resolve(ne(t(),n,s))}}}function J(e,t){const n=Object(M.a)(e,[t]);return n.additionalHeaders=Object.assign(Object.assign({},t.additionalHeaders),n.additionalHeaders),ae(e,n),n}function K(e,t,n){const a=t.entityLogicalName,r=function(e,t,n){const a={};e===i.ODataRequestType.RetrieveWithUrlParams&&t.selects&&t.selects.length>0&&!t.isAllColumns&&(a.select=t.selects.toString());e===i.ODataRequestType.RetrieveWithUrlParams&&t.sorts&&t.sorts.length>0&&(a.orderby=t.sorts.toString());if(t.expression)try{a.filter=Object(v.d)(t.expression,v.c.ODataUri)}catch(e){null==n||n.error(`${se()} Failed to add Filter hint with error: ${null==e?void 0:e.message}.`)}return"?"+Object.entries(a).map(e=>`$${e[0]}=${e[1]}`).join("&")}(e,t);if(e===i.ODataRequestType.RetrieveWithUrlParams)return new L.j(a,void 0,r);if(e===i.ODataRequestType.Update)return new L.k(a,void 0,n,r);if(e===i.ODataRequestType.DeleteWithUrlParams)return new L.d(a,void 0,r);throw new Error("ConvertQueryStateToODataRequest cannot handle request type "+e)}function Z(e,t,n,a,o={},i){return{type:"odatabuilder.fromodatacontract.async",async execute({getState:s,dispatch:c},u){const l=u.TraceManager.getTracer(N.k.ODataBuilder);l.info(se()+" Create a SerializedRequest from OData Contract."),await c(Object(T.e)(t,e));const d=s();let p;return"ExecuteMultiple"===e.getMetadata().operationName?p=await c(function(e,t,n,a={},o){return{type:"odatabuilder.fromexecutemutipleodatacontract.async",async execute({getState:i,dispatch:s},c){const u=e.requests,l=e.continueOnError;let d=!1;const p=n===_.a.Default&&Object(m.i)(i());let E=!1;const f=u.map(async e=>{if(Object(g.e)(e)){const n=await s(Z(e,t,void 0,void 0,a));return n.expressionRuntimeSupportedRequest&&(d=!0),p&&(E=E||re(i(),n)),n}if(Object(g.d)(e))return Promise.all(e.map(async e=>{const n=await s(Z(e,t,void 0,void 0,a));return n.expressionRuntimeSupportedRequest&&(d=!0),p&&(E=E||re(i(),n)),n}));throw Error("value should be of type OData contract or Changeset")}),O=await Promise.all(f);let h;return d?(h=Object(M.b)("",l,void 0,a),h.requests=O):h=Object(M.a)(i(),O,l,void 0,a),h.expressionRuntimeSupportedRequest=d,h.additionalHeaders=Object.assign(Object.assign({},o),h.additionalHeaders),p&&(E?(h.additionalHeaders[r.HEADER.EXECUTION_HINT]=r.EXECUTION_HINTS.OFFLINE,h.additionalParameters[N.j]=!0):h.additionalHeaders[r.HEADER.EXECUTION_HINT]=r.EXECUTION_HINTS.ONLINE),h}}}(e,t,n,o)):(e.urlParams&&"RetrieveWithUrlParams"===e.getMetadata().operationName&&!e.id&&(e.urlParams=function(e){const t="fetchXml=",n=e.indexOf(t);if(n>0){const a=e.substring(n+t.length);return a.indexOf("<")<0?e:e.substring(0,n+t.length)+encodeURIComponent(a)}return e}(e.urlParams)),p=Object(g.a)(d,e,o,i,l),p.expressionRuntimeSupportedRequest=Object(A.n)(d)&&Object(C.c)(d,p)),ne(d,u,p,a,o)}}}function ee(e,t){return{type:"odatabuilder.fromfunctionalodatacontract.async",execute({getState:n},a){const r=a.TraceManager.getTracer(N.k.ODataBuilder);r.info(se()+" Create a SerializedRequest from a functional OData Contract.");const o=Object(h.a)(n(),e,{},r);return Promise.resolve(ne(n(),a,o,t))}}}function te(e){return{type:"odatabuilder.fromExpressionRuntimeRequest.async",execute({getState:t},n){n.TraceManager.getTracer(N.k.ODataBuilder).info(se()+" Create a SerializedRequest from a an Expression runtime request.");const{url:a,method:r,headers:o}=e,i=ne(t(),n,{urlParameters:a,body:e.bodyData,method:r,expressionRuntimeCall:!0,additionalHeaders:G(o)},void 0,void 0,!0);return i.additionalParameters||(i.additionalParameters={}),i.additionalParameters[j.a.SOURCE]=j.b.ExpressionRuntime,Promise.resolve(i)}}}function ne(e,t,n,a,o={},i){Object(p.a)(n.additionalHeaders)&&(n.additionalHeaders={}),Object(Y.a)(e,n),Object(p.a)(n.additionalHeaders[r.HEADER.CONTENT_TYPE])&&(n.additionalHeaders[r.HEADER.CONTENT_TYPE]=r.HEADER_VALUES.APPLICATION_JSON),Object(R.d)(n);const c=Object(P.k)(e);n.additionalHeaders[r.HEADER.APP_ID]=null!=c?c:"";const u=Object(P.o)(e);if(n.additionalHeaders[r.HEADER.APP_NAME]=null!=u?u:"",!n.additionalHeaders.hasOwnProperty(r.HEADER.CLIENT_REQUEST_ID)){let e=R.c.UNKNOWN;e=a&&a.RequestId&&a.RequestId()?a.RequestId():d.a.newGuid().guid,n.additionalHeaders[r.HEADER.CLIENT_REQUEST_ID]=e}const f={[r.HEADER.SESSION_ID]:t.EventManager.getCurrentSessionId(),[r.HEADER.CORRELATION_ID]:t.EventManager.getActivityId()};Object.assign(n.additionalHeaders,f);const m=Object(E.c)(e);n.additionalHeaders[r.HEADER.OBJECT_ID]=null!=m?m:"";const g=Object(E.b)(e);n.additionalHeaders[r.HEADER.TENANT_ID]=null!=g?g:"";const h=function(e,t){const n=Object(O.a)(e),a=Object(O.d)(e),r=n===s.a.Browser?a:`${a} - ${Object(O.g)(e)} - ${Object(O.j)(e)}`;return`PowerApps-UCI/${window.VERSION_NUMERIC_VALUE} (${r}; AppName=${t})`}(e,u);n.additionalHeaders[r.HEADER.MS_USER_AGENT]=h;const b=Object(l.c)(Object(O.a)(e));return n.additionalHeaders[r.HEADER.CLIENT_HOST]=null!=b?b:"",o.OperationSource===N.v&&(n.additionalHeaders[r.HEADER.UPSYNC_REQUEST_HINT]="true"),o.SuppressTriggers&&(n.additionalHeaders[r.HEADER.SUPPRESS_TRIGGERS_HINT]="true"),i||ae(e,n),n}function ae(e,t){if(!Object(p.a)(t.urlParameters)){const n=t.endpoint||r.WEB_API_URL_FRAGMENT,a=Object(y.a)(e,n);t.urlParameters=`${a}${t.urlParameters}`,t.urlParameters=t.urlParameters.replace(/\t|\r|\n/g,"")}}function re(e,t){if("true"===t.additionalHeaders[r.HEADER.UPSYNC_REQUEST_HINT])return!0;if(t.urlParameters.includes("$batch"))return!0;const n=Object(b.a)(e,t);return n&&Object(f.n)(e,n)}function oe(e,t,n){n.info(se()+" Adding hints to Serialized Request."),e.additionalHeaders[r.HEADER.SELECT_HINT]?e.additionalHeaders[r.HEADER.SELECT_HINT]=e.additionalHeaders[r.HEADER.SELECT_HINT]+","+t.toString():e.additionalHeaders[r.HEADER.SELECT_HINT]=t.toString()}function ie(e,t,n,r){return{type:"odatabuilder.togcmresponse.async",async execute({getState:o},i){n&&n.AppendCallStack("OdataBuilder.parseJsonResponse");const s=await Object(R.g)(e,r,n);return n&&n.AppendCallStack("OdataBuilder.parseJsonResponse.Complete"),s.Metadata?function(e,t,n){if(n&&n.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse"),t)return e&&e.OtherMetadata?function(e,t){t&&t.AppendCallStack("OdataBuilder.parseGetClientMetadataExResponse");const{OtherMetadata:n}=e,r=Object(a.d)(e,["OtherMetadata"]),o=JSON.parse(e.OtherMetadata);if(Object.assign(r,o),r.Entities){const e=[];r.Entities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),r.Entities=e}if(r.RelationshipNavigationEntities){const e=[];r.RelationshipNavigationEntities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),r.RelationshipNavigationEntities=e}return r}(e,n):[];const r=JSON.parse(e);return n&&n.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse.Complete"),r}(s.Metadata,t,n):s}}}function se(e){return`[${e||N.p.ODataBuilder}]`}function ce(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[r.HEADER.CLIENT_REQUEST_ID])||R.c.UNKNOWN}function ue(e,t,n){var a;switch(t.get_name()){case"Create":{const r=t,o=r.get_target(),i=Object(x.b)(e,o),s=o.get_identifier().LogicalName,c=d.a.fromLegacyGuid(o.get_identifier().Id),u=Object(w.h)(e,s),l=null!==(a=null==u?void 0:u.PrimaryIdAttribute)&&void 0!==a?a:s+"id";i.hasOwnProperty(l)||d.a.isNullOrEmpty(c)||(i[l]=d.a.toString(c)),n&&le(o,n);const p=r.get_suppressDuplicateDetection(),E=r.get_solutionUniqueName();return new L.b(s,i,p,r.get_returnRowVersion(),r.offlineData,E)}case"Update":{const a=t,r=a.get_target();n&&le(r,n);const o=a.get_suppressDuplicateDetection(),i=a.get_solutionUniqueName(),s=Object(F.b)(a.get_concurrencyBehavior(),r.getValue("versionnumber"));return new L.k(r.get_identifier().LogicalName,r.get_identifier().Id.toString(),Object(x.b)(e,r),null,null,!1,o,s,a.get_returnRowVersion(),a.offlineData,i)}case"Delete":{const e=t,n=e.get_target(),a=Object(F.b)(e.get_concurrencyBehavior(),n.getValue("RowVersion"));return new L.c(u.a.legacyToExternalEntityReference(n),void 0,a,e.offlineData)}case"ExecuteMultiple":{const n=t,a=n.get_requests().map(t=>ue(e,t));return n.get_settings().get_continueOnError()?new L.f(a,!0):new L.f([a],!1)}case"Retrieve":const r=t,o=r.get_columnSet(),i=o instanceof S.a?o.get_Columns():[];return new L.i(u.a.legacyToExternalEntityReference(r.get_target()),i,r.get_navigationProperty());case"RetrievePrincipalAccess":const s=t;return new L.g(u.a.legacyToExternalEntityReference(s.get_target()),u.a.legacyToExternalEntityReference(s.get_principal()));case"InitializeFrom":const l=t;return new U.a(u.a.legacyToExternalEntityReference(l.get_entityMoniker()),l.get_targetEntityName(),l.get_targetFieldType(),!0,l.get_skipParentalRelationshipMapping());case"RetrieveProcessControlData":const p=t;return new k.a(p.get_target()?u.a.legacyToExternalEntityReference(p.get_target()):null,p.get_processId()?u.a.legacyToExternalEntityReference(p.get_processId()):null,p.get_processInstanceId()?u.a.legacyToExternalEntityReference(p.get_processInstanceId()):null);case"RetrieveMultiple":const E=t.get_query(),f=I.a.fromXml(E,null).getKeyQuery().get_EntityLogicalName();return new L.j(f,null,"?fetchXml="+Object(c.CrmUrlEncode)(E));case"Disassociate":const m=t;return new L.e(u.a.legacyToExternalEntityReference(m.get_target()),m.get_relationship().get_schemaName());case"ExecuteQuickFind":const O=t,g=new H.a;g.SearchText=O.get_searchText(),g.EntityGroupName=O.get_entityGroupName(),g.EntityNames=O.get_entityNames();const h=Object(P.k)(e);if(h){const e={appmoduleid:h,"@odata.type":"Microsoft.Dynamics.CRM.appmodule"};g.AppModule=e}return g;case"GetClientMetadata":const b=t,R=new $.a;return R.ClientMetadataQuery=Object(D.b)(b.get_clientMetadataQuery()),R;default:return null}}function le(e,t){e.get_changedFieldNames().forEach(n=>{const a=e.getValue(n);a&&a.hasOwnProperty("Id")&&(t[n]={name:a.Name})})}function de(){return{urlParameters:"EntityDefinitions?$select=IsActivity,IsVisibleInMobileClient,ObjectTypeCode,LogicalName,DisplayName,DisplayCollectionName,ActivityTypeMask&$filter=IsActivity eq true",additionalHeaders:{Accept:"application/json"},method:"GET",additionalParameters:{[j.a.TYPE]:j.d.ENTITY_DEFINITION,[j.a.SUB_TYPE]:j.c.EntityDefinition,[j.a.SOURCE]:"ModernDataSource"}}}function pe(e){e.additionalHeaders&&e.additionalHeaders[r.HEADER.EXECUTION_HINT]===r.EXECUTION_HINTS.ONLINE&&e.additionalParameters&&(e.additionalParameters[j.a.TYPE]===j.d.RETRIEVE_MULTIPLE||e.additionalParameters[j.a.SUB_TYPE]===j.c.ExternalSearch)&&e.additionalParameters[j.a.TYPE]&&e.additionalParameters[j.a.SUB_TYPE]&&e.additionalParameters[j.a.SOURCE]&&(e.additionalHeaders[r.HEADER.OPERATION_INFO]=`Type=${e.additionalParameters[j.a.TYPE]}; Subtype=${e.additionalParameters[j.a.SUB_TYPE]}; Source=${e.additionalParameters[j.a.SOURCE]}`)}function Ee(e,t,n){var a,i,s;const c=Object(j.f)(e);t.push({name:R.c.CLIENT_REQUEST_ID,value:ce(e)}),t.push({name:N.f.CLIENT_TYPE,value:Object(o.getClientType)(Object(q.F)(e))}),Object(q.a)(t,c.type),t.push({name:N.f.OPERATION_SUB_TYPE,value:c.subType}),t.push({name:N.f.OPERATION_SOURCE,value:c.source}),t.push({name:N.f.IS_OFFLINE_BY_DEFAULT_REQUEST,value:(null===(a=e.additionalParameters)||void 0===a?void 0:a[N.j])||!1}),n||t.push({name:N.f.ENTITY_NAME,value:(null===(i=e.additionalParameters)||void 0===i?void 0:i[N.e])||R.c.UNKNOWN}),t.push({name:N.f.EXECUTION_HINT,value:(null===(s=e.additionalHeaders)||void 0===s?void 0:s[r.HEADER.EXECUTION_HINT])||R.c.UNKNOWN});const u=e.urlParameters?R.c.trimUrl(e.urlParameters):null;t.push({name:R.c.REQUEST_URL,value:u}),t.push({name:R.c.REQUEST_METHOD,value:e.method||R.c.UNKNOWN})}},pcf9:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var a=n("odYE"),r=n("SAYH"),o=n("504W"),i=n("+QYJ"),s=n("SRlt"),c=n("dzep"),u=n("Y2Yg"),l=n("Er26"),d=n("FZDd"),p=n("lY/Z"),E=n("a72m"),f=n("LbMF"),m=n("5Oca"),O=n("iZ7K"),g=n("3hnk"),h=n("KBcj"),b=n("Uv1Y"),R=n("g22U"),v=n("7tM0"),y=n("3mEc"),w=n("99zj"),j=n("IqkD"),N=n("NjDY"),S=n("vSoM"),_=n("wL2W"),T=n("z+5+"),I=n("oOvK"),P=n("Z/4N"),x=n("VpHT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const A="RetrieveEntity",C="RetrieveViews",D="RetrieveView",M="RetrieveResx",H="retrieveOrgAndUserSettings",$="retrieveControlManifest",U="loadCustomControlResources",L="DataSourcePermissions",k="RecordPermissions";class F{constructor(e,t){this._context=t,this._store=e}async retrieveEntity(e,t,n,a){const r=performance.now(),o=this._prepareEventParameters(A,e,null==n?void 0:n.requestId);try{await this._store.dispatch(Object(d.f)(e,!1,t,a));const n=Object(f.k)(this._store.getState(),e,t),i=performance.now()-r;return Object(c.a)(o,s.c.RESPONSE_TIME,i),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,o),n}catch(e){const t=Object(b.c)(e),n=performance.now()-r;throw Object(c.a)(o,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),null,o),e}}async retrieveViews(e,t){const n=performance.now(),a=this._context.TraceManager.getTracer(l.k.MdlMetadataClient),r=this._prepareEventParameters(C,null==e?void 0:e.entityLogicalName,null==t?void 0:t.requestId);try{if(Object(i.c)(e)||Object(i.c)(e.entityLogicalName)||Object(i.c)(e.viewQueryTypes)||!e.viewQueryTypes.length){const e=q()+" Null or undefined query is passed";throw a.error(e),e}const t=e.viewQueryTypes;await this._store.dispatch(Object(E.c)(e.entityLogicalName,e.viewQueryTypes,!0));const o=[];t.map(t=>{const n=Object(h.f)(this._store.getState(),e.entityLogicalName,t);for(const e in n)o.push({title:n[e].name,viewId:e,hasDistinct:n[e].hasDistinct})});const u=performance.now()-n;return Object(c.a)(r,s.c.RESPONSE_TIME,u),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,r),o}catch(e){const t=Object(b.c)(e),o=performance.now()-n;throw Object(c.a)(r,s.c.RESPONSE_TIME,o),Object(T.B)(this._context,t,q(),a,r),e}}async retrieveView(e,t,n,a,i,u=!1,d){const p=performance.now(),f=this._prepareEventParameters(D,e,null==d?void 0:d.requestId);try{const d=Object(o.b)(a)?null:new r.a(a),m=await this._store.dispatch(Object(E.a)(e,t,n,d,i,u)),O=Object(h.c)(this._store.getState(),m),g=performance.now()-p;return Object(c.a)(f,s.c.RESPONSE_TIME,g),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,f),O}catch(e){const t=Object(b.c)(e),n=performance.now()-p;throw Object(c.a)(f,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),null,f),e}}async getDataSourcePermissions(e,t,n=0,a=!1,r){const o=this._context.TraceManager.getTracer(l.k.MdlMetadataClient),u=performance.now(),d=this._prepareEventParameters(L,e,null==r?void 0:r.requestId),p=Object(S.e)(t,e);Object(c.a)(d,l.f.ENTITY_NAME,e),Object(c.a)(d,l.f.PRIVILEGE,t);try{if(!e||Object(i.c)(p)||Object(i.c)(n)||Object(i.c)(a))return o.error(`${q()} Invalid params passed to getDataSourcePermissions. Returning default value ${a}`,d),a;await this._ensureEntityMetadataPresentOnState(e);const t=Object(g.g)(this._store.getState(),e,p,n,a),r=performance.now()-u;return Object(c.a)(d,s.c.RESPONSE_TIME,r),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,d),t}catch(e){const t=Object(b.c)(e);o.error(`${q()} Error when retreiving data source permissions ${e.message}`,d);const n=performance.now()-u;throw Object(c.a)(d,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),o,d),t}}async getRecordPermissions(e,t,n,a){const r=this._context.TraceManager.getTracer(l.k.MdlMetadataClient),o=performance.now(),d=this._prepareEventParameters(k,e,null==a?void 0:a.requestId),p=u.a[n];Object(c.a)(d,l.f.ENTITY_NAME,e),Object(c.a)(d,l.f.ENTITY_RECORD_ID,t),Object(c.a)(d,l.f.PRIVILEGE,n);try{if(!e||!t||Object(i.c)(p))return r.error(q()+" Invalid params passed to getRecordPermissions. Returning default value true",d),!0;await this._ensureRecordPresentOnState(e,t);const n=Object(g.h)(this._store.getState(),e,t,p),a=performance.now()-o;return Object(c.a)(d,s.c.RESPONSE_TIME,a),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,d),n}catch(e){const t=Object(b.c)(e);r.error(`${q()} Error when retreiving record permissions ${e.message}`,d);const n=performance.now()-o;throw Object(c.a)(d,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),r,d),t}}async retrieveWebResourceResx(e,t){var n;const a=performance.now(),r=this._prepareEventParameters(M,e,null==t?void 0:t.requestId);try{let t=Object(v.b)(this._store.getState(),e);if(!t){if(e.endsWith(".resx"))await this._store.dispatch(Object(w.d)([e]));else{const t=Object(j.x)(this._store.getState()),n=Object(N.D)(this._store.getState()),a=e+"."+t.languageId+".resx",o=e+"."+n.languageCode+".resx";await this._store.dispatch(Object(w.d)([a])),await this._store.dispatch(Object(w.d)([o])),Object(_.a)()&&(r.push({name:"UserLangResx",value:a}),r.push({name:"HasUserLangResx",value:!!Object(y.k)(this._store.getState())[a]}),r.push({name:"OrgLangResx",value:o}),r.push({name:"HasOrgLangResx",value:!!Object(y.k)(this._store.getState())[o]}))}t=Object(v.b)(this._store.getState(),e),Object(_.a)()&&(r.push({name:"webResourceName",value:e}),r.push({name:"ResxKeysRetrieved",value:null===(n=Object.keys(t))||void 0===n?void 0:n.length}))}const o=performance.now()-a;return Object(c.a)(r,s.c.RESPONSE_TIME,o),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,r),t}catch(e){const t=Object(b.c)(e),n=performance.now()-a;throw Object(c.a)(r,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),null,r),e}}retrieveOrgAndUserSettings(e){const t=performance.now(),n=this._prepareEventParameters(H,void 0,null==e?void 0:e.requestId);try{const e=this._store.getState(),a={organizationSettings:Object(N.D)(e),userSettings:Object(j.x)(e)},r=performance.now()-t;return Object(c.a)(n,s.c.RESPONSE_TIME,r),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,n),a}catch(e){const a=Object(b.c)(e),r=performance.now()-t;throw Object(c.a)(n,s.c.RESPONSE_TIME,r),Object(T.B)(this._context,a,q(),null,n),e}}async retrieveControlManifest(e,t,n=!0,a){const r=performance.now(),o=this._prepareEventParameters($,void 0,null==a?void 0:a.requestId);try{await this._store.dispatch(Object(I.c)(e,t,n));const a=Object(P.e)(this._store.getState(),e),i=performance.now()-r;return Object(c.a)(o,s.c.RESPONSE_TIME,i),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,o),a}catch(e){const t=Object(b.c)(e),n=performance.now()-r;throw Object(c.a)(o,s.c.RESPONSE_TIME,n),Object(T.B)(this._context,t,q(),null,o),e}}async loadCustomControlResources(e,t){const n=performance.now(),a=this._prepareEventParameters(U,void 0,null==t?void 0:t.requestId);try{await this._store.dispatch(Object(x.a)(e));const t=performance.now()-n;Object(c.a)(a,s.c.RESPONSE_TIME,t),this._context.EventManager.ReportComponentSuccess(l.k.MdlMetadataClient,a)}catch(e){const t=Object(b.c)(e),r=performance.now()-n;throw Object(c.a)(a,s.c.RESPONSE_TIME,r),Object(T.B)(this._context,t,q(),null,a),e}}_prepareEventParameters(e,t,n){const a=[];return Object(c.a)(a,l.f.OPERATION_SOURCE,R.b.MdlMetadataClient),t&&Object(c.a)(a,l.f.ENTITY_LOGICAL_NAME,t),Object(c.a)(a,R.a.TYPE,R.d.GCM),Object(c.a)(a,l.l,e),Object(c.a)(a,"MdlMetadataClientRequestId",n||r.a.EMPTYGUIDSTRING.toString()),a}async _ensureEntityMetadataPresentOnState(e){Object(O.h)(this._store.getState(),e)||await this._store.dispatch(Object(d.f)(e,!1,[]))}async _ensureRecordPresentOnState(e,t){if(!Object(m.h)(this._store.getState(),e,t)){this._ensureEntityMetadataPresentOnState(e);const n=new a.a(e,new r.a(t)),o=Object(O.H)(this._store.getState(),e);await this._store.dispatch(Object(p.e)(n,[o]))}}}function q(e){return`[${e||l.p.MdlMetadataClient}]`}},plj2:function(e,t,n){"use strict";n.d(t,"b",(function(){return be})),n.d(t,"c",(function(){return ve})),n.d(t,"a",(function(){return Ce}));var a=n("D4rv"),r=n("5UJb"),o=n.n(r),i=n("Wc7r"),s=n("6rnm"),c=n("hAdb"),u=n("OzPR"),l=n("pEXn"),d=n("odYE"),p=n("Gqub"),E=n("wge3"),f=n("t/PV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let m=0;const O={};var g=n("Bl5B"),h=n("a8hT"),b=n("Uv1Y"),R=n("Er26"),v=n("E5IU"),y=n("SAYH"),w=n("EXJz"),j=n("5ZTD"),N=n("uhZ3"),S=n("HYaY"),_=n("0eNV"),T=n("WPtp"),I=n("Nb1E"),P=n("lY/Z"),x=n("x0oY"),A=n("5Oca"),C=n("iZ7K"),D=n("uIhY"),M=n("CB5L"),H=n("/A5N"),$=n("f07+"),U=n("Lyxw"),L=n("3/02"),k=n("LbMF"),F=n("/A0C");function q(e,t,n){const a=Object(D.d)(n);if(t[a]){const n=Object(j.b)(t[a]);if(n)return new d.a(Object(C.n)(e,n[0]),new y.a(n[1]))}return null}function Y(e,t,n,a,r,o,i,s=!1){const c=[];for(const u of t)c.push(B(e,n,a,r,o,i,void 0,u,s));return Promise.all(c)}function B(e,t,n,a,r,o,i,s,c=!1){return e?Object(N.a)(e.dependencyType)||e.dependencyType===M.c.ExistingData||c?async function(e,t,n,a,r,o,i,s=!0){if(!n){const e="Failed to get identifier for expand context";throw r.error(`${Ce()} ${e}`,o),new Error(e)}let c;const u=Object(A.h)(e(),n.etn,n.id.guid),l=(a.selects||[]).map(e=>Object(x.g)(e));s&&u&&X(u,l)&&function e(t,n,a,r,o){if(!a||!a.expands)return!0;for(const i in a.expands){const s=a.expands[i].selects;try{const c=[];if(z(n.etn,i,t())===F.a.Lookup){const e=Object(A.C)(t(),n,i);e&&!Array.isArray(e)&&c.push(Object(A.h)(t(),e.etn,e.id.guid))}else c.push(...Object(A.B)(t(),n,i));if(!c||0===c.length)return!1;for(const n of c){if(!(X(n,s)&&e(t,n.identifier,a.expands[i],r,o)))return r.info(`${Ce()} State has some missing navigation property fields for record ${d.a.toString(n.identifier)} `,o),!1}}catch(e){return r.error(`${Ce()} something went wrong when checking state for expands ${e.message}`,o),!1}}return!0}(e,n,a,r,o)?(r.info(`${Ce()} All required fields present on state ${d.a.toString(n)}`,o),o.push({name:"DependenciesFetchedFromState",value:!0}),c=V(e,n,a,l,r,o)):(r.info(`${Ce()} Refreshing record on state ${d.a.toString(n)}`,o),Object(U.f)(e(),L.vf)?await async function e(t,n,a,r,o,i,s){const{urlParameter:c,retrieveRequests:u,newStartingPoints:l}=function e(t,n,a,r=!1,o=0,i=0,s=[],c=[],u={}){let l="",d=[],p="";const E=[];let f=0;const m=t.expands?Object.entries(t.expands):[];if(t.selects)l="$select="+t.selects.join(","),d=[...t.selects];else{const e=Object(C.G)(a(),n);l="$select="+e,d=[e]}if(t.expands&&n)for(const[t,r]of m){const m=z(n,t,a());if(null===m&&-1===Object(C.L)(a(),n,t))break;if(i<10)if(0===o){const O=[...s,t];f+=1,p?p+=",":(p="$expand=",i+=1);const g=e(r,G(a(),n,t),a,m===F.a.Lookup,o+1,i,O,c,u);if(p=`${p}${t}(${g.urlParameter})`,i=g.totalExpands,m===F.a.Lookup){const e=Object(k.j)(n,t,a());d.push(e),l=`${l},_${e}_value`}else E.push(new _.a(t,g.selectArray))}else{if(2!==Object(C.L)(a(),n,t))break;{const O=[...s,t];f+=1,p?p+=",":(p="$expand=",i+=1);const g=e(r,G(a(),n,t),a,m===F.a.Lookup,o+1,i,O,c,u);if(m===F.a.Lookup){const e=Object(k.j)(n,t,a());d.push(e),l=`${l},_${e}_value`}else E.push(new _.a(t,g.selectArray));p=`${p}${t}(${g.urlParameter})`,i=g.totalExpands}}}n&&r&&(u[s.join(",")]=new $.i({id:void 0,entityType:n},d,E));p&&(p=`${0===o?"&":";"}${p}`);f<m.length&&c.push(s);return{urlParameter:`${l}${p}`,totalExpands:i,newStartingPoints:c,retrieveRequests:u,selectArray:d}}(a,n.etn,t,!0),p=await r(Object(I.d)(n,"?"+c,void 0,void 0,void 0,void 0,s));if(await async function(e,t,n,a,r){for(const o in t){const i=t[o],s=await a(Object(x.e)(o?e[o]:e,i.entityReference.entityType,n,i.columns,void 0,void 0,void 0,void 0,void 0,i.navigationPropertyDetails));a(Object(P.h)(r(),d.a.fromLegacyEntityReference(s.get_identifier()),s))}}(p,u,s,r,t),null==l?void 0:l.length)for(const c of l){const{newRootNode:u,newReferences:l}=W(a,n,c,t);for(const n of l)e(t,n,u,r,o,i,s)}}(e,n,a,t,r,o,i):await async function e(t,n,a,r,o,i,s){if(!n)return void o.info(Ce()+" No identifier to refresh",i);o.info(`${Ce()} attempting refresh for ${d.a.toString(n)}`,i);const c=[];a.selects&&c.push(...a.selects);const u=Object(C.G)(t(),n.etn);-1===c.indexOf(u)&&c.push(u);const l=[],p={};if(a.expands)for(const e of Object.entries(a.expands))z(n.etn,e[0],t())===F.a.Lookup?(c.push(e[0]),p[e[0]]=e[1]):l.push(e);const E=l.map(e=>{if(e[1].selects)return{navigationProperty:e[0],columnNames:e[1].selects}});await r(Object(P.d)(n,c,void 0,E,s));for(const a in p){const c=Object(A.j)(t(),n,a);await e(t,c?c.reference:null,p[a],r,o,i,s)}const f=l.filter(e=>e[1].expands&&e[1].expands.length>0);if(f){o.info(`${Ce()} processing 2nd level expands for ${d.a.toString(n)}`,i);for(const a of f){const c=Object(A.C)(t(),n,a[0]);Array.isArray(c)?c.forEach(n=>e(t,n,a[1],r,o,i,s)):e(t,c,a[1],r,o,i,s)}}}(e,n,a,t,r,o,i),c=V(e,n,a,l,r,o));c=K(c,a);const p=Object(C.G)(e(),n.etn);c[p]||!a.selects&&!a.expands||(c[p]=y.a.toString(n.id));return c}(t,n,s,e,a,r,o,!c):async function(e,t,n,a,r,o,i){let s={};const c=n&&n.body?JSON.parse(n.body):{};if(a.expands){const n=Object.entries(a.expands);s=await async function(e,t,n,a,r,o,i,s,c){for(const u of r){const r=u[0],l=u[1],d=a(e,o,r);if(d){const e=await J(t,d,l,i,s,c);n[r]||(n[r]={}),Object.assign(n[r],K(e,l))}else i.warn(`${Ce()} Lookup record is not available for expand ${r}`,s)}return n}(e,t,s,q,n,c,r,o,i)}return s}(t(),n,i,e,a,r,o):Promise.resolve({})}function V(e,t,n,a,r,o){const i=Object(A.h)(e(),t.etn,t.id.guid);if(!i){const e="Record not present on state. "+d.a.toString(t);throw r.error(`${Ce()} ${e}`,o),new Error(e)}let s=function(e,t,n,a){const r={};n.forEach(e=>{r[e]=t.fields[e]});const o=S.a.recordDataToLegacyEntityRecord(e,t.identifier,r,null,a,A.a.LastValid);return Object(D.b)(e,o,1)}(e(),i,a,r);return n.expands&&(s=Object.assign(Object.assign({},s),function(e,t,n,a,r){const o={};for(const i in t.expands)o[i]=Q(e,t,n,i,a,r);return o}(e,n,t,r,o))),s}function W(e,t,n,a){let r,o=[t],i=e;for(const t of n)r=Object(A.C)(a(),o[0],t),o=Array.isArray(r)?r:[r],i=e.expands[t];return{newRootNode:i,newReferences:o}}function G(e,t,n){var a;if(z(t,n,e)===F.a.Lookup){return null===(a=Object(k.a)(e,t,Object(k.j)(t,n,e)).Targets)||void 0===a?void 0:a[0]}const r=Object(C.L)(e,t,n),o=Object(C.I)(e,t,n);return 2===r?o.ReferencedEntity:o.ReferencingEntity}function z(e,t,n){return Object(k.b)(Object(k.j)(e,t,n),e,n)}function Q(e,t,n,a,r,o){let i={};const s=t.expands[a].selects;if(z(n.etn,a,e())===F.a.Lookup){const i=Object(A.C)(e(),n,Object(k.j)(n.etn,a,e()));if(!Array.isArray(i))return V(e,i,t.expands[a],s,r,o)}const c=Object(A.B)(e(),n,a);if(!c)return void r.warn(`${Ce()} ${a} not present on state for ${d.a.toString(n)}`,o);const u=Object(C.L)(e(),n.etn,a);if(i=function(e,t,n,a){const r=[];for(const n of e){const e={};for(const a of t)Object(w.getAttributeValueMatchFromOdata)(a)&&(e[Object(x.k)(a)]=Object(T.c)(n.fields[a])),Object(T.g)(n.fields[a])?e[a]=Object(T.c)(n.fields[a]):e[a]=Object(T.e)(n.fields[a]);r.push(e)}return 2!==n?r:r[0]}(c,s,u),t.expands[a].expands)for(const n in t.expands[a].expands)i[n]=2!==u?c.map(i=>Q(e,t.expands[a],i.identifier,n,r,o)):Q(e,t.expands[a],c[0].identifier,n,r,o);return i}function X(e,t){if(!(null==e?void 0:e.fields))return!1;for(const n of t)if(!e.fields.hasOwnProperty(n))return!1;return!0}async function J(e,t,n,a,r,o,i=!1){const s=function(e,t=!1){let n=e.selects||[];t&&e.expands&&(n=n.concat(Object.keys(e.expands).map(e=>Object(x.l)(e))));return function(e,t){const n=function(e){if(Object(N.a)(e))return"";const t=Object.entries(e).map(([e,t])=>[e,t.selects]).filter(([e,t])=>!!t).map(([e,t])=>`${e}(${Z(t)})`);return t.length>0?"&$expand="+t.join(","):""}(t);if(0===e.length){if(""===n)return null;e.push(Object(x.l)(Object.keys(t)[0]))}const a=Z(e);return`?${a}${n}`}(n,e.expands)}(n,i);if(null===s)return a.warn(`${Ce()} Return empty object for expand with empty selects and expands for entity(${t.id.guid})`,r),{};try{return await e(Object(I.d)(t,s,void 0,void 0,void 0,void 0,o))}catch(e){const n=e?Object(b.c)(e):new b.a("Unexpected retrieval error");throw a.error(`${Ce()} Failed to retrieve entity ${t.etn}(${t.id.guid}) with message: ${n.displayMessage}`,r),n}}function K(e,t){const n={};return e&&(t.selects&&t.selects.forEach(t=>{if(!Object(N.a)(e[t])&&Object(w.getAttributeValueMatchFromOdata)(t)){const a=Object(x.k)(t);n[a]=e[a]}const a=Object(x.j)(t);Object(N.a)(e[a])||(n[a]=e[a]),n[t]=e[t]}),t.expands&&Object.keys(t.expands).forEach(a=>{Object(N.a)(e[a])||(Array.isArray(e[a])?n[a]=e[a].map(e=>K(e,t.expands[a])):n[a]=K(e[a],t.expands[a]))})),n}function Z(e){return"$select="+e.join(",")}var ee=n("hWcn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te{constructor(e){this._headers=e}append(e,t){this._headers[e]=t}get(e){return this._headers[e]}has(e){return this._headers.hasOwnProperty(e)}delete(e){delete this._headers[e]}set(e,t){this._headers[e]=t}forEach(e){for(const t in this._headers)e(this._headers[t],t,this)}}var ne=n("SRlt"),ae=n("ldKl"),re=n("kWiz");function oe(e){return(t,n,a,r)=>{switch(re.a.fromString(t)){case re.a.Info:e.info("ExpressionRuntime "+a,ie(n,r));break;case re.a.Warning:e.warn("ExpressionRuntime "+a,ie(n,r));break;case re.a.Error:e.error("ExpressionRuntime "+a,ie(n,r))}}}function ie(e,t){const n=[];if(n.push({name:"Name",value:e}),t)for(const[e,a]of Object.entries(t))n.push({name:e,value:a});return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function se(e){return null==e?void 0:e.webPlayerPackageDetails.host}function ce(e,t,n){return e.endsWith("/")||(e+="/"),n.startsWith("?")||(n="?"+n),`${e}${t}${n}`}var ue=n("gw5+"),le=n("504W"),de=n("aMuN");function pe(e,t,n=""){return{type:"functionalComponentDependencyInfo.async",async execute({dispatch:a,getState:r},o){let i;const s=Object(g.h)(r());if(n){const e=await fetch(n);i=await e.json()}else{if(!e||0===e.length||s&&s.dependenciesFetched)return void t.info(Ce()+" No functional components or dependencies already fetched");const n=await Object(ue.getLatestSASURLParam)(e[0].libraryId,o.AppHostClient,r),a=e.map(e=>fetch(`${e.dependencyURL}${n}`)),c=await Promise.all(a);if(c&&c.length>0){if(i=Object(g.j)(r()),!i)return void t.error(Ce()+" No functional libraries found on state. Skipping dependency processing");for(let n=0;n<e.length;n++){const a=e[n];i[a.libraryId]||(i[a.libraryId]={logicalName:a.libraryName,components:{}});const r=i[a.libraryId];r.components[a.componentName]={scriptURL:a.scriptURL},c[n].ok?(r.components[a.componentName].dependencies=await c[n].json(),(Object(le.a)(r.components[a.componentName].dependencies)||0===Object.keys(r.components[a.componentName].dependencies).length)&&t.warn(`${Ce()} HTTP return ok with null or empty response when fetching dependencies for ${e[n].libraryName}:${e[n].componentName}`)):t.warn(`${Ce()} HTTP error ${c[n].status} when fetching dependencies for ${e[n].libraryName}:${e[n].componentName}`)}}}a(Object(de.f)(Object.assign(Object.assign({},s),{functionalComponentLibraries:i,dependenciesFetched:!0})))}}}var Ee=n("g22U"),fe=n("z+5+"),me=n("pcf9"),Oe=n("H4dV"),ge=n("YxC/"),he=n("eq9I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
async function be(e,t,n,a,r,i=[]){var d,y,w,j,N;if(Oe.a.getInstance().get_IsBrowserIE())return void a.info(Ce()+" Expression runtime is not supported in IE",i);const S=new URL(window.location.href,window.location.origin).searchParams.get("useLocal"),_=S?Object(u.a)():"",T=S?_:"/uclient/",I=Object(p.a)(T+"expressionruntimehost.js"),P=new Worker(I);let x=s.b(P);P.onerror=e=>{e.stopImmediatePropagation(),a.error(`${Ce()} Disabling ExpressionRuntime due to error: ${e.message}`,[{name:R.g.ERROR_EVENT,value:JSON.stringify(e)}]),x=null},P.onmessageerror=e=>{a.error(Ce()+" Got message error",[{name:R.g.ERROR_EVENT,value:JSON.stringify(e)}])};const A=Object(v.n)(n.getState()),C=Object(ae.a)(window.location.origin);let D,M,H,$,U;if("TEST"!==C){if(await n.dispatch(Object(f.a)(A,a)),!Object(g.j)(n.getState()))return void a.info(`${Ce()} No component libraries linked to app module ${A}`);const e=performance.now();await n.dispatch(Object(E.initializeAppHostClient)(A));const t=performance.now()-e;i.push({name:R.g.SDK_INITIALIZATION_TIME,value:t})}else{const e=Object(c.d)(n.getState(),"components");U=["Expressionruntime.js","init.js",...(null==e?void 0:e.map(e=>e+".js"))||[]],S&&(U=U.map(e=>`${_}${e}`)),H=T+"FunctionDependencies.json",$="uclient"}if("TEST"===C&&S)await n.dispatch(pe(void 0,a,H));else{const e=Object(g.b)(n.getState());U=null!==(d=function(e){var t,n,a;if(e){const r=se(e),o=e.webPlayerPackageDetails.queryString,i=null===(n=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.expressionRuntime)||void 0===n?void 0:n["/js/expressionruntime.js"],s=null===(a=null==e?void 0:e.dataComponentPackageDetails)||void 0===a?void 0:a.scripts;if(r&&o&&i&&s){let e=[i];return e=e.concat(s.map(e=>ce(r,e,o))),e=e.map(e=>function(e){const t=e.indexOf("://");return t>0?e.substr(t+1):"//"+e}(e)),e}}return null}(e))&&void 0!==d?d:[],M=function(e){var t;if(e){const n=e.webPlayerPackageDetails.host,a=e.webPlayerPackageDetails.queryString,r=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.metadata;if(n&&a&&r){const e=r.filter(e=>e.endsWith("dependencyInfo.json"));if(e.length>0)return ce(n,e[0],a)}}return null}(e),$=se(e);const t=performance.now();D=null===(y=await n.dispatch(Object(ue.retrieveFunctionalComponentsInformation)(a,i)))||void 0===y?void 0:y[0];const o=performance.now()-t;if(i.push({name:R.g.COMPONENT_RESOLUTION_TIME,value:o}),D&&(null===(w=D.components)||void 0===w?void 0:w.length)>0){U.push(D.expressionRuntimeScript);const e=await Object(ue.getLatestSASURLParam)(D.components[0].libraryId,r.AppHostClient,n.getState);U.push(`${D.initScript}${e}`)}else a.warn(Ce()+" No functional components found")}if(M&&await n.dispatch(function(e,t){return{type:"retrieveDataComponentDependencyInfo.async",async execute({dispatch:n,getState:a},r){try{const t=a();let r=Object(g.d)(t);if(r)return;if(!e)throw new Error("Failed to get the url of data component metadata");const o=Object(g.c)(t)||"DataComponentApp",i=await fetch(e);if(!i.ok)throw new Error("Failed to fetch dependency info with statusCode "+i.status);r=await i.json(),n(Object(de.e)({name:o,dependencyInfo:r}))}catch(e){const n=e&&e.message?e.message:"Unexpected dependency info retrieval error";throw t.error(`${Ce()} Failed to retrieve dependency info with error ${n}`),new Error(n)}}}}(M,a)),D&&await n.dispatch(pe(null==D?void 0:D.components,a)),a.info(`${Ce()} Start mer host with appName ${A} and package host name ${$}`),!U||0===U.length)return void a.warn(Ce()+" No MER scripts retrieved. Skipping MER initialization");const L=await(null===(N=null===(j=r.AppHostClient)||void 0===j?void 0:j.getPluginProvider())||void 0===N?void 0:N.getPluginAsync("runtimeTelemetry")),k=performance.now();await(null==x?void 0:x.start(e,U,s.a(Re(t,r,a,n)),s.a(Pe(r,a)),s.a(Ae(r,a,n)),C,s.a(oe(a)),s.a(xe(a,n.dispatch,n.getState,r))));const F=performance.now()-k;i.push({name:R.g.MER_STARTUP_TIME,value:F});const q=async(e,t)=>{x||a.error(Ce()+" Expression runtime was disabled, unable to execute",t);const n=o.a.trackWork("ExpressionRuntime");try{return await e()}catch(e){const n=Object(b.c)(e);throw t.push({name:l.b.ErrorMessage,value:n.message}),a.error(Ce()+" Expression runtime encountered error",t),n}finally{n()}};return{executeRequest:(e,t)=>{if(e.expressionRuntimeCall)return null;const r=[{name:"RequestUrl",value:ne.c.trimUrl(e.urlParameters)}];return q(async()=>await async function(e,t,n,a,r,o){var i;let s;if("POST"===e.method&&(null===(i=e.urlParameters)||void 0===i?void 0:i.includes("$batch"))&&e.requests){s=await async function(e,t,n,a){const r=e.requests,o=[],i=we(e);let s=0,c=null;for(const e of r){let r;if(Array.isArray(e)){const o=e,i=[];for(let e=0;e<o.length;e++){const r=o[e],u=await je(r,t,n,a);if(u.contextRetrievalFailure){c=u.contextRetrievalFailure,s=e+1;break}i.push(u)}r={requests:i}}else{const o=e;r=await je(o,t,n,a),r.contextRetrievalFailure&&(c=r.contextRetrievalFailure)}if(c)break;o.push(r)}o.length>0&&(i.requests=o);c&&(i.contextRetrievalFailure=c,s>0&&(i.contextRetrievalFailure.contentID=s));return i}(e,n,a,o);let i=[];if(s.contextRetrievalFailure){let e;s.contextRetrievalFailure.contentID&&(e={"Content-ID":""+s.contextRetrievalFailure.contentID});const t=Te(s.contextRetrievalFailure.message,500,s.url,a,r,e);s.contextRetrievalFailure.contentID?i.push([t]):i.push(t)}if(s.requests){a.info(Ce()+" ExpressionRuntime handling batch request",r);const e=await t(s),n=e.responses.map((e,t)=>{const n=s.requests[t];if(e.hasOwnProperty("responses")){const t=n;return e.responses.map((e,n)=>_e(e,t.requests[n]))}return _e(e,n)});i=e.status>=200&&e.status<300?n.concat(i):n}if(0===i.length)return Te("Failed to build batch response on empty response array",400,"$batch",a,r);return(await Object(h.a)()).buildBatchResponse(i)}if(s=await je(e,n,a,o),s.contextRetrievalFailure)return Te(s.contextRetrievalFailure.message,500,s.url,a,r);a.info(`${Ce()} ExpressionRuntime handling ${s.method} request`,r);const c=await t(s);if(!c)return a.info(`${Ce()} ExpressionRuntime return null for ${s.method} request`,r),null;return _e(c,s)}(e,x.executeRequest,n,a,r,t),r)},executeFunction:(e,t,o,i,s)=>{const c=[{name:R.g.LIBRARY_NAME,value:e},{name:R.g.FUNCTIONAL_COMPONENT_NAME,value:t},{name:l.b.WebResourceParameterNames.FunctionName,value:o}];return Object(fe.a)(c,Ee.d.EXPRESSION_FUNCTION),q(async()=>await async function(e,t,n,a,r,o,i,s,c,u,l){const d=performance.now(),p=function(e,t,n,a){const r=(m++).toString();return O[r]={libraryName:e,componentName:t,functionName:n,provider:a},r}(e,t,n,a);s||(s=[]);if(s.push({name:R.g.CONTEXT_TOKEN,value:p}),i.warn(Ce()+" Executing expression function",s),!(e&&t&&n))throw i.warn(Ce()+" Invalid parameters passed to executeExpressionFunction",s),b.a.fromErrorCode(o.getState(),-2147220933);if(!function(e,t,n,a,r,o){var i;try{return-1!==(null===(i=Object(g.a)(a.getState(),e,t))||void 0===i?void 0:i.indexOf(n))}catch(e){r.warn("{getExpressionRuntimeHostPrefix()} unable to validate if expression function is valid due to error "+e.message,o)}return!0}(e,t,n,o,i,s))throw i.warn(Ce()+" Expression function not found",s),b.a.fromErrorCode(o.getState(),-2147220933);try{const c=performance.now(),E=Object(g.f)(o.getState(),e,t,n);E||i.warn(`${Ce()} No dependencies for ${e}:${t}`,s);const f=await Ie(null==E?void 0:E.properties,a,o,i,s,l),m=performance.now()-c;s.push({name:R.g.DEPENDENCY_RESOLUTION_TIME,value:m});const h=[];let b=await r(e,t,n,f,h,p);i.info(Ce()+" Expression function executed successfully",s),(null==b?void 0:b.hasOwnProperty("value"))||(b={value:b});const v=performance.now()-d;return s.push({name:ne.c.RESPONSE_TIME,value:v}),u.EventManager.ReportComponentSuccess(R.k.ModernDataSource,s),b}catch(a){const r=performance.now()-d;s.push({name:ne.c.RESPONSE_TIME,value:r});const l=Object(b.c)(a);!function(e,t,n,a,r){var o;const i=Object(b.c)(e),s=new Error(Ce());s.stack=i.stack,s.name=i.name,n||(n={});Object.assign(n,{errorMessage:i.message}),a.error(`${Ce()} Error occurred when executing expression function ${i.message}`,r),null===(o=null==t?void 0:t.logException)||void 0===o||o.call(t,s,n)}(a,c,{libraryName:e,componentName:t,functionName:n},i,s);const p=["ComponentNotFound","FunctionNotFound"];if("string"==typeof a.code&&-1!==p.indexOf(a.code))throw u.EventManager.ReportComponentFailure(R.k.ModernDataSource,l,void 0,s),0===p.indexOf(a.code)?new b.a(Object(ge.b)(o.getState(),he.b)):new b.a(Object(ge.b)(o.getState(),he.c));throw l}finally{!function(e,t,n){O.hasOwnProperty(e)?delete O[e]:t.error("[Expression Context Manager] Unable to find context provider with token "+e,n)}(p,i,s)}}(e,t,o,i,x.executeComponentFunction,n,a,c,L,r,s),c)},loadAdditionalScripts:async o=>{const i=[];for(const e in o)o[e]?i.push(`${e}${await Object(ue.getLatestSASURLParam)(o[e],r.AppHostClient,n.getState)}`):i.push(e);return q(async()=>{await x.start(e,i,s.a(Re(t,r,a,n)),s.a(Pe(r,a)),s.a(Ae(r,a,n)),C,s.a(oe(a)),s.a(xe(a,n.dispatch,n.getState,r)))},[{name:"RequestUrl",value:""}])}}}function Re(e,t,n,a){return async r=>{const o=[];Object(fe.a)(o,Ee.d.EXPRESSION_FUNCTION),o.push({name:R.f.OPERATION_SUB_TYPE,value:Ee.c.ExecuteExpressionRequest}),o.push({name:ne.c.REQUEST_URL,value:r.url});const i=performance.now();try{const s=await a.dispatch(Object(ee.j)(r)),c=await e(s,a.getState),u=await c.json(),l=performance.now()-i;return o.push({name:ne.c.RESPONSE_TIME,value:l}),o.push({name:ne.c.CLIENT_REQUEST_ID,value:Object(ee.n)(s)}),n.info(`${Ce()} Return response with status ${c.status} for ${r.method} request ${ne.c.trimUrl(r.url)}`,o),t.EventManager.ReportComponentSuccess(R.k.ExpressionRuntime,o),{headers:Object(ee.o)(c.headers),responseType:"json",status:c.status,response:u}}catch(e){const n=performance.now()-i;throw o.push({name:ne.c.RESPONSE_TIME,value:n}),t.EventManager.ReportComponentFailure(R.k.ExpressionRuntime,e,void 0,o),e}}}function ve(e,t){return function(e){switch(e.method){case"DELETE":case"PATCH":return!0;case"POST":return"$batch"!==e.urlParameters;default:return!1}}(t)&&!!ye(e,t)}function ye(e,t){const n=Object(H.b)(t);return n?Object(g.e)(e,n):null}function we(e){const t=e.body?JSON.parse(e.body):{},{statecode:n}=t,r=Object(a.d)(t,["statecode"]);return{url:"/"+e.urlParameters,method:e.method,headers:e.additionalHeaders,responseType:"json",bodyData:JSON.stringify(r)}}async function je(e,t,n,a){const r=we(e),o=ye(t.getState(),e);if(o)try{const s=[];s.push({name:i.HEADER.CLIENT_REQUEST_ID,value:Object(ee.n)(e)}),s.push({name:R.f.RUNTIME_CONTEXT,value:JSON.stringify(Ne(r.context))}),n.info(`${Ce()} ExpressionRuntime handling ${e.method} request ${ne.c.trimUrl(r.url)}`,s);const c=await async function(e,t,n,a,r,o,i){var s;const c=function(e){switch(e.method){case"DELETE":return"OnDelete";case"PATCH":return"OnUpdate";case"POST":return"OnCreate";default:return null}}(n),u={},l=c&&(null===(s=null==a?void 0:a.queryOptions)||void 0===s?void 0:s[c]);if(l){const a=[],s=[];for(let c in l){c=c;const u=l[c];let d;u.dependencyType||(u.dependencyType="OldRecord"===c?M.c.ExistingData:M.c.NewData),u.dependencyType!==M.c.ExistingData&&"OldRecord"!==c||(d=Object(H.d)(e(),n.urlParameters)),a.push(B(u,e,t,r,o,i,n,d)),s.push(c)}const c=await Promise.all(a);for(let e=0;e<c.length;e++)u[s[e]]=c[e]}return u}(t.getState,t.dispatch,e,o,n,s,a);r.context=c}catch(e){r.contextRetrievalFailure={message:"The context building for the data component failed. Error Message: "+e.message}}return r}function Ne(e){const t={};for(const n in e){const a=e[n];t[n]=Se(a)}return t}function Se(e){const t=[];for(const n in e){const a=e[n];let r="";r=a instanceof Object?`${n}(${Se(a)})`:n,t.push(r)}return t.join(",")}function _e(e,t,n,a){const r=n||e.response,o=e.status>=200&&e.status<300;return a=a||i.HEADER_VALUES.APPLICATION_JSON,{ok:o,status:e.status,statusText:o?"OK":"",json:()=>Promise.resolve(r||{}),text:()=>Promise.resolve(r?JSON.stringify(r):""),headers:new te(Object.assign(Object.assign({},e.headers),{[i.HEADER.CONTENT_TYPE]:a})),url:t.url}}function Te(e,t,n,a,r,o){a.error(`${Ce()} ${e}`,r);const s={error:{code:-2147220891,message:e,innererror:{message:e}}},c=new te({[i.HEADER.CONTENT_TYPE]:i.HEADER_VALUES.APPLICATION_JSON});if(o)for(const e in o)c.has(e)||c.append(e,o[e]);return{ok:!1,status:t,statusText:"",json:()=>Promise.resolve(s||{}),text:()=>Promise.resolve(s?JSON.stringify(s):""),headers:c,url:n}}async function Ie(e,t,n,a,r,o,i=!1){const s={};if(e)for(const c in e){const u=t.getParameterValue(c);let l;const p=[];let E;if(u instanceof d.a?(E=!0,p.push(u)):Array.isArray(u)&&(E=!1,p.push(...u)),p.length>0){const t=await Y(e[c].queryOptions,p,n.getState,n.dispatch,a,r,o,i);l=E?t[0]:t}else l=u;s[c]=l}return s}function Pe(e,t){return(n,a,r)=>{const o=[];Object(fe.a)(o,Ee.d.EXPRESSION_FUNCTION),o.push({name:R.f.OPERATION_SUB_TYPE,value:Ee.c.ExecuteHostFunction}),o.push({name:R.g.HOST_FUNCTION_NAME,value:n}),o.push({name:R.g.CONTEXT_TOKEN,value:r}),t.info(`${Ce()} executing host function ${n} for context ${r}`);const i=function(e){const t=O[e];return null==t?void 0:t.provider}(r);if(!i)return t.error(`${Ce()} Unable to find a provider with token ${r}`,o),null;const s=performance.now();try{const t=i.executeFunction(n,a),r=performance.now()-s;return o.push({name:ne.c.RESPONSE_TIME,value:r}),e.EventManager.ReportComponentSuccess(R.k.ExpressionRuntime,o),t}catch(n){const a=performance.now()-s;throw o.push({name:ne.c.RESPONSE_TIME,value:a}),e.EventManager.ReportComponentFailure(R.k.ExpressionRuntime,n,void 0,o),t.error(Ce()+" Host function execution failed",o),n}}}function xe(e,t,n,a){const r=new me.a({dispatch:t,getState:n},a);return(t,n,a)=>(e.info(`${Ce()} executing metadata request function ${t} for expression runtime`),async function(e,t,n,a,r){if(!e){const e=new b.a("invalid arguments in execute metadata request by name");throw null==r||r.error(`${Ce()} ${e.message}`),e}if(!n||Object(le.b)(t)){const e=new b.a("invalid arguments in execute metadata request by name");throw null==r||r.error(`${Ce()} ${e.message}`),e}try{switch(t){case"DataSourcePermissions":const o=n;return{value:await e.getDataSourcePermissions(o.entityLogicalName,o.privilegeName,o.privilegeDepth,!0,a)};case"RecordPermissions":const i=n;return{value:await e.getRecordPermissions(i.entityLogicalName,i.recordID,i.access,a)};case"RetrieveEntity":const s=n;return{value:await e.retrieveEntity(s.entityLogicalName,s.attributes,a)};case"RetrieveViews":const c=n;return{value:await e.retrieveViews(c.query,a)};case"RetrieveView":const u=n;return{value:await e.retrieveView(u.entityLogicalName,u.viewQueryType,u.viewType,u.viewId,u.isViewSelectorItemsNeeded,u.allowCheckForUserView,a)};case"RetrieveWebResourceResx":const l=n;return{value:await e.retrieveWebResourceResx(l.webResourceName,a)};default:{const e=new b.a("unknown metadata function name "+t);throw null==r||r.error(`${Ce()} ${e.message}`),e}}}catch(e){const n=Object(b.c)(e);throw null==r||r.error(`${Ce()} Error when executing a metadata function ${t} ${n.message}`),n}}(r,t,n,a,e))}function Ae(e,t,n){return(a,r)=>{var o,i;const s=[];Object(fe.a)(s,Ee.d.EXPRESSION_FUNCTION),s.push({name:R.f.OPERATION_SUB_TYPE,value:Ee.c.RecalculateDependencies}),t.info(`${Ce()} recalculating dependency properties for context ${a}`);const c=function(e){return O[e]}(a);if(!c)throw t.error(`${Ce()} Unable to find a provider with token ${a}`),new Error("Invalid context token "+a);s.push({name:R.g.CONTEXT_TOKEN,value:a});const{libraryName:u,componentName:d,functionName:p,provider:E}=c;s.push({name:R.g.LIBRARY_NAME,value:u}),s.push({name:R.g.FUNCTIONAL_COMPONENT_NAME,value:d}),s.push({name:l.b.WebResourceParameterNames.FunctionName,value:p});const f=performance.now();try{const a=Object(g.f)(n.getState(),u,d,p);let c;if(a||t.warn(`${Ce()} No dependencies for ${u}:${d}`,s),r&&r.length){c={};for(const e of r){if(!(null===(o=null==a?void 0:a.properties)||void 0===o?void 0:o[e]))throw new Error("Invalid property name "+e);c[e]=null===(i=null==a?void 0:a.properties)||void 0===i?void 0:i[e]}}else c=null==a?void 0:a.properties;const l=Ie(c,E,n,t,s,void 0,!0),m=performance.now()-f;return s.push({name:ne.c.RESPONSE_TIME,value:m}),e.EventManager.ReportComponentSuccess(R.k.ExpressionRuntime,s),l}catch(t){const n=performance.now()-f;throw s.push({name:ne.c.RESPONSE_TIME,value:n}),e.EventManager.ReportComponentFailure(R.k.ExpressionRuntime,s),t}}}function Ce(e){return`[${e||R.p.ExpressionRuntimeHost}]`}},"t/PV":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n("Bl5B"),r=n("plj2"),o=n("eD3A");var i=n("aMuN");function s(e,t){return{type:"initializeRootCanvasApp.async",async execute({dispatch:n,getState:s},c){var l;e?(n(Object(i.d)({canvasAppId:void 0,logicalName:e})),await n((l=e,{type:"retrieveRootCanvasAppMetadata.async",execute({dispatch:e,getState:t},n){if(!Object(a.b)(t()))try{return e(Object(i.e)({name:l})),Promise.resolve()}catch(e){const t=[{name:"appName",value:l}];throw n.EventManager.ReportComponentFailure("ExpressionRuntime.retrieveCanvasAppMetadata",e,void 0,t),e}}})),await n(function(e,t){return{type:"initializeFunctionalComponentApp.async",async execute({dispatch:n,getState:s},c){if(Object(a.h)(s()))return;const l=await n(function(e){return{type:"retrieveComponentLibraryNames",async execute({dispatch:t,getState:n},a){const i=[],s=await Object(o.e)(n(),a);return s?i.push(s):e.info(Object(r.a)()+" No commanding libraries returned for current app module"),i}}}(t));n(Object(i.f)({name:e,functionalComponentLibraries:u(l),dependenciesFetched:!1}))}}}(e,t))):t.warn(Object(r.a)()+" Failed to initializeRootCanvasApp with invalid appId or logicalName.")}}}function c(e,t){return{type:"setRunTimeInitialized.async",execute:({dispatch:n,getState:r},o)=>(n(function(e,t){const n=Object(a.c)(e);return Object(i.e)({name:n,expressionRuntimeInitialized:t})}(e,t)),n(function(e,t){const n=Object(a.i)(e);return Object(i.f)({name:n,expressionRuntimeInitialized:t})}(e,t)),Promise.resolve())}}function u(e){if(!e||0===e.length)return;const t={};return null==e||e.forEach(e=>{t[e.libraryId]={components:void 0,logicalName:e.logicalName}}),t}}}]),window.bundleExecutionMarkers["scripts/45.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();