/*! For license information please see 232.2bab84d2.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[232],{6988:function(e,n,t){"use strict";t.r(n),t.d(n,"SelectConnectionPickerSize",(function(){return o})),t.d(n,"_SelectConnectionModal",(function(){return w})),t.d(n,"_SelectConnectionContent",(function(){return I})),t.d(n,"SelectConnectionContent",(function(){return G})),t.d(n,"SelectConnectionModal",(function(){return U}));var o,a=t(923),c=t(245),i=t(303),l=t(924),s=t(895),r=t(1755),m=t(1795),C=t(684),d=t(790),p=t(826),u=t(1090),y=t(687),S=t(1697),g=t(6742),M=t(2844),v=t(6989),E=t(6726),T=t(3788),O=t(3790),k=t(6377),b=t(6990),N=t(3076),f=t(2698),h=t(1105),j=t(6733),A=t(2813),F=t(2811),P=t(2752),B=t(6699),L=t(6743),D=t(860);!function(e){e[e.OneColumn=0]="OneColumn",e[e.TwoColumn=1]="TwoColumn"}(o||(o={}));var w=e=>{var{t:n,onDismiss:t,connectionType:o}=e;return Object(j.trackConnectionModalEvent)(j.ScenarioNames.OpenConnectionModal,o),c.createElement(s.Modal,{isOpen:!0,onDismiss:t,closeButtonAriaLabel:n("Common.cancel"),forceFocusInsideTrap:!1,styles:{main:{overflow:"hidden",display:"flex"}}},c.createElement(C.IconButton,{className:g.selectConnectionsModalStyles.closeButton,iconProps:{iconName:"Clear"},onClick:()=>{Object(j.trackConnectionModalEvent)(j.ScenarioNames.UserDismissedModal,o),t()},ariaLabel:n("Common.close")}),c.createElement(I,e))},I=e=>{var{environmentClient:n}=c.useContext(N.ApolloClientContext),{currentEnvironment:t}=c.useContext(h.EnvironmentContext),a=c.useRef(null),i=c.useRef(),[l,s]=c.useState(!0),[d,p]=c.useState(!1),[y,S]=c.useState(()=>e.openCreateConnectionModal),M=!n||!t,{t:v,onDismiss:P,pickerSize:L,connectionType:D,refetchConnection:w,openCreateConnectionModal:I,connectionTeamsApp:W,isResponsiveAFDTemplateEnabled:G,solutionId:U,navigate:_}=e,{loading:q,datasets:J,errorMessage:K}=Object(k.useConnectionsWithDetailsQuery)(n,{apiId:Object(T.getApiIdBasedOnConnectionType)(e.connectionType)},f.PortalScope,e.t("Common.request.failed"),M,w),{createFirstPartyConnection:Z}=Object(b.useCreateFirstPartyConnectionQuery)(n,{apiName:"shared_sharepointonline"},f.PortalScope,e.t("Common.request.failed"));c.useEffect(()=>{B.featureGates.enableFirstPartyCreateConnection&&D===O.ConnectionType.SharePoint&&S(()=>()=>{Z({variables:{apiName:Object(T.getApiNameBasedOnConnectionType)(e.connectionType)}})})},[B.featureGates.enableFirstPartyCreateConnection&&D===O.ConnectionType.SharePoint]);var V=null==W?void 0:W.onTeamsFormCompleted;c.useEffect(()=>{!M&&V&&V({createAppUri:Object(E.getAppFromDataUri)(D,a,t,G),isFormReadyToCreateApp:d})},[d,M]);var X={sampleAppTagRef:i,isAppTagCalloutHidden:l,setIsAppTagCalloutHidden:s,isResponsiveAFDTemplateEnabled:G},Y=()=>Object(E.createAppFromDataWithoutConnectionSelection)(t,D,G,P,_),$=J&&J.length>0?J[0]:void 0,ee=J&&J.length>0?J.find(e=>!e.isOnPrem):void 0,ne=($=$&&$.isOnPrem&&ee?ee:$)&&Object(E.connectionHasError)($),te=!!$&&ne||!!K,oe=$&&$.isOnPrem,ae=[Object(A.toLoadingState)(void 0!==J,K,"Connections")];if(Object(F.useLoadProgressTelemetry)("ConnectionsModal",ae,M),M)return null;var ce=L===o.OneColumn?v("Common.alternateTitle",{connectionType:Object(E.getConnectionsTypeName)(D,v)}):v("Common.title",{connectionType:Object(E.getConnectionsTypeName)(D,v)}),ie=c.createElement(r.Shimmer,{isDataLoaded:!q,shimmerElements:[{type:r.ShimmerElementType.line,width:412}],width:"412px",styles:{root:L===o.OneColumn?g.selectConnectionsModalStyles.titleWrapperOneColumn:g.selectConnectionsModalStyles.titleWrapper},ariaLabel:ce},c.createElement("p",{tabIndex:-1,"aria-hidden":!0,className:L===o.OneColumn?g.selectConnectionsModalStyles.titleOneColumn:g.selectConnectionsModalStyles.title},ce));return c.createElement("div",{className:q?g.selectConnectionsModalStyles.contentWrapper:g.selectConnectionsModalStyles.modalContentWrapper},L!==o.OneColumn?ie:null,!q&&te&&Q(D,$,K,v,()=>{var e,n;return n=null===(e=$)||void 0===e?void 0:e.name,void Object(E.getConnectionDetails)(D,n,P)},L),!q&&!te&&!$&&H(D,v,y,L),!q&&!te&&!!oe&&z(D,Y,I,v,L),L===o.OneColumn?ie:null,c.createElement(m.Stack,{horizontal:!0,wrap:!0,horizontalAlign:"center",tokens:L===o.OneColumn?{padding:0}:{padding:12},className:g.selectConnectionsModalStyles.mainContent},L!==o.OneColumn&&c.createElement(m.StackItem,{className:g.selectConnectionsModalStyles.section},x(G,q),R(X,v,D,q)),c.createElement(m.StackItem,{className:L===o.OneColumn?g.selectConnectionsModalStyles.sectionOneColumn:g.selectConnectionsModalStyles.section},c.createElement("div",null,Object(E.getConnectionSpecificFields)(D,$,J||[],q,v,a,p,te||!!oe,y),!q&&c.createElement("div",{className:g.selectConnectionsModalStyles.settingsDiv},c.createElement("span",null,v("Common.changeConnectionsMessage")),c.createElement(u.Link,{className:g.selectConnectionsModalStyles.editLink,onClick:()=>{Object(j.trackConnectionModalLinkClick)(j.ScenarioNames.AdvancedSettingsLinkClick,D),Y()}},v("Common.advancedSettingsLink")))))),c.createElement("div",{className:g.selectConnectionsModalStyles.footer},!q&&L!==o.OneColumn&&c.createElement("div",null,c.createElement(C.PrimaryButton,{"data-automationid":"connection-modal-create",onClick:()=>{Object(j.trackConnectionModalButtonClick)(j.ScenarioNames.CreateAppButtonClick,D),Object(E.createAppFromData)(D,P,a,t,G,U,_)},disabled:!d},v("Common.create")),c.createElement(C.DefaultButton,{"data-automationid":"connection-modal-cancel",className:g.selectConnectionsModalStyles.button,onClick:()=>{Object(j.trackConnectionModalButtonClick)(j.ScenarioNames.UserDismissedModal,D),P()}},v("Common.cancel")))))},x=(e,n)=>c.createElement(r.Shimmer,{isDataLoaded:!n,shimmerElements:[{type:r.ShimmerElementType.line,height:280}]},c.createElement("div",{className:g.selectConnectionsModalStyles.imageSection},c.createElement(y.Icon,{imageProps:{src:e?P.default.getPaths().connectionResponsiveAFD:P.default.getPaths().connectionAFD},className:g.selectConnectionsModalStyles.image}))),R=(e,n,t,o)=>{var{sampleAppTagRef:a,isAppTagCalloutHidden:i,setIsAppTagCalloutHidden:l,isResponsiveAFDTemplateEnabled:s}=e;return c.createElement("div",null,c.createElement(r.Shimmer,{isDataLoaded:!o,shimmerElements:[{type:r.ShimmerElementType.line}],styles:{root:g.selectConnectionsModalStyles.description},ariaLabel:n(Object(E.getPreviewDescription)(t,s))},c.createElement("p",{tabIndex:-1,"aria-hidden":!0},n(Object(E.getPreviewDescription)(t,s)))),c.createElement(r.Shimmer,{isDataLoaded:!o,shimmerElements:[{type:r.ShimmerElementType.line}],width:"50%",styles:{dataWrapper:g.selectConnectionsModalStyles.appTagsSection,root:g.selectConnectionsModalStyles.appTagsSectionWrapper}},c.createElement("div",{ref:a},c.createElement(C.DefaultButton,{onClick:()=>{Object(j.trackConnectionModalButtonClick)(j.ScenarioNames.CanvasAppButtonClick,t),l(!1)},iconProps:{iconName:M.fabricIcons.custom.brush},text:n("AppTag.CanvasApp"),className:g.selectConnectionsModalStyles.appTagsStyle}),!i&&W(e,n,t)),c.createElement("div",{className:g.selectConnectionsModalStyles.appFormatTag},c.createElement("div",{className:g.selectConnectionsModalStyles.appFormatTagText},n("FormFactor.phone"))),s&&c.createElement("div",{className:g.selectConnectionsModalStyles.appFormatTag},c.createElement("div",{className:g.selectConnectionsModalStyles.appFormatTagText},n("FormFactor.tablet")))))},W=(e,n,t)=>{var{sampleAppTagRef:o,isAppTagCalloutHidden:a,setIsAppTagCalloutHidden:i}=e;return c.createElement(d.Callout,{target:o.current,hidden:a,role:"alertdialog",setInitialFocus:!0,onDismiss:()=>i(!0)},c.createElement(p.FocusTrapZone,{isClickableOutsideFocusTrap:!0},c.createElement(C.IconButton,{className:g.selectConnectionsModalStyles.appTagCalloutCloseButton,iconProps:{iconName:M.fabricIcons.Cancel},onClick:()=>i(!0),styles:{icon:{fontSize:"12px"}},"aria-label":n("Common.cancel")}),c.createElement("div",{className:g.selectConnectionsModalStyles.appTagCallout},c.createElement("div",{className:g.selectConnectionsModalStyles.appTagCalloutHeader}," ",n("AppTag.CanvasApp")," "),c.createElement("div",{className:g.selectConnectionsModalStyles.appTagCalloutAnnotation},n("AppTag.description")),c.createElement(u.Link,{target:"_blank",role:"link",href:v.canvasAppsLearnMore,onClick:()=>Object(j.trackConnectionModalLinkClick)(j.ScenarioNames.LearnMoreLinkClick,t)},n("Common.learnMore")))))},H=(e,n,t,a)=>{var i=Object(E.getConnectionsTypeName)(e,n),l=n("Common.createConnectionButtonTitle",{connectionType:i}),s=n("Common.noConnectionsMessage",{connectionType:i});return Object(j.trackConnectionModalEvent)(j.ScenarioNames.NoConnectionsFound,e),c.createElement(S.MessageBar,{messageBarType:S.MessageBarType.warning,isMultiline:!(a!==o.OneColumn&&!Object(L.isLesserOrEqualToScreenSize)(D.ResponsiveMode.large)),styles:{root:a===o.OneColumn?g.selectConnectionsModalStyles.oneColumnMessage:""},actions:c.createElement("div",null,c.createElement(C.MessageBarButton,{onClick:()=>{Object(j.trackConnectionModalButtonClick)(j.ScenarioNames.CreateConnectionButtonClick,e),t()}},l))},s)},z=(e,n,t,a,i)=>(Object(j.trackConnectionModalEvent)(j.ScenarioNames.OnPremConnectionFound,e),c.createElement(S.MessageBar,{messageBarType:S.MessageBarType.warning,isMultiline:i===o.OneColumn,styles:{root:i===o.OneColumn?g.selectConnectionsModalStyles.oneColumnMessage:""}},c.createElement("div",{className:g.selectConnectionsModalStyles.onPremConnectionDiv},c.createElement(l.Trans,{i18nKey:"Common.onPremConnectionNotificationTitle"},"something",c.createElement(u.Link,{className:g.selectConnectionsModalStyles.onPremConnectionLink,onClick:()=>{Object(j.trackConnectionModalLinkClick)(j.ScenarioNames.NotSupportedConnectionStudioButtonClick,e),n()}},"Click here")),c.createElement(l.Trans,{i18nKey:"Common.onPremConnectionNotificationCreateConnectionTitle"},"something",c.createElement(u.Link,{className:g.selectConnectionsModalStyles.onPremConnectionLink,onClick:()=>{Object(j.trackConnectionModalLinkClick)(j.ScenarioNames.NotSupportedConnectionCreateButtonClick,e),t()}},"Click here"))))),Q=(e,n,t,a,i,l)=>{var s=Object(E.getConnectionsTypeName)(e,a),r=a("Common.fixConnectionButtonTitle",{connectionType:s}),m=t||(null!=n&&n.isAuthError?a("Common.connectionErrorCantSignIn",{connectionType:s}):(null==n?void 0:n.statusErrorMessage)||a("Common.somethingWentWrong"));Object(j.trackConnectionHasError)(e,m);var d=!!t||l===o.OneColumn;return c.createElement(S.MessageBar,{messageBarType:S.MessageBarType.error,isMultiline:d,styles:{root:l===o.OneColumn?g.selectConnectionsModalStyles.oneColumnMessage:""},actions:t?void 0:c.createElement("div",null,c.createElement(C.MessageBarButton,{onClick:()=>{Object(j.trackConnectionModalButtonClick)(j.ScenarioNames.FixConnectionButtonClick,e),i()}},r))},m)},G=Object(a.translateService)("PowerAppsConnections")(Object(i.withRouter)(I)),U=Object(a.translateService)("PowerAppsConnections")(Object(i.withRouter)(w))},6989:function(e,n,t){"use strict";t.r(n),t.d(n,"canvasAppsLearnMore",(function(){return o}));var o="https://aka.ms/GetStartedCanvasApps"},6990:function(e,n,t){"use strict";t.r(n),t.d(n,"useCreateFirstPartyConnectionQuery",(function(){return r}));var o=t(3152),a=t(217),c=t(245),i=t(3192),l=t(3193),s=t(6378);function r(e,n,t,r){var m=l.TelemetryScenarioNames.createFirstPartyConnectionGraphQl,[C,d]=Object(c.useState)(),[p,u]=Object(c.useState)(""),[y,{data:S,loading:g}]=Object(o.useMutation)(s.CreateFirstPartyConnectionQuery,{client:e||void 0,onCompleted:e=>{var t;(u(""),C)&&C.complete({apiName:null==n?void 0:n.apiName,firstPartyConnectionId:null==e||null===(t=e.createFirstPartyConnection)||void 0===t?void 0:t.id})},onError:e=>{var n=Object(i.getResponseMessageFromApolloError)(e,r);u(n),C&&C.failure({error:n,clientError:null==e?void 0:e.message})},variables:n});return Object(c.useEffect)(()=>{g&&(u(""),d(Object(a.trackLoadScenario)(t,m)))},[g]),{createFirstPartyConnection:y,loading:g,errorMessage:p,connection:null==S?void 0:S.createFirstPartyConnection}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/232.2bab84d2.chunk.js.map