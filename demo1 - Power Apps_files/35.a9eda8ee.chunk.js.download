/*! For license information please see 35.a9eda8ee.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{3185:function(e,t,r){"use strict";r.r(t),r.d(t,"useAppModulesListQuery",(function(){return f})),r.d(t,"useAppModuleQuery",(function(){return v})),r.d(t,"useAppModuleRolesQuery",(function(){return M})),r.d(t,"usePublishAppModule",(function(){return m})),r.d(t,"useRetrieveAppModuleSetting",(function(){return y})),r.d(t,"useAppModuleSetStateQuery",(function(){return j}));var o=r(3076),a=r(217),n=r(245),i=r(3186),l=r(3192),u=r(3193),p=r(3194),s=r(3195);function c(e,t,r,o,a,n,i){try{var l=e[n](i),u=l.value}catch(p){return void r(p)}l.done?t(u):Promise.resolve(u).then(o,a)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=arguments.length>5&&void 0!==arguments[5]&&arguments[5],g=u.TelemetryScenarioNames.appModuleListGraphQl,[f,v]=Object(n.useState)(),[M,m]=Object(n.useState)(""),y=O(),{loading:j,data:S,startPolling:h,stopPolling:E}=Object(i.useQuery)(p.AppModuleListQuery,{skip:c,client:e||void 0,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!!o,onCompleted:e=>{f&&(f.complete({appModulesLength:e&&e.appModulesCds&&e.appModulesCds.length}),v(void 0))},onError:e=>{if(f){var t=Object(l.getResponseMessageFromApolloError)(e,r),o=Object(s.tryParseJson)(t);d&&o&&403===o.httpStatusCode?(f.completeWithError({info:[b(b({},o),{},{type:403,errorMessage:o.message})]}),m("")):(f.failure({error:t,clientError:e&&e.message}),m(t)),v(void 0)}}});return Object(n.useEffect)(()=>(y&&o?h(o):E(),E),[y,o,h,E]),Object(n.useEffect)(()=>{j&&v(Object(a.trackLoadScenario)(t,g))},[j]),{loading:j,errorMessage:M,appModules:S&&S.appModulesCds}}function O(){var[e,t]=Object(n.useState)(!0);return Object(n.useEffect)(()=>{var e=()=>{t("visible"===document.visibilityState)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),e}function v(e,t,r,o,s,c){var d=u.TelemetryScenarioNames.appModuleGraphQl,[b,g]=Object(n.useState)(),[f,O]=Object(n.useState)(""),v=c||!t.appModuleId,{loading:M,data:m}=Object(i.useQuery)(p.AppModuleQuery,{skip:v,client:e||void 0,onCompleted:e=>{e&&e.appModuleById?b&&b.complete():(O(o),b&&b.failure({error:o}))},onError:e=>{var t=e.message,r=Object(l.getResponseMessageFromApolloError)(e,s);O(r),b&&b.failure({error:r,clientError:t})},variables:t});return Object(n.useEffect)(()=>{M&&g(Object(a.trackLoadScenario)(r,d))},[M]),{loading:M,errorMessage:f,appModule:m&&m.appModuleById}}function M(e,t,r,o,s,d){var b,g,f=u.TelemetryScenarioNames.appModuleRolesGraphQl,[O,v]=Object(n.useState)(),[M,m]=Object(n.useState)(""),y=d||!t.appModuleId,{loading:j,data:S,refetch:h}=Object(i.useQuery)(p.AppModuleRolesQuery,{skip:y,client:e||void 0,onCompleted:e=>{e&&e.appModuleById?O&&O.complete():(m(o),O&&O.failure({error:o}))},onError:e=>{var t=e.message,r=Object(l.getResponseMessageFromApolloError)(e,s);m(r),O&&O.failure({error:r,clientError:t})},variables:t,notifyOnNetworkStatusChange:!0});return Object(n.useEffect)(()=>{j&&v(Object(a.trackLoadScenario)(r,f))},[j]),{loading:j,errorMessage:M,roles:S&&S.appModuleById&&S.appModuleById.cdsRoles,refetch:(b=function*(){yield h(t)},g=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=b.apply(e,t);function n(e){c(a,r,o,n,i,"next",e)}function i(e){c(a,r,o,n,i,"throw",e)}n(void 0)}))},function(){return g.apply(this,arguments)})}}var m=(e,t,r)=>{var[s,c]=Object(n.useState)(),[d,g]=Object(n.useState)(""),{environmentClient:f,genericClient:O}=Object(n.useContext)(o.ApolloClientContext),v=f||O,[M,m]=Object(i.useMutation)(p.PublishAppModuleQuery,{client:v,onCompleted:t=>{s&&s.complete({appId:e})},onError:t=>{var o=t.message,a=Object(l.getResponseMessageFromApolloError)(t,r);g(a),s&&s.failure({error:a,clientError:o,appId:e})}});return Object(n.useEffect)(()=>{m.loading&&c(Object(a.trackLoadScenario)(t,u.TelemetryScenarioNames.appModulePublishGraphQl))},[m.loading]),b(b({},m),{},{errorMessage:d,publishAppModule:M})},y=(e,t,r,s,c)=>{var[d,b]=Object(n.useState)(),[g,f]=Object(n.useState)(""),{environmentClient:O,genericClient:v}=Object(n.useContext)(o.ApolloClientContext),M=O||v,{loading:m,data:y}=Object(i.useQuery)(p.AppModuleRetrieveSettingQuery,{client:M,variables:{settingName:e,appUniqueName:t},fetchPolicy:"no-cache",onCompleted:e=>{var t,o;d&&d.complete({appId:r,appModuleSettingName:null===(t=e.appModuleSettingByName)||void 0===t?void 0:t.SettingDetail.Name,appModuleSettingValue:null===(o=e.appModuleSettingByName)||void 0===o?void 0:o.SettingDetail.Value})},onError:e=>{var t=e.message,o=Object(l.getResponseMessageFromApolloError)(e,c);f(o),d&&d.failure({error:o,clientError:t,appId:r})}});return Object(n.useEffect)(()=>{m&&b(Object(a.trackLoadScenario)(s,u.TelemetryScenarioNames.appModuleRetrieveSettingGraphQl))},[m]),{loading:m,errorMessage:g,appModuleSetting:null==y?void 0:y.appModuleSettingByName}};function j(e,t,r){var o=u.TelemetryScenarioNames.appModuleGraphQl,[s,c]=Object(n.useState)(),[d,b]=Object(n.useState)(""),[g,{loading:f,data:O}]=Object(i.useMutation)(p.AppModuleSetStateQuery,{client:e||void 0,onCompleted:()=>{s&&s.complete(),b("")},onError:e=>{var t=e.message,o=Object(l.getResponseMessageFromApolloError)(e,r);b(o),s&&s.failure({error:o,clientError:t})}});return Object(n.useEffect)(()=>{f&&c(Object(a.trackLoadScenario)(t,o))},[f]),{appModuleSetStateById:g,loading:f,errorMessage:d,appModule:O&&O.appModuleSetStateById.appModuleId,stateCode:O&&O.appModuleSetStateById.stateCode}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/35.a9eda8ee.chunk.js.map