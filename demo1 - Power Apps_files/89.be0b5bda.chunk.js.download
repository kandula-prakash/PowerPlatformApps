/*! For license information please see 89.be0b5bda.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{4136:function(e,t,s){"use strict";s.r(t),s.d(t,"Toolbox",(function(){return n}));var i=s(545),r=s(4137),o=s(4145),n=Object(i.styled)(r.ToolboxBase,o.getStyles)},4137:function(e,t,s){"use strict";s.r(t),s.d(t,"ToolboxBase",(function(){return g}));var i,r=s(684),o=s(782),n=s(687),a=s(719),l=s(545),d=s(245),c=s(4138),h=s(4139),p=s(4140);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}var m=Object(l.classNamesFunction)();var b=d.createElement(h.ToolboxItem).type,g=Object(l.customizable)("Toolbox",["theme","styles"])(i=class e extends l.BaseComponent{static _getStateFromProps(t,s){var i=s;return i.links=e._getToolboxLinks(t,i),void 0!==t.selectedKey&&null!==t.selectedKey&&e._isKeyValid(t.selectedKey,i)?(i.selectedKey=t.selectedKey,i.drawerIsExpanded=!0):null!==t.selectedKey&&e._isKeyValid(i.selectedKey,i)||(i.selectedKey=null,i.drawerIsExpanded=!1),void 0!==t.expandLinks&&null!==t.expandLinks&&(i.linksAreExpanded=t.expandLinks),i}static _getToolboxLinks(e,t){var s=[];return t.keyToIndexMapping={},t.keyToTabIds={},t.keyToRef={},d.Children.map(e.children,e=>{if((n=e)&&"object"==typeof n&&n.type===b){var i=s.length,r=e,o=r.props.itemKey||i.toString();s.push({className:r.props.className,headerText:r.props.headerText,headerButtonProps:r.props.headerButtonProps,ariaLabel:r.props.ariaLabel,itemKey:o,itemIcon:r.props.itemIcon,onRenderItemLink:r.props.onRenderItemLink,keytipProps:r.props.keytipProps,disabled:r.props.disabled}),t.keyToIndexMapping[o]=i,t.keyToTabIds[o]=this._getTabId(i,t),t.keyToRef[o]=d.createRef()}var n}),s}static _getTabId(e,t){return t.pivotId+"-Tab".concat(e)}static _isKeyValid(e,t){return void 0!==e&&void 0!==t.keyToIndexMapping[e]}constructor(t){var s;super(t),s=this,this._focusZone=d.createRef(),this._classNames={},this._renderToolboxLinks=()=>{var e,t=this.state.links.map(this._renderToolboxLink),{linksAreExpanded:s}=this.state,{strings:i}=this.props,n=null!==(e=i.expandCollapseTooltip)&&void 0!==e?e:s?i.collapseTooltip:i.expandTooltip,l=this._toolboxLinksContainer();return d.createElement(l,{componentRef:this._focusZone,direction:o.FocusZoneDirection.vertical,className:this._classNames.focusZone},d.createElement("ul",{className:this._classNames.list,role:"tablist"},d.createElement(r.CommandButton,{className:Object(a.mergeStyles)(c.ToolboxAutomationSelectors.expandCollapseLinksClassName,this._classNames.item),onClick:this._onCollapseButtonClick,onKeyPress:this._onCollapseButtonKeyPress,"aria-expanded":s,name:n,title:n,ariaLabel:n},this._renderLinkContent({itemIcon:"GlobalNavButton",itemKey:"collapseButton"})),t))},this._toolboxLinksContainer=()=>{var e=o.FocusZone;return this.props.toolboxLinksContainerAs&&(e=this.props.toolboxLinksContainerAs),e},this._renderToolboxLink=e=>{var t,{itemKey:s,headerButtonProps:i}=e,o=this.state.keyToTabIds[s],{onRenderItemLink:n}=e,l=this.state.selectedKey===s&&this.state.drawerIsExpanded&&!e.disabled;t=n?n(e,this._renderLinkContent):this._renderLinkContent(e);var h=Object(a.mergeStyles)(c.ToolboxAutomationSelectors.toolTabClassName,l?this._classNames.itemIsSelected:this._classNames.item,e.className);return d.createElement(r.CommandButton,u({},i,{componentRef:this.state.keyToRef[s]||void 0,id:o,key:s,className:h,onClick:!e.disabled&&this._onLinkClick.bind(this,s),onKeyPress:!e.disabled&&this._onKeyPress.bind(this,s),ariaLabel:e.ariaLabel,role:"tab","aria-selected":this.state.selectedKey===s,name:e.headerText,title:e.headerText,keytipProps:e.keytipProps,disabled:e.disabled}),l&&this._renderSelectionIndicator(),t)},this._renderLinkContent=e=>{if(!e)return d.createElement(d.Fragment,null);var{itemIcon:t,headerText:s}=e,{linksAreExpanded:i}=this.state;return d.createElement("span",{className:this._classNames.itemContent,"aria-hidden":!0},void 0!==t&&d.createElement("span",{className:this._classNames.iconContainer},d.createElement(n.Icon,{iconName:t,className:this._classNames.icon})),void 0!==s&&!!i&&d.createElement("span",{className:this._classNames.text}," ",s))},this._renderSelectionIndicator=()=>d.createElement("div",{role:"presentation",className:this._classNames.selectionIndicator}),this._onCollapseButtonClick=e=>{e.preventDefault(),this._toggleCollapsed()},this._onCollapseButtonKeyPress=e=>{e.which===l.KeyCodes.enter&&(e.preventDefault(),this._toggleCollapsed())},this._onToggleExpandLinks=e=>{var t,s;null===(t=(s=this.props).onToggleExpandLinks)||void 0===t||t.call(s,e)},this._renderToolboxDrawer=()=>{var{selectedKey:e,links:t}=this.state,s=this.state.keyToIndexMapping[e],i=t[s];if(i&&i.disabled)return d.createElement(d.Fragment,null);var o=this.state.keyToTabIds[e],l=d.Children.toArray(this.props.children)[s],h=this.props.strings.closeTooltip;return d.createElement("div",{role:"tabpanel","aria-labelledby":o,className:this._classNames.drawer,style:{width:this.state.width}},d.createElement(d.Fragment,null,d.createElement("div",{className:this._classNames.drawerHeaderRegion},d.createElement("h2",{className:this._classNames.drawerHeader},i?i.headerText:null),d.createElement(r.CommandButton,{className:Object(a.mergeStyles)(c.ToolboxAutomationSelectors.closeDrawerClassName,this._classNames.drawerClose),onClick:this._dismissDrawer,title:h},d.createElement(n.Icon,{className:this._classNames.drawerCloseIcon,iconName:"Cancel"}))),l),this.props.isResizable&&d.createElement(p.Resizer,{size:this.state.width,onSizeChanged:e=>this.setState({width:e}),location:p.ResizerLocation.Right}))},this._dismissDrawer=()=>{this._focusCurrentLink(),this._clearSelectedItem(!0)},this._focusCurrentLink=()=>{var e=this.state.selectedKey;if(null!=e){var t,s=this.state.keyToRef[e];null==s||null===(t=s.current)||void 0===t||t.focus()}},this._clearSelectedItem=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];void 0===s.props.selectedKey&&s.setState({selectedKey:null,drawerIsExpanded:!1});var{onSelectedItemChanged:t}=s.props;null==t||t(null,e)};var i=void 0!==t.initialSelectedKey;this.state=e._getStateFromProps(t,{links:[],selectedKey:i?t.initialSelectedKey:null,linksAreExpanded:!!t.expandLinksInitially,drawerIsExpanded:i,keyToIndexMapping:{},keyToTabIds:{},keyToRef:{},pivotId:Object(l.getId)("Toolbox"),width:280})}static getDerivedStateFromProps(t,s){return s?e._getStateFromProps(t,s):null}render(){var e=Object(l.getNativeProps)(this.props,l.divProperties);return this._classNames=this._getClassNames(this.props),d.createElement("div",u({className:this._classNames.root},e),this._renderToolboxLinks(),this._renderToolboxDrawer())}focus(){var e;null===(e=this._focusZone.current)||void 0===e||e.focus()}_toggleCollapsed(){void 0===this.props.expandLinks?this.setState(e=>{var t=!e.linksAreExpanded;return this._onToggleExpandLinks(t),{linksAreExpanded:t}}):this._onToggleExpandLinks(!this.state.linksAreExpanded)}_onLinkClick(e,t){t.preventDefault(),this._updateSelectedItem(e)}_onKeyPress(e,t){t.which===l.KeyCodes.enter&&(t.preventDefault(),this._updateSelectedItem(e))}_updateSelectedItem(t){var s,i,{selectedKey:r,drawerIsExpanded:o}=this.state;r===t&&o?this._clearSelectedItem():(void 0===this.props.selectedKey&&this.setState({selectedKey:t,drawerIsExpanded:!0}),e._isKeyValid(t,this.state)&&(null===(s=(i=this.props).onSelectedItemChanged)||void 0===s||s.call(i,t,!1)))}_getClassNames(e){var{theme:t}=e,{linksAreExpanded:s,drawerIsExpanded:i}=this.state;return m(e.styles,{theme:t,linksAreExpanded:s,drawerIsExpanded:i})}})||i},4138:function(e,t,s){"use strict";s.r(t),s.d(t,"ToolboxAutomationSelectors",(function(){return i}));var i={expandCollapseLinksClassName:"ba-Toolbox-ExpandCollapse",toolTabClassName:"ba-Toolbox-ToolTab",closeDrawerClassName:"ba-Toolbox-CloseDrawer"}},4139:function(e,t,s){"use strict";s.r(t),s.d(t,"ToolboxItem",(function(){return a}));var i=s(719),r=s(545),o=s(245);function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class a extends r.BaseComponent{render(){var e=Object(i.mergeStyles)({minHeight:0,display:"flex",flexGrow:1,selectors:{"@media all and (-ms-high-contrast: none)":{minHeight:"calc(100% - 48px)"}}},this.props.className);return o.createElement("div",n({},Object(r.getNativeProps)(this.props,r.divProperties),{className:e}),this.props.children)}}},4140:function(e,t,s){"use strict";s.r(t);var i=s(4141);s.d(t,"Resizer",(function(){return i.Resizer}));var r=s(4143);s.d(t,"ResizerLocation",(function(){return r.ResizerLocation})),s.d(t,"ResizeDirection",(function(){return r.ResizeDirection})),s.d(t,"ResizerAttachment",(function(){return r.ResizerAttachment}))},4141:function(e,t,s){"use strict";s.r(t),s.d(t,"Resizer",(function(){return n}));var i=s(545),r=s(4142),o=s(4144),n=Object(i.styled)(r.ResizerBase,o.getStyles)},4142:function(e,t,s){"use strict";s.r(t),s.d(t,"ResizerBase",(function(){return c}));var i=s(245),r=s(545),o=s(4143);function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var l=Object(r.classNamesFunction)(),d=5;class c extends i.Component{static getDerivedStateFromProps(e,t){return c.getResizerInfo(e,t)}static getResizerInfo(e,t){var{size:s,location:i,minSize:r,maxSize:n}=e,a=i===o.ResizerLocation.Left||i===o.ResizerLocation.Right?o.ResizeDirection.Horizontal:o.ResizeDirection.Vertical,l=a===o.ResizeDirection.Horizontal,d=l?"col-resize":"row-resize",c=n||(l?window.innerWidth:window.innerHeight),h=r||0,p=!!t&&t.isResizing;return{size:s,minRelativeDelta:s-h,maxRelativeDelta:s-c,keepDeltaSign:i===o.ResizerLocation.Top||i===o.ResizerLocation.Left,isResizing:p,resizeDirection:a,cursor:d,resizeRelativeValue:p&&t?t.resizeRelativeValue:0}}constructor(e){super(e),this.globalEventsEnabled=void 0,this.originalCursor=void 0,this.resizeStartPosition=void 0,this.handleMouseDown=e=>{e.preventDefault(),this.resizeStartPosition=this.getCursorPosition(e),this.addGlobalEventHandlers()},this.addGlobalEventHandlers=()=>{this.globalEventsEnabled=!0,window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("mousemove",this.handleMouseMove),this.originalCursor=document.body.style.cursor,document.body.style.cursor=this.state.cursor},this.removeGlobalEventHandlers=()=>{this.globalEventsEnabled&&(window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove),document.body.style.cursor=this.originalCursor,this.globalEventsEnabled=!1)},this.handleArrowKeys=e=>{var t,{minSize:s,maxSize:i,size:n}=this.props,{resizeDirection:a}=this.state;if(a===o.ResizeDirection.Horizontal)switch(e.keyCode){case r.KeyCodes.left:t=u(s,n);break;case r.KeyCodes.right:t=p(i,n)}else switch(e.keyCode){case r.KeyCodes.up:t=u(s,n);break;case r.KeyCodes.down:t=p(i,n)}t&&(e.preventDefault(),this.handleSizeChanged(t))},this.handleMouseMove=e=>{e.preventDefault();var{keepDeltaSign:t,maxRelativeDelta:s,minRelativeDelta:i}=this.state,r=(this.getCursorPosition(e)-this.resizeStartPosition)*(t?1:-1),o=h(r,s,i);this.setState({isResizing:!0,resizeRelativeValue:o})},this.handleMouseUp=e=>{e.preventDefault();var t=this.props.size-this.state.resizeRelativeValue;this.handleSizeChanged(t),this.setState({isResizing:!1}),this.removeGlobalEventHandlers()},this.handleSizeChanged=e=>{var{size:t,onSizeChanged:s}=this.props;t!==e&&s&&s(e)},this.getCursorPosition=e=>this.state.resizeDirection===o.ResizeDirection.Horizontal?e.pageX:e.pageY,this.getResizerPositionStyles=()=>{var{location:e,handleSize:t=d,attachment:s=o.ResizerAttachment.Outside}=this.props,i=this.state.resizeRelativeValue-(s===o.ResizerAttachment.Inside?0:t);switch(e){case o.ResizerLocation.Left:return{top:0,bottom:0,left:i,width:t};case o.ResizerLocation.Right:return{top:0,bottom:0,right:i,width:t};case o.ResizerLocation.Top:return{top:i,left:0,right:0,height:t};case o.ResizerLocation.Bottom:return{bottom:i,left:0,right:0,height:t};default:return{}}},this.resizeStartPosition=0,this.globalEventsEnabled=!1,this.originalCursor="auto",this.state=c.getResizerInfo(e)}render(){var{cursor:e,resizeDirection:t}=this.state,{ariaLabel:s,styles:r}=this.props,d=l(r,this.props),c=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({cursor:e},this.getResizerPositionStyles());return i.createElement("div",{"aria-label":s,"aria-orientation":t===o.ResizeDirection.Horizontal?"vertical":"horizontal",role:"separator",tabIndex:0,className:d.root,style:c,onKeyDown:this.handleArrowKeys,onMouseDown:this.handleMouseDown})}componentWillUnmount(){this.globalEventsEnabled&&this.removeGlobalEventHandlers()}}var h=(e,t,s)=>Math.min(Math.max(e,t),s),p=(e,t)=>{var s;return(!e||t+5<e)&&(s=t+5),s},u=(e,t)=>{var s;return t-5>(e||0)&&(s=t-5),s}},4143:function(e,t,s){"use strict";var i,r,o;s.r(t),s.d(t,"ResizerLocation",(function(){return i})),s.d(t,"ResizeDirection",(function(){return r})),s.d(t,"ResizerAttachment",(function(){return o})),function(e){e[e.Top=0]="Top",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom",e[e.Left=3]="Left"}(i||(i={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(r||(r={})),function(e){e[e.Inside=0]="Inside",e[e.Outside=1]="Outside"}(o||(o={}))},4144:function(e,t,s){"use strict";s.r(t),s.d(t,"getStyles",(function(){return r}));var i=s(719),r=e=>{var{palette:t}=e.theme,s={opacity:1,backgroundColor:t.neutralTertiary};return{root:{position:"absolute",backgroundColor:t.neutralSecondary,borderRadius:0,transition:"0.5s opacity, 0.5s background-color",opacity:0,zIndex:i.ZIndexes.Layer,selectors:{":hover":{transition:"0.2s opacity, 0.2s background-color",opacity:1},":focus":s,":active":s}}}}},4145:function(e,t,s){"use strict";s.r(t),s.d(t,"getStyles",(function(){return o}));var i=s(719),r=e=>{var{palette:t}=e.theme;return[{padding:0,minHeight:"48px",width:"100%",border:"1px solid transparent",selectors:{":hover":{backgroundColor:t.neutralLight},":active":{backgroundColor:t.neutralQuaternary}}}]},o=e=>{var{className:t,theme:s,linksAreExpanded:o,drawerIsExpanded:n}=e,{palette:a}=s;return{root:[t,{display:"flex",flexShrink:0}],focusZone:{zIndex:i.ZIndexes.Nav+1,borderRight:"1px solid "+a.neutralQuaternaryAlt,boxShadow:n?"none":"0 0 18px rgba(0,0,0,.05)",transition:"boxShadow .3s ease",backgroundColor:a.neutralLighter},list:[i.normalize,{display:"inline-flex",height:"100%",overflowY:"auto",overflowX:"hidden",flexDirection:"column",width:o?"220px":"48px"}],drawer:[{display:n?"flex":"none",flexDirection:"column",backgroundColor:a.neutralLighter,zIndex:i.ZIndexes.Nav,boxShadow:"0 0 18px rgba(0,0,0,.05)",borderRight:"1px solid "+a.neutralQuaternaryAlt},i.AnimationClassNames.slideRightIn40],drawerHeaderRegion:{position:"relative",height:"48px",selectors:{"@media all and (-ms-high-contrast: none)":{minHeight:"48px"}}},drawerHeader:{userSelect:"none",fontWeight:"600",marginLeft:"16px",fontSize:"18px",lineHeight:"48px",display:"inline-block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"calc(100% - 64px)",marginTop:0,marginBottom:0},drawerClose:{position:"absolute",right:0,top:0,height:"48px",padding:0},drawerCloseIcon:{fontSize:"16px",margin:"16px",lineHeight:"16px",height:"16px",width:"16px"},item:r(e),itemIsSelected:[...r(e),{backgroundColor:a.white,selectors:{"&:hover,&:active":{backgroundColor:a.white,color:a.neutralPrimary}}}],itemContent:{display:"flex",alignItems:"center"},text:[{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",maxWidth:"154px"}],iconContainer:{display:"flex",marginLeft:"15px",marginRight:"15px"},icon:{fontSize:"16px",lineHeight:"16px",height:"16px",width:"16px",selectors:{"@media screen and (-ms-high-contrast: active)":{fill:a.white},"@media screen and (-ms-high-contrast: white-on-black)":{fill:a.white},"@media screen and (-ms-high-contrast: black-on-white)":{fill:a.black}}},selectionIndicator:{position:"absolute",left:"3px",width:"4px",height:"24px",background:a.themePrimary,top:"11px",borderRadius:"2px"}}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/89.be0b5bda.chunk.js.map