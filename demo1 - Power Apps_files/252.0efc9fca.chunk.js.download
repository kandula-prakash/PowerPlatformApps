/*! For license information please see 252.0efc9fca.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{7534:function(e,t,n){"use strict";var s;function r(e){return e&&e.name||""}function o(e){return e&&e.properties&&(e.properties.displayName||r(e))||""}function i(e){return e&&e.properties&&e.properties.description||""}function a(e){return!!(e&&e.properties&&e.properties.loadBalancingSettings)&&'{"selector":1}'===e.properties.loadBalancingSettings}function p(e){var t=e&&e.properties&&e.properties.contactInformation?e.properties.contactInformation:[];return t&&t.length>0?t.join(", "):""}function c(e,t){t=(t||"").toLowerCase();var n=!1;return e&&e.name&&e.properties&&e.properties.contactInformation&&(n=e.name.toLowerCase().includes(t)||e.properties.contactInformation.some(e=>e.toLowerCase().includes(t))),n}function l(e){return e&&e.properties&&(m(e)||u(e)||"")}function u(e){return e.properties.gateways.find(t=>e.name===t.name).properties.status}function m(e){return e.properties.gateways.find(t=>e.name===t.name).properties.statusErrorMessage}function d(e){return e&&e.properties&&function(e){switch(e){case s.Latest:return s.Latest;case s.NotSupported:return s.NotSupported;case s.SupportedUntilDate:return s.SupportedUntilDate;case s.UpdateAvailable:return s.UpdateAvailable;default:return s.Unknown}}(e.properties.versionStatus)}function h(e){return e&&e.properties&&e.properties.expirationDate}n.r(t),n.d(t,"VersionStatus",(function(){return s})),n.d(t,"getName",(function(){return r})),n.d(t,"getDisplayName",(function(){return o})),n.d(t,"getDescription",(function(){return i})),n.d(t,"getLoadBalancingSettings",(function(){return a})),n.d(t,"getContactInformation",(function(){return p})),n.d(t,"doesGatewayMatchSearchFilter",(function(){return c})),n.d(t,"getStatusMessage",(function(){return l})),n.d(t,"getstatus",(function(){return u})),n.d(t,"getStatsErrorMessage",(function(){return m})),n.d(t,"getVersionStatus",(function(){return d})),n.d(t,"getExpirationDate",(function(){return h})),function(e){e.Latest="Latest",e.UpdateAvailable="UpdateAvailable",e.SupportedUntilDate="SupportedUntilDate",e.NotSupported="NotSupported",e.Unknown="Unknown"}(s||(s={}))},7599:function(e,t,n){"use strict";n.r(t),n.d(t,"appManagementPageStyleClasses",(function(){return r}));var s=n(719),r=Object(s.mergeStyleSets)({appManagementPage:{selectors:{".ba-Pivot":{selectors:{".ms-Pivot":{paddingBottom:"20px"}}},".ba-CommandBar":{selectors:{".ms-CommandBar":{paddingLeft:"32px"}}}}}})},7601:function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceDetailList",(function(){return i}));var s=n(245),r=n(7602);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}class i extends s.PureComponent{constructor(e){super(e)}render(){return s.createElement("div",{style:{marginLeft:"8px"}},this.props.detailsProps.map(e=>s.createElement(r.ResourceDetail,o({key:e.title},e))))}}},7602:function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceDetailBase",(function(){return c})),n.d(t,"ResourceDetail",(function(){return l}));var s=n(1090),r=n(545),o=n(245),i=n(7603);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var p=Object(r.classNamesFunction)();function c(e){var{icon:t,content:n,linkProps:r,webLinkAriaLabel:i,title:c,styles:l,theme:u}=e;if(!t&&!n&&!r)return o.createElement("div",null);var m,d,h=p(l,{theme:u}),g=null;return t&&(m=o.createElement("img",{style:{verticalAlign:"middle"},className:h.detailIcon,src:t,alt:c})),r&&(d=o.createElement(s.Link,a({},r,{target:"_blank","aria-label":i}))),n&&(g=o.createElement("span",null,n)),o.createElement("div",{className:h.root},o.createElement("div",{className:h.detailTitle},c),o.createElement("div",{className:h.detailContent},m,d,g))}var l=Object(r.styled)(c,i.getStyles)},7603:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return s}));var s=e=>({root:["detail",{marginBottom:"20px",fontSize:"12px",letterSpacing:"0"}],detailTitle:["detail-title",{fontSize:"14px",letterSpacing:"0",lineHeight:"18px",paddingBottom:"6px"}],detailIcon:["detail-icon",{height:"28px",marginRight:"7px"}],detailContent:"detail-content"})},7610:function(e,t,n){"use strict";n.r(t),n.d(t,"getVersionsListItems",(function(){return O})),n.d(t,"mapStateToProps",(function(){return P})),n.d(t,"mapDispatchToProps",(function(){return S})),n.d(t,"mergeProps",(function(){return E})),n.d(t,"VersionsListContainer",(function(){return j}));var s=n(2812),r=n(5437),o=n(5797),i=n(5629),a=n(2869),p=n(2880),c=n(5630),l=n(5981),u=n(5648),m=n(5794),d=n(5649),h=n(5595),g=n(7611),b=n(5669),f=n(2835),v=n(2871);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){var n=[];if(e&&e.length){var r=e.length,i=Object(s.orderBy)(e,e=>e.properties.appVersion,"desc"),{live:c,draft:l}=o.getActionableVersionsIndices(i);n=e.map(n=>{var s=r--,i=o.getClientVersion(n),u=o.getAppVersionId(n),m={key:u,id:u,version:Object(p.formatResourceString)(Object(a.getResources)().App.Versions.versionName,s),appDateVersion:o.getVersionLocaleString(n),lastModifiedBy:o.getLastModifiedByDisplayName(n),clientVersion:i?"".concat(i.major,".").concat(i.minor,".").concat(i.build):"",isLive:v.featureGates.enableIsLive?n.isLive:s===c,lastPublishTime:o.getLastPublishTime(n),commitMessage:o.getCommitMessage(n)||"",isPublishable:s===l,isVersionOperationsDisabled:r===e.length-1,currentIndex:s,newIndex:e.length+1,extendedApp:t,appVersion:n};return m.filterOn=[m.version,m.appDateVersion,m.lastModifiedBy,m.clientVersion,m.commitMessage],m})}return n}function P(e,t){var n,s,r=null!==(n=t.appId&&Object(f.appIdToName)(t.appId)||t.appName)&&void 0!==n?n:"",o=Object(d.appSelector)(e,Object(m.getAppId)(r)),a=null!==(s=Object(d.appVersionsError)(e))&&void 0!==s?s:"";return{appName:r,versionListItems:O(Object(d.appVersionsSelector)(e,r),o),errorMessage:a,onAppVersionSelect:t.onAppVersionSelect,loadProgress:[Object(i.toLoadingState)(Object(d.isAppVersionsCacheComplete)(e,r)&&!!o,a)],logEvent:h.CanvasAppVersionsLoadEvent}}function S(e){return{fetchApp:t=>e(Object(u.fetchAppRequest)({appName:t})),fetchAppVersions:t=>e(l.appsActions.fetchAppVersionsRequest({appName:t})),fetchAppVersionsCancelPoll:()=>e(l.appsActions.fetchAppVersionsCancelPoll()),appVersionCommandActions:{onAppVersionRestoreClick:(t,n)=>e(Object(c.logAction)(l.appsActions.openRestoreAppVersionDialog({appName:t,appVersionListItem:n}),h.CanvasAppVersionsActionEvents.Restore.eventName,h.CanvasAppVersionsActionEvents.Restore.getData(n))),onAppVersionDeleteClick:(t,n)=>e(Object(c.logAction)(l.appsActions.openDeleteAppVersionDialog({appName:t,appVersionListItem:n}),h.CanvasAppVersionsActionEvents.OpenDeleteDialog.eventName,h.CanvasAppVersionsActionEvents.OpenDeleteDialog.getData(n))),onAppVersionPublishClick:t=>e(Object(c.logAction)(l.appsActions.publishAppVersion({appVersionListItem:t}),h.CanvasAppVersionsActionEvents.Publish.eventName,h.CanvasAppVersionsActionEvents.Publish.getData(t)))},clearRestoreAppVersionResponse:()=>e(Object(u.clearRestoreAppVersionResponse)()),clearDeleteAppVersionResponse:()=>e(Object(u.clearDeleteAppVersionResponse)()),dispatchTelemetry:e}}var E=(e,t,n)=>C(C({onMount:()=>{t.fetchApp(e.appName),t.fetchAppVersions(e.appName)},onDismount:()=>{t.fetchAppVersionsCancelPoll(),t.clearRestoreAppVersionResponse(),t.clearDeleteAppVersionResponse()},appVersionCommandActions:t.appVersionCommandActions,isUsingSolutionTree:n.isUsingSolutionTree,searchFilter:n.searchFilter},e),{},{dispatchTelemetry:t.dispatchTelemetry,isViewOnlyMode:n.isViewOnlyMode}),j=Object(r.connect)(P,S,E)(Object(i.withLoadTelemetry)(g.VersionsList,b.LoadScenarioNames.VersionsList))},7611:function(e,t,n){"use strict";n.r(t),n.d(t,"VersionsList",(function(){return C}));var s=n(3161),r=n(3064),o=n(1471),i=n(545),a=n(245),p=n(5628),c=n(5629),l=n(2879),u=n(2869),m=n(5633),d=n(7612),h=n(7613),g=n(1090),b=n(1697),f=n(1240),v=n(5481);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}class C extends a.Component{constructor(e){super(e),this.resources=void 0,this.selection=void 0,this.columns=void 0,this.selectedAppVersion=void 0,this.onRenderItemColumn=(e,t,n)=>{if(!n)return null;var s=e[n.fieldName];switch(n.key){case"commitMessage":return a.createElement(f.TooltipHost,{styles:{root:{width:"100%"}},content:s},a.createElement("div",{className:"truncate"},s));default:return a.createElement("span",null,s)}},this.resources=Object(u.getResources)(),this.selection=new o.Selection({onSelectionChanged:()=>{this.selectedAppVersion=this.selection.getSelection()[0],this.props.onAppVersionSelect(this.selectedAppVersion)}}),this.columns=this.buildColumns()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onAppVersionSelect(void 0),this.props.onDismount()}render(){var{isViewOnlyMode:e}=this.props;return a.createElement("div",null,!e&&a.createElement(b.MessageBar,{messageBarType:b.MessageBarType.info},this.resources.App.Versions.versionRestoreAgeLimit,a.createElement(g.Link,{href:v.default.restoreCanvasAppVersionLink,target:"_blank"},this.resources.Common.learnMore)),a.createElement("div",{className:h.versionsListStyleClasses.appVersionsList},a.createElement(r.DetailsList,y({isLoading:Object(c.isLoading)(this.props.loadProgress),isError:Object(c.getTotalLoadingState)(this.props.loadProgress)===c.ComponentLoadState.Fail,renderOnError:()=>{var e=this.getPropsOnError();return a.createElement(s.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return a.createElement(s.EmptyState,e)},items:this.props.versionListItems,columns:this.columns,setKey:"setAppVersionsListItems",selectionMode:i.SelectionMode.single,selection:this.selection,onRenderItemColumn:this.onRenderItemColumn,onColumnHeaderClick:()=>null},Object(m.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel)))))}buildColumns(){var{isViewOnlyMode:e}=this.props,t=Object(r.buildMenuColumn)(e=>({items:Object(d.getAppVersionCommands)(e,this.props.appVersionCommandActions),iconAriaLabel:this.resources.Common.commands})),n=[{key:"version",name:this.resources.App.Versions.version,fieldName:"version",minWidth:this.props.isUsingSolutionTree?60:100,maxWidth:this.props.isUsingSolutionTree?60:160,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,ariaLabel:this.resources.App.Versions.version},{key:"appDateVersion",name:this.resources.App.Versions.modified,fieldName:"appDateVersion",minWidth:this.props.isUsingSolutionTree?120:100,maxWidth:this.props.isUsingSolutionTree?120:160,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,ariaLabel:this.resources.App.Versions.modified},{key:"lastModifiedBy",name:this.resources.App.Versions.modifiedBy,fieldName:"lastModifiedBy",minWidth:100,maxWidth:160,isResizable:!0,isCollapsable:!this.props.isUsingSolutionTree,isMultiline:!1,isPadded:!0,ariaLabel:this.resources.App.Versions.modifiedBy},{key:"clientVersion",name:this.resources.App.Versions.clientVersion,fieldName:"clientVersion",minWidth:100,maxWidth:this.props.isUsingSolutionTree?100:160,isResizable:!0,isCollapsable:!this.props.isUsingSolutionTree,isMultiline:!1,isPadded:!0,ariaLabel:this.resources.App.Versions.clientVersion},{key:"isLive",name:this.resources.App.Versions.published,fieldName:"isLive",minWidth:this.props.isUsingSolutionTree?50:100,maxWidth:this.props.isUsingSolutionTree?50:160,isResizable:!0,isCollapsable:!this.props.isUsingSolutionTree,isMultiline:!1,isPadded:!0,ariaLabel:this.resources.App.Versions.published,onRender:e=>e.isLive?a.createElement("span",{className:"badge ms-fontColor-neutralPrimary"},this.resources.Apps.Versions.liveLabel):null},{key:"commitMessage",name:this.resources.App.Versions.comment,fieldName:"commitMessage",minWidth:100,maxWidth:160,isResizable:!0,isCollapsable:!this.props.isUsingSolutionTree,isMultiline:!1,isPadded:!0,ariaLabel:this.resources.App.Versions.comment}];return e||n.splice(1,0,t),n}getPropsOnError(){return{icon:l.fabricIcons.PowerAppsLogo,className:"app-versions-list-empty-message",primaryMessage:this.resources.Common.Request.Failed,secondaryMessage:[this.props.errorMessage],maxWidth:p.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:l.fabricIcons.PowerAppsLogo,className:"app-versions-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:p.emptyStateMaxWidth}}}},7612:function(e,t,n){"use strict";n.r(t),n.d(t,"getAppVersionCommands",(function(){return c}));var s=n(5596),r=n(5797),o=n(5617),i=n(2879),a=n(2869),p=n(2871);function c(e,t){var n,c,l,u,m=Object(a.getResources)(),d=e.extendedApp,h=s.getAppName(d);e.isPublishable?n=[{key:"PublishAppVersion",name:m.App.Versions.Manage.publishCommand,onClick:()=>{var n;null===(n=t.onAppVersionPublishClick)||void 0===n||n.call(t,e)},iconProps:{iconName:i.fabricIcons.Signout,className:"rotate-270deg",style:{color:null===o.fabricTheme||void 0===o.fabricTheme||null===(c=o.fabricTheme.palette)||void 0===c?void 0:c.themePrimary}}}]:(n=[{key:"RestoreAppVersion",name:m.App.Versions.Manage.restoreCommand,onClick:()=>{var n;null===(n=t.onAppVersionRestoreClick)||void 0===n||n.call(t,h,e)},iconProps:{iconName:i.fabricIcons.Refresh,style:{color:null===o.fabricTheme||void 0===o.fabricTheme||null===(l=o.fabricTheme.palette)||void 0===l?void 0:l.themePrimary}},disabled:!s.canPromote(d)||e.isVersionOperationsDisabled||Object(r.isAppVersionOld)(e)}],p.featureGates.enableIsLive&&e.isLive||n.push({key:"DeleteAppVersion",name:m.App.Versions.Manage.deleteCommand,onClick:()=>{var n;null===(n=t.onAppVersionDeleteClick)||void 0===n||n.call(t,h,e)},iconProps:{iconName:i.fabricIcons.Delete,style:{color:null===o.fabricTheme||void 0===o.fabricTheme||null===(u=o.fabricTheme.palette)||void 0===u?void 0:u.themePrimary}},disabled:!s.canDelete(d)||e.isVersionOperationsDisabled}));return n}},7613:function(e,t,n){"use strict";n.r(t),n.d(t,"versionsListStyleClasses",(function(){return i}));var s=n(719),r=n(2882),o=n(5492),i=Object(s.mergeStyleSets)({appVersionsList:{selectors:{".badge":{backgroundColor:r.fabricColors.neutralLight,borderRadius:"0",padding:"8px",fontFamily:o.fonts.segoeUiSemibold},".truncate":{width:"160px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}}})},7616:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return j})),n.d(t,"mapDispatchToProps",(function(){return R})),n.d(t,"mergeProps",(function(){return w})),n.d(t,"AppManagementPageContainer",(function(){return D}));var s=n(5437),r=n(2886),o=n(5629),i=n(5768),a=n(5623),p=n(5981),c=n(5648),l=n(5794),u=n(5649),m=n(5746),d=n(5690),h=n(5595),g=n(7617),b=n(5487),f=n(5582),v=n(5669),y=n(5583);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){return e&&e.match&&e.match.params&&e.match.params.apps||""}function S(e){return e&&e.match&&e.match.params&&e.match.params.solutionId||""}function E(e){return e&&e.match&&e.match.params&&e.match.params.environmentName||""}function j(e,t){var n,s,a,p,c,d,g,b=null!==(n=Object(f.currentEnvironmentIdSelector)(t))&&void 0!==n?n:"",v=null!==(s=null!==(a=t.selectedPivot)&&void 0!==a?a:null===(p=t.match)||void 0===p||null===(c=p.params)||void 0===c?void 0:c.manageTab)&&void 0!==s?s:"",y=null!==(d=null==t?void 0:t.appName)&&void 0!==d?d:P(t),C=Object(l.getAppId)(y),A=Object(u.appSelector)(e,C),O=Object(u.appError)(e,C)||Object(i.getSolutionsListResponseErrorMessage)(m.solutionsSelectors.solutionsListError(e,b)),j=S(t),R=!m.solutionsSelectors.isFetchingSolutionsStatus(e)&&!!A;return j&&(g=m.solutionsSelectors.solutionSelector(e,j),R=R&&!!g),{app:A,solutionId:j,solutionName:g?Object(r.getSolutionDisplayName)(g):void 0,selectedPivot:v,errorMessage:O,currentEnvironmentName:E(t),loadProgress:[Object(o.toLoadingState)(R,O)],logEvent:h.CanvasAppLoadEvent,restoreAppVersionResponse:Object(u.restoreAppResponse)(e),deleteAppVersionResponse:Object(u.deleteAppVersionResponse)(e)}}var R=(e,t)=>{var n,s=null!==(n=null==t?void 0:t.appName)&&void 0!==n?n:P(t);return{onAppsBreadcrumbClick:()=>{t.navigate(a.appsRoute.apps,!0)},onSolutionsBreadcrumbClick:()=>{t.navigate(a.solutionListRoute.canvas,!0)},onSolutionNameBreadCrumbClick:()=>{t.navigate(Object(a.getSolutionComponentsUrl)(E(t),S(t)),!0)},openShareAppModal:t=>e(p.appsActions.openShareAppModal({app:t})),openAppSettings:t=>e(p.appsActions.openAppSettings({app:t})),onDismount:()=>{e(Object(c.fetchAppsCancelPoll)())},clearRestoreAppVersionResponse:()=>{e(Object(c.clearRestoreAppVersionResponse)())},clearDeleteAppVersionResponse:()=>{e(Object(c.clearDeleteAppVersionResponse)())},onMount:()=>{var n=S(t);n&&e(Object(d.fetchSolutionByIdRequest)({solutionID:n})),e(Object(c.fetchAppRequest)({appName:s}))},dispatchTelemetry:e}},w=(e,t,n)=>{var{rootProps:s,disableHeader:r,enableTitleHeader:o,onPivotClick:i,isUsingSolutionTree:a,isViewOnlyMode:p}=n,{areShellProvidersReady:c}=s;return A(A(A({},e),t),{},{areShellProvidersReady:c,disableHeader:r,enableTitleHeader:o,onPivotClick:i,isUsingSolutionTree:a,isViewOnlyMode:p})},D=Object(y.withNavigation)(Object(b.withRootProps)(Object(s.connect)(j,R,w)(Object(o.withLoadTelemetry)(g.AppManagementPage,v.LoadScenarioNames.AppManagementPage))))},7617:function(e,t,n){"use strict";n.r(t),n.d(t,"AppManagementPage",(function(){return y}));var s=n(4792),r=n(4105),o=n(1200),i=n(1697),a=n(1201),p=n(245),c=n(303),l=n(5629),u=n(2879),m=n(3831),d=n(2869),h=n(5623),g=n(7618),b=n(7619),f=n(7635),v=n(7599);class y extends p.Component{constructor(e){super(e),this.breadCrumbItems=[],this.resources=void 0,this.resources=Object(d.getResources)(),this.state={selectedAppVersion:void 0,shareModalOpenedFromUrl:!1,appSettingsOpenFromUrl:!1,searchFilter:""}}onAppVersionSelect(e){this.setState({selectedAppVersion:e})}onSearchFilterUpdate(e){this.setState({searchFilter:e})}componentDidMount(){this.props.onMount(),this.onMountOrUpdate()}componentWillUnmount(){this.props.onDismount()}componentDidUpdate(){this.onMountOrUpdate()}render(){var{isViewOnlyMode:e}=this.props;if(!this.props.areShellProvidersReady)return p.createElement(o.PagePlaceholder,null);switch(Object(l.getTotalLoadingState)(this.props.loadProgress)){case l.ComponentLoadState.Complete:return this.initializeBreadCrumbItem(this.props.app),p.createElement(s.Page,{className:v.appManagementPageStyleClasses.appManagementPage,renderHeader:()=>this.props.disableHeader?p.createElement(p.Fragment,null):p.createElement(g.AppManagementCommandBarContainer,{selectedApp:this.props.app,selectedAppVersion:this.state.selectedAppVersion,selectedPivot:this.props.selectedPivot,solutionId:this.props.solutionId,onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this)}),spinnerProps:{label:this.props.restoreAppVersionResponse.loading?this.resources.Apps.Versions.Modal.Restore.inProgress:this.props.deleteAppVersionResponse.loading?this.resources.Apps.Versions.Modal.Delete.inProgress:""},showOverlay:this.props.restoreAppVersionResponse&&this.props.restoreAppVersionResponse.loading||this.props.deleteAppVersionResponse&&this.props.deleteAppVersionResponse.loading,renderMessageBar:()=>p.createElement(p.Fragment,null,this.getMessageBar(this.props.restoreAppVersionResponse,this.props.clearRestoreAppVersionResponse),this.getMessageBar(this.props.deleteAppVersionResponse,this.props.clearDeleteAppVersionResponse)),renderTitle:()=>{var e,t;return!this.props.disableHeader&&p.createElement(r.PageHeader,{wrapperClassName:"app-management-page-breadcrumb",titleBreadcrumbProps:{items:this.breadCrumbItems,ariaLabel:this.resources.Apps.AppManagement.Breadcrumbs.apps}})||this.props.enableTitleHeader&&p.createElement(r.PageHeader,{wrapperClassName:"app-management-page-breadcrumb",title:null===(e=this.props.app)||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.displayName})},renderBody:()=>p.createElement(f.AppManagementPivotsContainer,{selectedApp:this.props.app,selectedPivot:this.props.selectedPivot,onPivotClick:this.props.onPivotClick,onAppVersionSelect:this.onAppVersionSelect.bind(this),searchFilter:this.state.searchFilter,isUsingSolutionTree:this.props.isUsingSolutionTree,isViewOnlyMode:e})});case l.ComponentLoadState.Fail:var t={fromPattern:m.RoutePaths.appManagement,toPattern:m.RoutePaths.appsList,toFriendlyRouteName:m.FriendlyRouteNames.apps};return p.createElement(c.Redirect,{push:!0,to:{pathname:Object(h.getAppsListLaunchUri)(this.props.currentEnvironmentName),state:t}});default:return p.createElement("div",{className:"app-management-page"},p.createElement("div",{className:"app-management-page-spinner"},p.createElement(a.Spinner,{size:a.SpinnerSize.large})))}}getMessageBar(e,t){return e.message?p.createElement(i.MessageBar,{messageBarType:e.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:u.fabricIcons.Cancel,onDismiss:t},e.message):p.createElement(p.Fragment,null)}initializeBreadCrumbItem(e){var t;this.breadCrumbItems=[],this.props.solutionName?(this.breadCrumbItems.push({text:this.resources.Model.Solutions.ListPage.pageTitle,key:this.resources.Model.Solutions.ListPage.pageTitle,onClick:()=>{this.props.onSolutionsBreadcrumbClick()}}),this.breadCrumbItems.push({text:this.props.solutionName,key:this.props.solutionName,onClick:()=>{this.props.onSolutionNameBreadCrumbClick()}})):this.breadCrumbItems.push({text:this.resources.Apps.AppManagement.Breadcrumbs.apps,key:this.resources.Apps.AppManagement.Breadcrumbs.apps,onClick:()=>{this.props.onAppsBreadcrumbClick()}}),this.breadCrumbItems.push({text:null!==(t=e.properties.displayName)&&void 0!==t?t:"",key:e.id})}onMountOrUpdate(){this.props.app&&(this.props.selectedPivot!==b.AppManagementPivotNames.share||this.state.shareModalOpenedFromUrl?this.props.selectedPivot!==b.AppManagementPivotNames.settings||this.state.appSettingsOpenFromUrl||(this.props.openAppSettings(this.props.app),this.setState({appSettingsOpenFromUrl:!0})):(this.props.openShareAppModal(this.props.app),this.setState({shareModalOpenedFromUrl:!0})))}}},7618:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"AppManagementCommandBarContainer",(function(){return y}));var s=n(1222),r=n(5437),o=n(5487),i=n(6607),a=n(5630),p=n(5981),c=n(5636),l=n(7612),u=n(5647),m=n(5595),d=n(7619),h=n(5626),g=n(5583),b=(e,t)=>({enableTestStudio:Object(h.allowListFeaturesSelector)(e).EnableTestStudio}),f=(e,t)=>({appCommandActions:t.appCommandActions||{},appVersionCommandActions:{onAppVersionRestoreClick:(t,n)=>e(Object(a.logAction)(p.appsActions.openRestoreAppVersionDialog({appName:t,appVersionListItem:n}),m.CanvasAppVersionsActionEvents.Restore.eventName,m.CanvasAppVersionsActionEvents.Restore.getData(n))),onAppVersionDeleteClick:(t,n)=>e(Object(a.logAction)(p.appsActions.openDeleteAppVersionDialog({appName:t,appVersionListItem:n}),m.CanvasAppVersionsActionEvents.Delete.eventName,m.CanvasAppVersionsActionEvents.Delete.getData(n))),onAppVersionPublishClick:t=>e(Object(a.logAction)(p.appsActions.publishAppVersion({appVersionListItem:t}),m.CanvasAppVersionsActionEvents.Publish.eventName,m.CanvasAppVersionsActionEvents.Publish.getData(t)))}});var v=(e,t,n)=>{var s,r;return{items:n.selectedAppVersion?Object(l.getAppVersionCommands)(n.selectedAppVersion,t.appVersionCommandActions):Object(c.getAppCommandBarCommands)({commandActions:t.appCommandActions,specificAppOptions:{app:n.selectedApp,currentEnvironment:n.rootProps.currentEnvironment,currentSolutionId:n.solutionId},isDrilledIn:!0,enableTestStudio:e.enableTestStudio}),isSearchBoxVisible:(s=n.selectedPivot,r=n.selectedAppVersion,!(r||s===d.AppManagementPivotNames.details||s===d.AppManagementPivotNames.share||s===d.AppManagementPivotNames.analytics)),searchBoxProps:Object(i.getSearchBoxProps)(n.onSearchFilterUpdate)}},y=Object(g.withNavigate)(Object(u.withAppCommands)(m.AppContexts.AppsManagement.CommandBar)(Object(o.withRootProps)(Object(r.connect)(null,f,v)(s.CommandBarWithSearchBox))))},7619:function(e,t,n){"use strict";n.r(t),n.d(t,"AppManagementPivotNames",(function(){return m})),n.d(t,"AppManagementPivots",(function(){return d}));var s=n(1709),r=n(245),o=n(2889),i=n(2869),a=n(7620),p=n(7626),c=n(7627),l=n(7610),u=n(2871),m={details:"details",versions:"versions",connections:"connections",flows:"flows",analytics:"analytics",share:"share",settings:"settings"};class d extends r.Component{constructor(e){super(e),this.resources=void 0,this._onLinkClick=(e,t)=>{var n,s=null!==(n=null==e?void 0:e.props.itemKey)&&void 0!==n?n:"";this.props.onPivotClick(s)},this.resources=Object(i.getResources)()}render(){var{isViewOnlyMode:e}=this.props,t=this.sanitizePivot(this.props.selectedPivot),n=this.props.canUserEditApp&&u.featureGates.enableAnalytics?r.createElement(s.PivotItem,{linkText:this.resources.Apps.AppManagement.Pivots.analytics,itemKey:m.analytics},r.createElement(a.AppAnalyticsContainer,{appName:this.props.selectedAppName})):"";return r.createElement("div",{className:"app-management-page-pivots"},r.createElement(s.Pivot,{selectedKey:t,onLinkClick:this._onLinkClick,overflowBehavior:"menu"},r.createElement(s.PivotItem,{linkText:this.resources.Apps.AppManagement.Pivots.details,itemKey:m.details},r.createElement(p.AppDetailsContainer,{appName:this.props.selectedAppName,panelType:void 0})),r.createElement(s.PivotItem,{linkText:this.resources.Apps.AppManagement.Pivots.versions,itemKey:m.versions},r.createElement(l.VersionsListContainer,{appName:this.props.selectedAppName,onAppVersionSelect:this.props.onAppVersionSelect,searchFilter:this.props.searchFilter,isUsingSolutionTree:this.props.isUsingSolutionTree,isViewOnlyMode:e})),r.createElement(s.PivotItem,{linkText:this.resources.Apps.AppManagement.Pivots.connections,itemKey:m.connections},r.createElement(c.AppUsagesListContainer,{usageType:o.ResourceType.Connection,appName:this.props.selectedAppName,searchFilter:this.props.searchFilter})),r.createElement(s.PivotItem,{linkText:this.resources.Apps.AppManagement.Pivots.flows,itemKey:m.flows},r.createElement(c.AppUsagesListContainer,{usageType:o.ResourceType.Flow,appName:this.props.selectedAppName,searchFilter:this.props.searchFilter})),n))}sanitizePivot(e){switch(e){case m.versions:case m.connections:case m.flows:case m.analytics:case m.details:return e;case m.settings:case m.share:default:return m.details}}}},7620:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return v})),n.d(t,"mapDispatchToProps",(function(){return y})),n.d(t,"mergeProps",(function(){return C})),n.d(t,"AppAnalyticsContainer",(function(){return A}));var s=n(5437),r=n(3824),o=n(5487),i=n(5629),a=n(5630),p=n(5981),c=n(5649),l=n(5468),u=n(5595),m=n(7621),d=n(2872),h=n(5669);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){var n,s=Object(c.appReportsSelector)(e,t.appName),r=d.settings,o=null!==(n=Object(c.appReportsError)(e))&&void 0!==n?n:"",a=Object(c.currentEmbedDataSelector)(e);return{appReports:s||[],currentEmbedData:a,appName:null==a?void 0:a.appName,errorMessage:o,canAccessPremiumAnalyticsReports:t.currentPlansMetaData.canAccessPremiumAnalyticsReports,loadProgress:[Object(i.toLoadingState)(Object(c.isAppReportCacheComplete)(e,t.appName),o)],logEvent:u.CanvasAppReportsLoadEvent,accessTokenForApi:l.sharedSelectors.resourceTokenSelector(e,r.powerAppsResource)}}function y(e){return{fetchAppReports:t=>{e(p.appsActions.fetchAppReportsRequest({appName:t}))},changeSelectedReportTo:(t,n)=>{e(Object(a.logAction)(p.appsActions.fetchAppReportEmbedDataRequest({appName:n,appReport:t}),u.CanvasAppReportsActionEvents.ChangeSelectedReport.eventName,u.CanvasAppReportsActionEvents.ChangeSelectedReport.getData(t)))},dispatchTelemetry:e}}var C=(e,t,n)=>{var{rootProps:s,appName:r}=n;return b(b({onMount:()=>t.fetchAppReports(r),changeSelectedReportTo:e=>t.changeSelectedReportTo(e,r)},e),{},{dispatchTelemetry:t.dispatchTelemetry,currentEnvironment:s.currentEnvironment,accessTokenForApi:e.accessTokenForApi})},A=Object(r.withPlans)(Object(o.withRootProps)(Object(s.connect)(v,y,C)(Object(i.withLoadTelemetry)(m.AppAnalytics,h.LoadScenarioNames.AppAnalytics))))},7621:function(e,t,n){"use strict";n.r(t),n.d(t,"AppAnalytics",(function(){return y}));var s=n(2867),r=n(1567),o=n(1201),i=n(245),a=n(7622),p=n(7623),c=n(5795),l=n(7624),u=n(6387),m=n(5629),d=n(2869),h=n(2880),g=n(7625);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class y extends i.Component{constructor(e){super(e),this.resources=void 0,this.appReportsList=void 0,this.component=void 0,this.rootDashboardElement=void 0,this.changeState=e=>{this.setState({selectedItem:e,currentAppReport:this.getAppReport(e)},()=>{this.state.currentAppReport&&this.props.changeSelectedReportTo(this.state.currentAppReport),this.updateState()})},this.component=null,this.rootDashboardElement=null,this.resources=Object(d.getResources)(),this.appReportsList=Object(s.Map)(),this.state={selectedItem:{key:this.props.appReports[0]?this.props.appReports[0].id:void 0},currentAppReport:this.props.appReports[0],type:"report",tokenType:p.TokenType.Embed,accessToken:this.props.currentEmbedData?this.props.currentEmbedData.accessToken:"",embedUrl:this.props.currentEmbedData?this.props.currentEmbedData.embedUrl:"",settings:{filterPaneEnabled:!1,navContentPaneEnabled:!1,background:p.BackgroundType.Transparent}}}componentDidMount(){this.props.onMount()}componentDidUpdate(e,t){this.props.currentEmbedData&&""!==this.props.currentEmbedData.embedUrl&&e.currentEmbedData&&e.currentEmbedData.embedUrl!==this.props.currentEmbedData.embedUrl&&this.embedSelected(),this.props.currentEmbedData&&""!==this.props.currentEmbedData.embedUrl&&null===e.currentEmbedData&&this.embedSelected(),this.props.appName!==e.appName&&(this.reset(),this.embedSelected())}componentWillUnmount(){this.reset()}embed(e){return this.component=powerbi.embed(this.rootDashboardElement,e),this.state.onEmbedded&&this.state.onEmbedded(this.component),this.component}updateState(){if(this.props.currentEmbedData&&""!==this.props.currentEmbedData.embedUrl){var e=f(f({},this.state),{},{accessToken:this.props.currentEmbedData.accessToken,embedUrl:this.props.currentEmbedData.embedUrl,type:this.state.type,tokenType:this.state.tokenType,settings:this.state.settings,selectedItem:this.state.selectedItem,currentAppReport:this.state.currentAppReport,onEmbedded:this.state.onEmbedded});this.setState(e)}}embedSelected(){if(this.props.currentEmbedData&&""!=this.props.currentEmbedData.embedUrl&&""!==this.props.currentEmbedData.accessToken){var e={type:this.state.type,tokenType:p.TokenType.Embed,accessToken:this.props.currentEmbedData.accessToken,embedUrl:this.props.currentEmbedData.embedUrl,settings:this.state.settings};""!==e.embedUrl&&this.embed(e)}}reset(){try{powerbi.reset(this.rootDashboardElement),this.component=null}catch(e){}}UNSAFE_componentWillReceiveProps(e){e.appReports!==this.props.appReports&&e.appReports.length&&(this.appReportsList=Object(s.Map)(),e.appReports.map(e=>{this.appReportsList=this.appReportsList.set(e.id,e)}),this.setState({selectedItem:{key:e.appReports[0].id},currentAppReport:e.appReports[0]},()=>{this.props.changeSelectedReportTo(e.appReports[0]),this.updateState(),this.embedSelected()}))}validateConfig(e){return void 0===a.models.validateReportLoad(e)}render(){var e;if(Object(m.isLoading)(this.props.loadProgress))e=i.createElement("div",{className:"app-analytics-spinner"},i.createElement(o.Spinner,{size:o.SpinnerSize.large}));else{var t,n,s,a,p=this.props.appReports.map(e=>({key:e.id,text:e.properties.displayName}));if(Object(l.showCurrentReport)(this.state.currentAppReport,this.props.canAccessPremiumAnalyticsReports))t=i.createElement("div",{className:"app-analytics-header"},i.createElement("div",{className:"app-analytics-dropdown"},i.createElement(r.Dropdown,{className:"app-analytics-menu",selectedKey:null===(a=this.state.selectedItem)||void 0===a?void 0:a.key,onChanged:this.changeState,options:p})),i.createElement("div",{className:"app-analytics-details"},i.createElement("span",{className:"header-text"},Object(h.formatResourceString)(this.resources.Apps.Analytics.Header.dateRange,c.aggregationValue)," "),i.createElement("span",{className:"header-text left-border"},Object(h.formatResourceString)(this.resources.Apps.Analytics.Header.refreshDate,Object(l.getLastRefreshDate)(this.state.currentAppReport))))),n=i.createElement("div",{id:"appAnalyticsIFrame","aria-label":this.resources.Apps.Analytics.Report.ariaLabel,ref:e=>this.rootDashboardElement=e});Object(l.showCurrentReport)(this.state.currentAppReport,this.props.canAccessPremiumAnalyticsReports)||(s=i.createElement("div",{className:"inline-trial-analytics"},i.createElement(u.InlineTrialContainer,{scenarioDescription:this.resources.Apps.Analytics.InlineTrial.description}))),e=i.createElement("div",{className:"app-analytics"},t,i.createElement("div",{className:"report-container"},n,s))}return i.createElement("div",{className:g.appAnalyticsStyles["app-analytics-container"]},e)}getAppReport(e){return e&&e.key?this.appReportsList.get(e.key.toString()):void 0}}},7624:function(e,t,n){"use strict";function s(e){return e&&new Date(e.properties.lastReportRefreshTime).toLocaleString()||""}function r(e,t){return!!e&&(!e.properties.isPremium||t)}n.r(t),n.d(t,"getLastRefreshDate",(function(){return s})),n.d(t,"showCurrentReport",(function(){return r}))},7625:function(e,t,n){"use strict";n.r(t),n.d(t,"appAnalyticsStyles",(function(){return o}));var s=n(719),r=n(2882),o=Object(s.mergeStyleSets)({"app-analytics-container":{selectors:{".app-analytics":{marginLeft:"9px",marginRight:"35px",selectors:{".analytics-spinner .spinner":{top:"auto"},".app-analytics-header":{marginRight:"0",paddingBottom:"25px",selectors:{".app-analytics-dropdown":{display:"inline-block",width:"auto",minWidth:"160px",selectors:{".app-analytics-menu":{left:"auto",right:"auto"}}},".app-analytics-details":{display:"flex",float:"right",selectors:{".header-text":{padding:"7px 16px",selectors:{"& .left-border":{borderLeft:"1px solid ".concat(r.fabricColors.gray),paddingRight:"0px"}}}}}}},".report-container":{paddingTop:"61.8%",width:"100%",position:"relative",selectors:{iframe:{height:"100%",width:"100%",position:"absolute",top:"15px",bottom:"0",left:"0",right:"0",borderStyle:"none",paddingBottom:"50px"},".inline-trial-analytics":{height:"100%",width:"100%",position:"absolute",top:"15px"}}}}}}}})},7626:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return A})),n.d(t,"AppDetailsContainer",(function(){return O})),n.d(t,"getAppPlanClassifictationContent",(function(){return P}));var s=n(5437),r=n(245),o=n.n(r),i=n(215),a=n(5596),p=n(7601),c=n(2869),l=n(5794),u=n(5649),m=n(1259),d=n(2880),h=n(5481),g=n(2879),b=n(6004),f=n(2871),v=n(2836),y=n(5889);function C(e,t){var n=Object(u.appSelector)(e,Object(l.getAppId)(t.appName)),s=Object(c.getResources)(),r=a.getAppWebLink(n),p=a.getAppPlanClassification(n)||"",m=!Object(i.isTeamsRoute)()&&(null==n?void 0:n.appType)!==v.CustomCanvasPage;return{detailsProps:[{title:s.Controllers.Properties.ownerDisplayNameProperty,content:a.getAppOwnerDisplayName(n)},{title:s.Common.created,content:n&&a.getAppCreatedDate(n).toLocaleString()},{title:s.Common.modified,content:n&&a.getAppDateModified(n).toLocaleString()},...m?[{title:s.Directives.AppDetails.webLink,webLinkAriaLabel:s.Directives.AppDetails.webLinkAriaLabel,linkProps:{href:r,children:r}}]:[],{title:s.Directives.AppDetails.appid,content:a.getAppName(n),styles:{detailContent:{maxWidth:"500px"}}},...f.featureGates.enableAppPlanClassification&&p?[{title:s.Controllers.AppSettings.AppPlanClassification.title,content:n&&P(p,t.isPayGoBehaviorEnabled)||o.a.createElement(o.a.Fragment,null)}]:[]]}}var A=(e,t,n)=>e,O=Object(y.withPayGoBehavior)(Object(s.connect)(C,{},A)(p.ResourceDetailList));function P(e,t){var n=a.getAppPlanClassificationDetails(e,t),s=Object(c.getResources)();return n?o.a.createElement("div",{className:b.appSettingsPanelStyleClasses.appSettings},o.a.createElement("div",{className:"app-settings-section"},o.a.createElement("div",{className:"app-settings-infoButton"},o.a.createElement("label",{id:"lblAppClassificationPlanName"},n.displayName),o.a.createElement(m.TooltipHost,{content:Object(d.formatResourceStringAsLinks)(n.tooltip,[h.default.appPlanClassificationLink])},o.a.createElement(m.IconButton,{"aria-label":s.Directives.AppDetails.info,iconProps:{iconName:g.fabricIcons.Info}}))))):o.a.createElement(o.a.Fragment,null)}},7627:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return V})),n.d(t,"mapDispatchToProps",(function(){return k})),n.d(t,"mergeProps",(function(){return T})),n.d(t,"AppUsagesListContainer",(function(){return I}));var s=n(5437),r=n(5487),o=n(5803),i=n(5804),a=n(2889),p=n(5629),c=n(7628),l=n(2879),u=n(5481),m=n(2869),d=n(5623),h=n(5796),g=n(5807),b=n(5981),f=n(5648),v=n(5649),y=n(7509),C=n(6866),A=n(7514),O=n(5582),P=n(7629),S=n(5595),E=n(5669),j=n(5583),R=["connections","appConnectionIds","apis"];function w(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t,n,s){var r=Object(m.getResources)(),p=e===a.ResourceType.Flow,c=t.filter(e=>n&&n.some(t=>t===e.id)&&p===i.isFlowConnection(e)),d={usageResourcesListItems:c&&c.map(e=>function(e,t,n){if(null===e)return null;var s={key:e.id,id:e.id,title:i.getDisplayName(e),imageUrl:i.getIcon(e),usageResource:e};if(n)s.filterOn=[s.title];else{var r=i.getConnectionApi(e,t),a=r?o.getDisplayName(r):i.getConnectionApiName(e);s.subtitle=a,s.filterOn=[s.title,s.subtitle]}return s}(e,s,p)).filter(e=>!!e)};switch(e){case a.ResourceType.Flow:return L(L({},d),{},{emptyPrimaryMessage:r.Apps.AppManagement.Flows.Empty.primaryMessage,emptySecondaryMessage:r.Apps.AppManagement.Flows.Empty.secondaryMessage,emptyIcon:l.fabricIcons.Flow,emptyLink:u.default.helpAddFlowToApp});default:return L(L({},d),{},{emptyPrimaryMessage:r.Apps.AppManagement.Connections.Empty.primaryMessage,emptySecondaryMessage:r.Apps.AppManagement.Connections.Empty.secondaryMessage,emptyIcon:l.fabricIcons.Globe,emptyLink:u.default.helpAddConnectionToApp})}}function V(e,t){var n,s=null!==(n=Object(O.currentEnvironmentIdSelector)(t))&&void 0!==n?n:"",r=b.appsSelectors.isAppConnectionsCachedComplete(e,t.appName)&&y.connectionsSelectors.isConnectionListCachedComplete(e,s),o=Object(v.appConnectionsError)(e)||Object(A.connectionsListError)(e);return{errorMessage:o,loadProgress:[Object(p.toLoadingState)(r,o)],logEvent:S.CanvasAppConnectionsLoadEvent,connections:y.connectionsSelectors.connectionsSelector(e,s),appConnectionIds:b.appsSelectors.appConnectionIds(e,t.appName),apis:g.apisSelectorForCurrentEnv(e,s)}}function k(e,t){var{navigate:n}=t;return{onResourceListItemClick:t.usageType===a.ResourceType.Flow?()=>t.navigate(d.flowRoute,!0):t=>t.usageResource&&e(y.connectionsActions.openConnectionPivot({connection:t.usageResource,selectedPivot:P.ConnectionManagementPivotNames.details,navigate:n})),onMount:()=>{e(Object(h.fetchApisRequest)()),e(Object(C.fetchConnectionsRequest)({forceRefresh:!0,inlcudeFlowConnections:!0})),e(Object(f.fetchAppConnectionsRequest)({appName:t.appName}))},onDismount:()=>{e(Object(h.fetchApisCancelPoll)()),e(Object(C.fetchConnectionsCancelPoll)())},dispatchTelemetry:e}}function T(e,t,n){var{connections:s,appConnectionIds:r,apis:o}=e,i=w(e,R),a=N(n.usageType,s,r,o);return L(L(L(L({},i),t),a),{},{searchFilter:n.searchFilter})}var I=Object(j.withNavigation)(Object(r.withRootProps)(Object(s.connect)(V,k,T)(Object(p.withLoadTelemetry)(c.UsageResourcesList,E.LoadScenarioNames.AppUsagesList))))},7628:function(e,t,n){"use strict";n.r(t),n.d(t,"UsageResourcesList",(function(){return m}));var s=n(3064),r=n(3161),o=n(545),i=n(245),a=n(5628),p=n(5629),c=n(2869),l=n(5633);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}class m extends i.Component{constructor(e){super(e),this.resources=void 0,this.selection=void 0,this.columns=void 0,this.resources=Object(c.getResources)(),this.columns=this.buildColumns()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){var e;return e=i.createElement(s.DetailsList,u({isLoading:Object(p.isLoading)(this.props.loadProgress),renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return i.createElement(r.EmptyState,e)},isError:Object(p.getTotalLoadingState)(this.props.loadProgress)===p.ComponentLoadState.Fail,renderOnError:()=>{var e=this.getPropsOnError();return i.createElement(r.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return i.createElement(r.EmptyState,e)},items:this.props.usageResourcesListItems,columns:this.columns,setKey:"set",selection:this.selection,selectionMode:o.SelectionMode.none,className:"usage-resources-list-container",onRenderRow:(e,t)=>i.createElement("div",{className:"usage-resources-list-row-container",onClick:()=>this.onItemClick(e.item)},t(e))},Object(l.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel))),i.createElement("div",{className:"usage-resources-list"},e)}buildColumns(){return[Object(s.buildIconColumn)(e=>this.convertItemToIconColumn(e,this.props),s.RowHeight.large),{key:"name",name:this.resources.Common.name,fieldName:"name",minWidth:200,maxWidth:350,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,onRender:e=>i.createElement(s.DetailsListLink,{linkText:e.title,linkSubheading:e.subtitle,linkProps:{role:"link"}}),ariaLabel:this.resources.Common.name}]}onItemClick(e){this.props.onResourceListItemClick(e)}convertItemToIconColumn(e,t){return{iconUri:e.imageUrl,iconAltText:e.title,defaultIconUrl:t.defaultIconUrl,iconBackgroundColor:e.imageBackgroundColor}}getPropsOnEmpty(){return{icon:this.props.emptyIcon,className:"usage-resources-list-empty-message",primaryMessage:this.props.emptyPrimaryMessage,secondaryMessage:[this.props.emptySecondaryMessage],learnMoreLabel:this.props.learnMoreLabel,learnMoreProps:this.props.learnMoreProps,maxWidth:a.emptyStateMaxWidth}}getPropsOnError(){return{icon:this.props.emptyIcon,className:"usage-resources-list-empty-message",primaryMessage:this.resources.Common.Request.Failed,secondaryMessage:[this.props.errorMessage],maxWidth:a.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:this.props.emptyIcon,className:"usage-resources-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:a.emptyStateMaxWidth}}}},7629:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionManagementPivotNames",(function(){return c})),n.d(t,"ConnectionManagementPivots",(function(){return l}));var s=n(1709),r=n(245),o=n(2889),i=n(2869),a=n(7630),p=n(7633),c={details:"details",apps:"apps",flows:"flows",share:"share"};class l extends r.Component{constructor(e){super(e),this.resources=void 0,this._onLinkClick=(e,t)=>{var n,s=null!==(n=null==e?void 0:e.props.itemKey)&&void 0!==n?n:"";this.props.onPivotClick(s)},this.resources=Object(i.getResources)()}render(){return r.createElement("div",{className:"connection-management-page-pivots"},r.createElement(s.Pivot,{defaultSelectedKey:this.props.selectedPivot,onLinkClick:this._onLinkClick,overflowBehavior:"menu"},r.createElement(s.PivotItem,{linkText:this.resources.Connections.ConnectionManagement.Pivots.details,itemKey:c.details},r.createElement(a.ConnectionDetailsContainer,{connection:this.props.connection,api:this.props.api})),r.createElement(s.PivotItem,{linkText:this.resources.Connections.ConnectionManagement.Pivots.apps,itemKey:c.apps},r.createElement(p.ConnectionUsagesListContainer,{connection:this.props.connection,searchFilter:this.props.searchFilter,usageType:o.ResourceType.App})),r.createElement(s.PivotItem,{linkText:this.resources.Connections.ConnectionManagement.Pivots.flows,itemKey:c.flows},r.createElement(p.ConnectionUsagesListContainer,{connection:this.props.connection,searchFilter:this.props.searchFilter,usageType:o.ResourceType.Flow}))))}sanitizePivot(e){switch(e){case c.details:case c.apps:case c.flows:return e;case c.share:default:return c.details}}}},7630:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return h})),n.d(t,"mapDispatchToProps",(function(){return g})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"ConnectionDetailsContainer",(function(){return f}));var s=n(5437),r=n(5803),o=n(5804),i=n(7534),a=n(2869),p=n(5623),c=n(7509),l=n(6866),u=n(7514),m=n(7631),d=n(5583);function h(e,t){return{connectionGateway:Object(u.connectionGateway)(e,t.connection.id)}}var g=(e,t)=>({onFixConnection:t=>e(c.connectionsActions.consentConnection({connection:t,useFirstPartyConsent:!0})),fetchConnectionGatewayRequest:(t,n)=>e(Object(l.fetchConnectionGatewayRequest)({connectionId:t,gatewayId:n})),fetchConnectionGatewayCancelPoll:()=>e(Object(l.fetchConnectionGatewayCancelPoll)()),navigateToGatewayDetails:e=>t.navigate(Object(p.getGatewayDetailsUrl)(e),!0)}),b=(e,t,n)=>{var s,p=n.connection,c=n.api,l=r.isPremiumApi(c),u=o.getConnectionGatewayId(n.connection),m=null,d=e.connectionGateway;return d?(s={onClick:()=>t.navigateToGatewayDetails(d.id),children:i.getDisplayName(d)},m=""):u&&(m=Object(a.getResources)().Common.Loading.ellipses),{apiDisplayName:r.getDisplayName(c),description:r.getDescription(c),connectionIcon:r.getIconUri(c),connection:p,api:c,status:o.getStatusMessage(p),gatewayLinkProps:s,gatewayLoading:m,owner:o.getOwnerDisplayName(p),createdDate:o.getCreatedTime(p).toLocaleString(),modifiedDate:o.getDateModified(p).toLocaleString(),isPremium:l,isConnectionInError:o.isConnectionInAuthError(p),isConnectionAuthError:o.isConnectionInError(p),onFixConnection:()=>t.onFixConnection(p),onMount:()=>{u&&t.fetchConnectionGatewayRequest(n.connection.id,u)},onDismount:()=>{t.fetchConnectionGatewayCancelPoll()}}},f=Object(d.withNavigation)(Object(s.connect)(h,g,b)(m.ConnectionDetails))},7631:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionDetails",(function(){return c}));var s=n(1090),r=n(245),o=n(7632),i=n(7601),a=n(5493),p=n(2869);class c extends r.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(p.getResources)()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){var e;return this.props.isConnectionAuthError&&(e=r.createElement(s.Link,{onClick:()=>this.props.onFixConnection(this.props.connection),role:"link"},this.resources.Controllers.Connection.updatePassword)),r.createElement(i.ResourceDetailList,{detailsProps:[{title:this.resources.Connections.ConnectionManagement.Details.connectorName,icon:this.props.connectionIcon,content:this.props.apiDisplayName},{title:this.resources.Connections.ConnectionManagement.Details.description,content:r.createElement("div",{className:"description"},this.props.description,this.props.isPremium&&r.createElement("div",{className:"badgeContainer"},r.createElement(o.Badge,{text:this.resources.Controllers.Connections.premium})))},{title:this.resources.Connections.ConnectionManagement.Details.status,icon:this.props.isConnectionInError?a.default.getPaths().alertWarning:void 0,content:r.createElement("div",{className:"status-message"},r.createElement("div",null,this.props.status),e)},{title:this.resources.Connections.ConnectionManagement.Details.gateway,linkProps:this.props.gatewayLinkProps,content:this.props.gatewayLoading},{title:this.resources.Controllers.Properties.ownerDisplayNameProperty,content:this.props.owner},{title:this.resources.Common.created,content:this.props.createdDate},{title:this.resources.Common.modified,content:this.props.modifiedDate}]})}}},7632:function(e,t,n){"use strict";n.r(t),n.d(t,"BadgeSize",(function(){return s})),n.d(t,"Badge",(function(){return p}));var s,r=n(245);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.small=0]="small",e[e.medium=1]="medium"}(s||(s={}));var a=[];a[s.small]={fontSize:"9px",paddingHorizontal:6,paddingVertical:.5},a[s.medium]={fontSize:"10px",paddingHorizontal:6,paddingVertical:3};class p extends r.Component{constructor(e){super(e),this.props=e,this._badgeSizeMetric=void 0;var t=void 0===e.size?s.medium:e.size;this._badgeSizeMetric=a[t]}render(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({fontSize:this._badgeSizeMetric.fontSize,paddingTop:this._badgeSizeMetric.paddingVertical,paddingRight:this._badgeSizeMetric.paddingHorizontal,paddingBottom:this._badgeSizeMetric.paddingVertical,paddingLeft:this._badgeSizeMetric.paddingHorizontal},this.props.styles||{});return r.createElement("div",{className:"pa-react-badge",style:e},r.createElement("span",{className:"text"},this.props.text))}}},7633:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return R})),n.d(t,"mapDispatchToProps",(function(){return w})),n.d(t,"mergeProps",(function(){return D})),n.d(t,"ConnectionUsagesListContainer",(function(){return L}));var s=n(5437),r=n(5596),o=n(5804),i=n(2889),a=n(5629),p=n(7628),c=n(2879),l=n(5493),u=n(2869),m=n(5623),d=n(5648),h=n(6866),g=n(7514),b=n(7634),f=n(5669),v=n(5583),y=["allConnectionUsages"],C=["getOnDetailClick"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E(e){if(null===e)return null;var t={key:e.id,id:e.id,title:r.getAppDisplayName(e),imageUrl:r.getAppBackgroundImageUri(e),imageBackgroundColor:r.getAppBackgroundColor(e),usageResource:e};return t.filterOn=[t.title],t}function j(e){if(null===e)return null;var t={key:e.id,id:e.id,title:o.getDisplayName(e),imageUrl:o.getIcon(e),usageResource:e};return t.filterOn=[t.title],t}function R(e,t){var n=Object(g.connectionUsagesError)(e),s=Object(g.connectionUsages)(e,t.connection.id)||{apps:[],connections:[]};return{loadProgress:[Object(a.toLoadingState)(Object(g.isConnectionUsagesCachedComplete)(e,t.connection.id),n)],allConnectionUsages:s,errorMessage:n}}function w(e,t){return{onMount:()=>e(Object(h.fetchConnectionUsagesRequest)({connectionId:t.connection.id})),onDismount:()=>e(Object(h.fetchConnectionUsagesCancelPoll)()),dispatchTelemetry:e}}function D(e,t,n){var{allConnectionUsages:s}=e,o=S(e,y),a=function(e,t,n){var s=Object(u.getResources)();switch(e){case i.ResourceType.Flow:var o=t.connections;return{usageResourcesListItems:o&&o.map(j),getOnDetailClick:e=>e=>n(m.flowRoute,!0),emptyPrimaryMessage:s.Connections.ConnectionManagement.Flows.Empty.primaryMessage,emptyIcon:c.fabricIcons.Flow,defaultIconUrl:l.default.getPaths().defaultConnectionIcon,logEvent:b.ConnectionFlowsLoadEvent};default:var a=t.apps;return{usageResourcesListItems:a&&a.map(E),getOnDetailClick:e=>t=>e(d.openAppDetails({app:t.usageResource,navigate:n})),emptyPrimaryMessage:s.Connections.ConnectionManagement.Apps.Empty.primaryMessage,emptyIcon:c.fabricIcons.PowerAppsLogo,defaultIconUrl:r.DefaultAppBackgroundImageUri,logEvent:b.ConnectionAppsLoadEvent}}}(n.usageType,s,n.navigate),{getOnDetailClick:p}=a,h=S(a,C);return O(O(O(O({},o),t),h),{},{onResourceListItemClick:p(t.dispatchTelemetry),searchFilter:n.searchFilter})}var L=Object(v.withNavigation)(Object(s.connect)(R,w,D)(Object(a.withLoadTelemetry)(p.UsageResourcesList,f.LoadScenarioNames.ConnectionUsagesList)))},7634:function(e,t,n){"use strict";function s(e){return{resourceType:"connection",id:e.id,apiId:e.properties.apiId,status:e.properties.statuses}}n.r(t),n.d(t,"getConnectionData",(function(){return s})),n.d(t,"ConnectionsListLoadEvent",(function(){return r})),n.d(t,"ConnectionsManagementLoadEvent",(function(){return o})),n.d(t,"ApiListLoadEvent",(function(){return i})),n.d(t,"CreateNewConnectionEvent",(function(){return a})),n.d(t,"ConnectionsListMenuEvents",(function(){return p})),n.d(t,"ConnectionsFetchScenarioName",(function(){return c})),n.d(t,"ConnectionAppsLoadEvent",(function(){return l})),n.d(t,"ConnectionFlowsLoadEvent",(function(){return u})),n.d(t,"ConnectionGatewayLoadEvent",(function(){return m}));var r={eventName:"Connections.Load"},o={eventName:"Connections.Connection.Load"},i={eventName:"Apis.Load"},a={eventName:"Connections.Create",getData:e=>({resourceType:"api",id:e&&e.id,name:e&&e.name})},p={Edit:{eventName:"Connections.Connection.Edit.Clicked",getData:s},Share:{eventName:"Connections.Connection.Share.Clicked",getData:s},Consent:{eventName:"Connections.Connection.Consent.Clicked",getData:s},Delete:{eventName:"Connections.Connection.Delete.Clicked",getData:s},Details:{eventName:"Connections.Connection.Details.Clicked",getData:s}},c="Connections.ConnectionsList.Fetch",l={eventName:"Connections.ConnectionApps.Load"},u={eventName:"Connections.ConnectionFlows.Load"},m={eventName:"Connections.ConnectionGateway.Load"}},7635:function(e,t,n){"use strict";n.r(t),n.d(t,"mergeProps",(function(){return c})),n.d(t,"AppManagementPivotsContainer",(function(){return l}));var s=n(5437),r=n(5596),o=n(5637),i=n(5623),a=n(7619),p=n(5583),c=(e,t,n)=>{var s,a=Object(r.getAppName)(n.selectedApp);return{isUsingSolutionTree:n.isUsingSolutionTree,selectedAppName:a,canUserEditApp:Object(o.canUserEditResource)(n.selectedApp),selectedPivot:n.selectedPivot,onPivotClick:null!==(s=n.onPivotClick)&&void 0!==s?s:e=>{n.navigate(Object(i.getAppSubroute)(a,e),!0)},onAppVersionSelect:n.onAppVersionSelect,searchFilter:n.searchFilter,isViewOnlyMode:n.isViewOnlyMode}},l=Object(p.withNavigation)(Object(s.connect)(null,{},c)(a.AppManagementPivots))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/252.0efc9fca.chunk.js.map