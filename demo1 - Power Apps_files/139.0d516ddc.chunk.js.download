/*! For license information please see 139.0d516ddc.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{5819:function(e,t,r){"use strict";var o;r.r(t),r.d(t,"PowerBIArtifactSolutionComponentTypes",(function(){return o})),r.d(t,"DISPLAY_NAME_MAX_LENGTH",(function(){return n})),function(e){e.PowerBIReport="PowerBIReport",e.PowerBIDataset="PowerBIDataset"}(o||(o={}));var n=100},5820:function(e,t,r){"use strict";r.r(t),r.d(t,"fetchPowerBIWorkspacesList",(function(){return l})),r.d(t,"fetchPowerBIArtifactsList",(function(){return P})),r.d(t,"applyAllParametersForDatasetInPowerBI",(function(){return w})),r.d(t,"fetchPowerBIMashupParametersForDataset",(function(){return y})),r.d(t,"fetchPowerBIReportEmbeddingDetails",(function(){return h})),r.d(t,"fetchPowerBIDatasetDetails",(function(){return B})),r.d(t,"fetchPowerBIArtifactComponent",(function(){return C})),r.d(t,"fetchPowerBIMashupParameterComponent",(function(){return O})),r.d(t,"createPowerBIArtifact",(function(){return A})),r.d(t,"editPowerBIArtifact",(function(){return N})),r.d(t,"editPowerBIMashupParameter",(function(){return T})),r.d(t,"addPowerBIMashupParameter",(function(){return k})),r.d(t,"fetchEnvironmentVariableDefinitions",(function(){return F})),r.d(t,"fetchParameterComponentsFromDataverse",(function(){return E})),r.d(t,"detectAndApplyPowerBICustomizations",(function(){return x}));var o=r(222),n=r(5819),a=r(217),i=r(5821);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t,r,o,n,a,i){try{var p=e[a](i),c=p.value}catch(s){return void r(s)}p.done?t(c):Promise.resolve(c).then(o,n)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function i(e){u(a,o,n,i,p,"next",e)}function p(e){u(a,o,n,i,p,"throw",e)}i(void 0)}))}}function l(e){return d.apply(this,arguments)}function d(){return(d=m((function*(e){var t=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIWorkspaces);try{var r=yield e.executeOperation("pbi_RetrievePowerBIWorkspaces","GET",{});t.progress({CurrentStep:"Power BI groups retrieved"});var o=[];return null!==r&&null!=r&&r.pbi_Workspaces&&(o=JSON.parse(r.pbi_Workspaces)),t.complete({groupsLength:o.length}),Promise.resolve(o)}catch(n){return t.failure({error:n}),Promise.reject(n)}}))).apply(this,arguments)}function P(e,t,r,o){return f.apply(this,arguments)}function f(){return(f=m((function*(e,t,r,o){var p=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIReports);try{var c=o?",pbi_IgnoreExistingReferencesForObjectId=".concat(o):"",s=yield e.executeOperation("".concat(r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?"pbi_RetrievePowerBIReports":"pbi_RetrievePowerBIDatasets","(pbi_WorkspaceObjectId=").concat(t).concat(c,")"),"GET",{});p.progress({CurrentStep:"Power BI artifacts retrieved"});var u=r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?null==s?void 0:s.pbi_Reports:null==s?void 0:s.pbi_Datasets,m=[];if(null!==s&&u)m=JSON.parse(u).map(e=>({id:e.id,name:e.name,type:r,properties:{workspaceId:t,owner:e.owner,lastRefreshTime:e.lastRefreshTime}}));return p.complete({reportsLength:m.length}),Promise.resolve(m)}catch(l){return p.failure({error:l}),Promise.reject(l)}}))).apply(this,arguments)}function w(e,t){return I.apply(this,arguments)}function I(){return(I=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.applyAllParametersForDatasetInPowerBI);r.progress({CurrentStep:"Mashup parameters are being set in PowerBI"});try{yield e.executeOperation("pbi_ApplyParametersForDatasetInPowerBI()","POST",{},{pbi_Id:t}),r.complete()}catch(o){return r.failure({error:o}),Promise.reject(o)}}))).apply(this,arguments)}function y(e,t){return b.apply(this,arguments)}function b(){return(b=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIMashupParametersForDataset);try{var o=yield e.executeOperation("pbi_RetrievePowerBIMashupParametersForDataset(pbi_Id=".concat(t,")"),"GET",{});r.progress({CurrentStep:"Power BI mashup parameters retrieved for dataset"});var n=[];return null!==o&&null!=o&&o.pbi_MashupParameters&&(n=JSON.parse(o.pbi_MashupParameters)),r.complete({mashupParametersLength:n.length}),Promise.resolve(n)}catch(p){return r.failure({error:p}),Promise.reject(p)}}))).apply(this,arguments)}function h(e,t){return v.apply(this,arguments)}function v(){return(v=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIReportEmbeddingDetails);try{var o=yield e.executeOperation("pbi_RetrieveReportEmbeddingDetails(pbi_UniqueName='".concat(t,"')"),"GET",{});if(r.progress({CurrentStep:"Power BI report retrieved"}),null!==o){var n={name:o.pbi_ReportName,reportobjectid:o.pbi_ReportObjectId,powerbireportid:o.pbi_Id,workspaceobjectid:o.pbi_WorkspaceObjectId,weburl:o.pbi_ReportWebUrl,embedurl:o.pbi_ReportEmbedUrl};return r.complete({reportName:n.name,reportObjectId:n.reportobjectid,pbiReportId:n.powerbireportid,workspaceObjectId:n.workspaceobjectid,webUrl:n.weburl,embedurl:n.embedurl}),Promise.resolve(n)}return r.failure(new Error("Received empty response")),Promise.reject()}catch(p){return r.failure({error:p}),Promise.reject(p)}}))).apply(this,arguments)}function B(e,t){return S.apply(this,arguments)}function S(){return(S=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIDatasetDetails);try{var o=yield e.executeOperation("pbi_RetrieveDatasetDetails(pbi_UniqueName='".concat(t,"')"),"GET",{});if(r.progress({CurrentStep:"Power BI dataset retrieved"}),null!==o){var n={name:o.pbi_DatasetName,datasetobjectid:o.pbi_DatasetObjectId,powerbidatasetid:o.pbi_Id,workspaceobjectid:o.pbi_WorkspaceObjectId,weburl:o.pbi_DatasetWebUrl};return r.complete({datasetName:n.name,datasetObjectId:n.datasetobjectid,pbiReportId:n.powerbidatasetid,workspaceObjectId:n.workspaceobjectid,webUrl:n.weburl}),Promise.resolve(n)}return r.failure(new Error("Received empty response")),Promise.reject()}catch(p){return r.failure({error:p}),Promise.reject(p)}}))).apply(this,arguments)}function C(e,t,r){return j.apply(this,arguments)}function j(){return(j=m((function*(e,t,r){var o=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?i.TelemetryScenarioNames.fetchPowerBIReportComponent:i.TelemetryScenarioNames.fetchPowerBIDatasetComponent);try{var p=yield e.fetch(r,{id:t});return o.complete(c({artifactDisplayName:p.uniquename,artifactWorkspaceObjectId:p.workspaceobjectid},r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?{reportObjectId:p.reportobjectid}:{datasetObjectId:p.datasetobjectid})),n.PowerBIArtifactSolutionComponentTypes.PowerBIReport,Promise.resolve(p)}catch(s){return o.failure({error:s}),Promise.reject(s)}}))).apply(this,arguments)}function O(e,t){return D.apply(this,arguments)}function D(){return(D=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchPowerBIMashupParametersForDataset);try{var o=yield e.fetch("PowerBIMashupParameter",{id:t});return r.complete({parameterName:o.parametername,parameterValueSource:o.parametervaluesource,_environmentvariableid_value:o._environmentvariableid_value,_datasetid_value:o._datasetid_value}),Promise.resolve(o)}catch(n){return r.failure({error:n}),Promise.reject(n)}}))).apply(this,arguments)}function A(e,t,r,o,n,a){return _.apply(this,arguments)}function _(){return(_=m((function*(e,t,r,o,p,s){var u=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?i.TelemetryScenarioNames.createPowerBIReportComponent:i.TelemetryScenarioNames.createPowerBIDatasetComponent);try{return yield e.executeOperation("pbi_CloneAndAdd".concat(r,"()"),"POST",{"Content-Type":"application/json"},JSON.stringify(c({pbi_WorkspaceObjectId:p,pbi_UniqueName:s,pbi_SolutionUniqueName:t},r===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?{pbi_ReportObjectId:o}:{pbi_DatasetObjectId:o}))),u.complete(),Promise.resolve()}catch(m){return u.failure({error:m}),Promise.reject(m)}}))).apply(this,arguments)}function N(e,t,r,o,n,a,i){return R.apply(this,arguments)}function R(){return(R=m((function*(e,t,r,o,p,s,u){var m=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=Object(a.trackUpdateScenario)(i.PowerAppsPowerBIScope,u===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?i.TelemetryScenarioNames.editPowerBIReportComponent:i.TelemetryScenarioNames.editPowerBIDatasetComponent);try{var d=yield e.executeAction(u,"Update",{solutionName:t},c({name:o,workspaceobjectid:s},u===n.PowerBIArtifactSolutionComponentTypes.PowerBIReport?{reportobjectid:p,powerbireportid:r}:{datasetobjectid:p,powerbidatasetid:r,dataverseconnectionupdateenabled:m}));return l.complete(),Promise.resolve(d)}catch(P){return l.failure({error:P}),Promise.reject(P)}}))).apply(this,arguments)}function T(e,t,r,o,n,a){return g.apply(this,arguments)}function g(){return(g=m((function*(e,t,r,o,n,p){var c=Object(a.trackUpdateScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.editPowerBIMashupParameterComponent);try{var s=yield e.executeAction("PowerBIMashupParameter","Update",{solutionName:t},{powerbimashupparameterid:r,parametervaluesource:o,parameterliteralvalue:n,_environmentvariableid_value:p});return c.complete(),Promise.resolve(s)}catch(u){return c.failure({error:u}),Promise.reject(u)}}))).apply(this,arguments)}function k(e,t,r,o,n,a,i){return L.apply(this,arguments)}function L(){return(L=m((function*(e,t,r,n,p,c,s){var u=Object(a.trackUpdateScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.addPowerBIMashupParameterComponent);try{var m=yield e.executeAction("PowerBIMashupParameter","Create",{solutionName:t},{name:n,parametername:n,parametervaluesource:r,uniquename:"new_mashupparameter_".concat(Object(o.v4)()),parameterliteralvalue:c,_environmentvariableid_value:s,_datasetid_value:p});return u.complete(),Promise.resolve(m)}catch(l){return u.failure({error:l}),Promise.reject(l)}}))).apply(this,arguments)}function F(e){return M.apply(this,arguments)}function M(){return(M=m((function*(e){var t=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchEnvironmentVariableDefinitions);try{var r=(yield e.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}}})).data;return t.complete(),Promise.resolve(r)}catch(o){return t.failure({error:o}),Promise.reject(o)}}))).apply(this,arguments)}function E(e,t){return $.apply(this,arguments)}function $(){return($=m((function*(e,t){var r=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.fetchParameterComponentsFromDataverse);try{for(var o=yield e.fetchList("PowerBIMashupParameter",void 0,{filter:"(_datasetid_value eq '".concat(t,"')")}),n=o.data;o.hasNext;)yield o.next(),n=n.concat(o.data);return r.complete(o),Promise.resolve(n)}catch(p){return r.failure({error:p}),Promise.reject(p)}}))).apply(this,arguments)}function x(e,t,r){return z.apply(this,arguments)}function z(){return(z=m((function*(e,t,r){var o=Object(a.trackLoadScenario)(i.PowerAppsPowerBIScope,i.TelemetryScenarioNames.detectAndApplyPowerBICustomizations);try{var n=yield e.executeOperation("pbi_DetectAndApplyCustomizations","POST",{"Content-Type":"application/json"},{pbi_ReportIds:JSON.stringify(t),pbi_DatasetIds:JSON.stringify(r)});o.progress({CurrentStep:"Customizations results retrieved for component instances"});var p={reports:[],datasets:[]};return null!=n&&n.pbi_DetectCustomizationsResult&&(p=JSON.parse(n.pbi_DetectCustomizationsResult)),o.complete({reportCustomizationsDetectionResult:p.reports,datasetCustomizationsDetectionResult:p.datasets}),Promise.resolve(p)}catch(c){return o.failure({error:c}),Promise.reject(c)}}))).apply(this,arguments)}},5821:function(e,t,r){"use strict";r.r(t),r.d(t,"PowerAppsPowerBIScope",(function(){return n})),r.d(t,"TelemetryScenarioNames",(function(){return o}));var o,n="powerapps-powerbi";!function(e){e.fetchEnvironmentVariableDefinitions="FetchEnvironmentVariableDefinitions",e.fetchPowerBIWorkspaces="FetchPowerBIWorkspaces",e.fetchPowerBIReports="FetchPowerBIReports",e.fetchPowerBIDatasets="FetchPowerBIDatasets",e.fetchPowerBIMashupParametersForDataset="FetchPowerBIMashupParametersForDataset",e.fetchPowerBIReportEmbeddingDetails="FetchPowerBIReportEmbeddingDetails",e.fetchPowerBIDatasetDetails="FetchPowerBIDatasetDetails",e.fetchPowerBIReportComponent="FetchPowerBIReportComponent",e.fetchPowerBIDatasetComponent="FetchPowerBIDatasetComponent",e.fetchPowerBIMashupParameterComponent="FetchPowerBIMashupParameterComponent",e.createPowerBIReportComponent="CreatePowerBIReportComponent",e.createPowerBIDatasetComponent="CreatePowerBIDatasetComponent",e.editPowerBIReportComponent="EditPowerBIReportComponent",e.editPowerBIDatasetComponent="EditPowerBIDatasetComponent",e.editPowerBIMashupParameterComponent="EditPowerBIMashupParameterComponent",e.addPowerBIMashupParameterComponent="AddPowerBIMashupParameterComponent",e.fetchParameterComponentsFromDataverse="FetchParameterComponentsFromDataverse",e.applyAllParametersForDatasetInPowerBI="ApplyAllParametersForDatasetInPowerBI",e.detectAndApplyPowerBICustomizations="DetectAndApplyPowerBICustomizations"}(o||(o={}))},6503:function(e,t,r){"use strict";r.r(t),r.d(t,"solutionLayersSummaryQuery",(function(){return u})),r.d(t,"solutionLayersQuery",(function(){return m})),r.d(t,"solutionLayersRemoveMutation",(function(){return l})),r.d(t,"solutionComponentLayersDifferences",(function(){return d}));var o,n,a,i,p=r(3128),c=r.n(p);function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var u=c()(o||(o=s(["\n  query SolutionComponentLayersSummary($input: SolutionComponentLayersSummaryInput!) {\n    solutionComponentLayersSummary(input: $input) {\n      required {\n        name\n        count\n      }\n      dependent {\n        name\n        count\n      }\n    }\n  }\n"]))),m=c()(n||(n=s(["\n  query SolutionComponentLayers($solutionComponentId: String!, $solutionComponentTypeName: String!) {\n    solutionComponentLayers(\n      solutionComponentId: $solutionComponentId\n      solutionComponentTypeName: $solutionComponentTypeName\n    ) {\n      solutionComponentId\n      solutionComponentLayerId\n      layerOrder\n      solutionName\n      publisherName\n      changes\n      componentJson\n      name\n    }\n  }\n"]))),l=c()(a||(a=s(["\n  mutation removeActiveCustomization($solutionComponentTypeName: String!, $solutionComponentId: String!) {\n    removeActiveCustomization(\n      solutionComponentTypeName: $solutionComponentTypeName\n      solutionComponentId: $solutionComponentId\n    )\n  }\n"]))),d=c()(i||(i=s(["\n  query solutionComponentLayersDifferences(\n    $solutionComponentId: String!\n    $solutionComponentTypeName: String!\n    $selectedLayerIndex: Float\n  ) {\n    solutionComponentLayersDifferences(\n      solutionComponentId: $solutionComponentId\n      solutionComponentTypeName: $solutionComponentTypeName\n      selectedLayerIndex: $selectedLayerIndex\n    ) {\n      isOneLayer\n      previous {\n        xml\n        layerSolutionName\n      }\n      selected {\n        xml\n        layerSolutionName\n      }\n    }\n  }\n"])))},6859:function(e,t,r){"use strict";r.r(t),r.d(t,"DeleteCanvasAppQuery",(function(){return c})),r.d(t,"RenameAppQuery",(function(){return s}));var o,n,a=r(3128),i=r.n(a);function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c=i()(o||(o=p(["\n  mutation DeleteCanvasApp($appName: String!, $isAdminScope: Boolean) {\n    deleteCanvasAppById(appName: $appName, isAdminScope: $isAdminScope) {\n      appName\n    }\n  }\n"]))),s=i()(n||(n=p(["\n  mutation renameApp($appId: String!, $displayName: String) {\n    renameApp(appId: $appId, displayName: $displayName)\n  }\n"])))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/139.0d516ddc.chunk.js.map