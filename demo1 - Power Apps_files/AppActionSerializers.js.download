(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/AppActionSerializers.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[66],{"GAI+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Button",i="FlyoutAnchor",r="SplitButton"},"MY+P":function(e,t,n){"use strict";n.r(t),n.d(t,"createAppActionToRibbon",(function(){return m})),n.d(t,"serializeAppActionDescriptor",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o=["Form","HomePageGrid","SubGridStandard","SubGridAssociated","QuickForm","Global","Dashboard"];var i=n("GAI+"),r=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={ChevronDown:"Expanded",ChevronUp:"UpArrowHead",ChevronLeft:"LeftArrowHead",ChevronRight:"Collapsed",Edit:"Edit",Save:"Save",Delete:"Delete",ListSelect:"Resolve",CirclePlus:"Add",Cancel:"Cancel",TouchPointer:"HandClick",Accept:"Accept",More:"More",FavoriteStarFill:"Favorite",FavoriteStarFillGrey:"Favorite",Puzzle:"Placeholder",FavoriteStar:"RatingEmpty",Priority:"Options",Manage:"Manage",Settings:"Settings",Help:"Help",Flag:"ViewNotifications",Lock:"Lock",CheckList:"MoreOptions",ContactInfo:"ContactInfo",Pin:"Pin",Pinned:"Pinned",Unpin:"Unpin",Refresh:"Refresh",GlobalNavButton:"Details",EntryView:"CreatePersonalView",SaveAs:"SaveFilterToNewPersonalView",Diamond2:"Diamond",CalendarDay:"StreamView",ViewAll:"TileView",Feedback:"Tools",Attach:"Attach",Filter:"Filter",Copy:"Copy",Important:"HighPriority",ExpandTile:"ReduceTile",ReduceTile:"ExpandTile",CaretSolid16:"GlobalFilterExpand",Clear:"Delete",Comment:"Post",OneNoteDocType:"OneNote",Home:"Home",HomeVerify:"SetAsHome",Back:"BackButton",Forward:"Forward",BackToStart:"FirstPageButton",Up:"UpArrow",Down:"DownArrow",Search:"SearchButton",PageRight:"ForwardButton",Mail:"Mail",MailCheck:"CheckedMail",MailError:"FailedMail",Phone:"Phone",PageLines:"Letter",Fax:"Fax",OpenPane:"OpenPane",ClosePane:"ClosePane",Link:"LinkArticle",RemoveLink:"UnlinkArticle",MailLink:"EmailLink",Share:"Share",PlayerSignIn:"Assign",ConnectContacts:"Connect",Folder:"Opportunity",Calendar:"Appointment",Repair:"Case",IncomingCall:"PhoneCallIncoming",OutgoingCall:"PhoneCallOutgoing",LetterIncoming:"LetterIncoming",LetterOutgoing:"LetterOutgoing",FaxIncoming:"FaxIncoming",FaxOutgoing:"FaxOutgoing",IncomingMail:"EmailIncoming",OutgoingMail:"EmailOutgoing",Send:"SendEmail",Preview:"ApplyTemplate",TextDocument:"InsertKbArticle",SalesLiterature:"SalesLiterature",PageArrowRight:"SendSelected",SaveAndClose:"SaveAndClose",Reply:"Reply",ReplyAll:"ReplyAllEmail",PageCompleted:"Activate",PageBlock:"DeActivate",PageRemove:"DeleteBulk",TwitterLogo:"SocialActivityIncoming",Dynamics365Logo:"Dynamics365",CustomActivity:"CustomActivity",CustomEntity:"CustomEntity",ActivityFeedConfiguration:"SystemPost",ConvertTo:"Convert",Ribbon:"MarkAsWon",Blocked:"MarkAsLost",PageArrowLeft:"SetRegarding",TaskSequence:"Process",Shuffle:"SwitchProcess",ErrorBadge:"Abandon",CheckMark:"FinishStage",Calculator:"Recalculate",BullseyeTargetDelete:"CloseGoal",AlignFiscalYear:"AlignWithFiscalPeriod",AutoEnhanceOn:"SendDirectEmail",OpenMailbox:"OpenMailbox",MoveToFolder:"ReOpenOpportunity",CallDisqualify:"Disqualify",CallQualify:"Qualify",ButtonView:"SelectView",SentimentScore:"SelectChart",World:"OpenInBrowser",RecurringEvent:"NewRecurringAppointment",EditMail:"NewEmail",AddExistingActivity:"AddExisting",Certificate:"Default",RoutingRule:"SaveAndRunRoutingRule",AddToQueue:"AddToQueue",CreateChildCase:"CreateChildCase",MergeCase:"MergeRecords",OrgBranch:"AssociateChildCase",AppIconDefaultCheckmark:"SetAsDefault",KnowledgeArticle:"ConvertKnowledgeArticle",PageSubtract:"QueueItemRemove",OpenEnrollment:"QueueItemPick",QueueItem:"QueueItemDetail",Org:"Drilldown",PopOut:"PopOverButton",ImportToExcel:"ExportToExcel",WordLogoInverse:"WordTemplates",ExcelLogoInverse:"DocumentTemplates",PowerBILogo:"OpenInPowerBI",BarChart4:"OpenPowerBIReport",DelveLogoInverse:"OpenDelve",Archive:"ArchiveArticle",CreateMinor:"Minor",CreateMajor:"Major",KnowledgeArticlePublish:"PublishKnowledgeArticle",RelatedKnowledgeArticle:"RelateArticle",DOM:"RelateProduct",Undo:"RestoreArticle",RevertToDraft:"RevertToDraftArticle",TranslationNew:"Translate",UpdateRestore:"UpdateArticle",CompanyDirectory:"Article",Telemarketer:"CSR",Contact:"MembersIcon",Queues:"QueueIcon",BackToWindow:"NormalPriority",RelationshipView:"ViewIcon",CRMLead:"RecentCases",DocumentSet:"KBRecords",View:"NumberOfViews",GripperBarVertical:"ResizeHandle",TBX:"TaskBasedFlow",Error:"ErrorIcon",Completed:"SuccessIcon",Info:"NotificationIcon",Upload:"SidePanelUpload",Add:"New",PageAdd:"CreateQuote",BusinessRule:"SettingsListIcon",PDF:"PdfIconFile",PowerPointLogoInverse:"PresentationFile",OneNoteLogoInverse:"OneNoteFile",AccessLogo:"AccessFile",VisioLogoInverse:"VisioFile",ProjectLogoInverse:"ProjectFile",Sad:"SadSmiley",Emoji2:"HappySmiley",ResolveCase:"CaseResolution",CampaignResponse:"CampaignResolution",ServiceActivity:"ServiceActivity",NotesEdit:"Notes",Microphone:"Audio",Camera:"Camera",Video:"Video",PageEdit:"SharePointEditDocument",PageCheckedOut:"SharePointCheckoutDocument",DocumentManagement:"SharePointEditDocumentProperties",Photo2:"Image",OnlineCampaign:"Html",LinkDocuments:"AssociatedArticle",CRMArticles:"DisassociatedArticle",PreviewLink:"FormDesign",SystemJobs:"AutomaticSuggestions",ThumbnailView:"SemanticZoom",ThumbnailViewMirrored:"SemanticZoomMirrored",PageLeft:"BackwardButton",Warning:"Warning",MultiSelect:"MultiSelect",MultiSelectMirrored:"MultiSelectMirrored",ClearFilter:"GlobalFilterClearAll",CaretSolidDown:"GlobalFilterExpandedRow",CaretSolidRight:"GlobalFilterCollapsedRow",Wifi:"OfflineStatus",Play:"Play",Lightbulb:"RelationshipAssistant",RemoveOrder:"RetireProduct",CreateOrder:"AddProduct",CircleRing:"Spinning",Sort:"SortButton",Flow:"Flows",Subscriptions:"OpenEntityRecord",GuestUser:"GuestUser",History:"History",EditContact:"ManageRoles",Combine:"JoinTeams",SwitchUser:"ChangeManager",PeopleAdd:"AddMembers",BlockContact:"RemoveMembers",Download:"Download",Table:"SetAsDefaultView",ChatBubbles:"Messenger",TripleColumn:"TripleColumn",Tiles:"Tiles",HideVisualFilter:"HideVisualFilter",InteractiveDashboard:"InteractiveDashboard",AddOrders:"CreateInvoice",FulfillOrder:"FullfillOrder",ActivateOrders:"ActivateQuote",Product:"GetProducts",Unlock:"UnlockPricing",Checkbox:"Checkbox",CheckboxComposite:"CheckboxComposite",ChevronRightMed:"RightChevron",ChevronLeftMed:"LeftChevron",CaretSolidLeft:"GlobalFilterCollapsedRowRTL",DeactivateOrders:"CancelOrder",MailAlert:"UntrackedEmail",Read:"OpenEmail",Group:"DistributionList",Globe:"URL",Financial:"Ticker",Silver:"UseCurrentPricing",AccountActivity:"QuoteCreateInvoice",RemoveQuotes:"CloseQuote",LinkedInLogo:"LinkedInLogo",Medical:"Health",Family:"Family",MoreSports:"Sports",Media:"Entertainment",OutOfOffice:"OOF",SwitchToCarousel:"CarouselView",Heart:"HeartEmpty",HeartFill:"HeartFilled",Redo:"Follow",ChatBot:"Bot",PinnedSolid:"PinnedSolid",FilterSolid:"FilterSolid",Configuration:"SystemDocumentTemplates",PageShared:"MyDocumentTemplates",SecurityGroup:"EnableSecurityRoles",EditMirrored:"DocumentTemplateEdit",YammerLogo:"YammerIcon",Stop:"StopIcon",PageRecurring:"ReplaceContentIcon",Timer:"CloseDateComingSoon",SearchNearby:"NearbyCustomers",News:"RelevantNews",CalendarAgenda:"UpcomingMeeting",DateTime:"RecentMeeting",Ringer:"ReminderWithCall",Trackers:"CardsTask",Quotes:"CardsQuote",Opportunities:"CardsOpportunity",CRMInvoices:"CardsInvoice",SummaryChart:"CardsDashboard",CallLeads:"CardsLeads",OpportunityNoActivity:"OpportunityNoActivity",CaseNoActivity:"CaseNoActivity",AcrossTheMarket:"CompetitorMentioned",MeetingPlanner:"MeetingRequest",EventDateMissed:"MissedCloseDate",CaseDetection:"IssueDetection",HourGlass:"NoActivityWithAccount",LikeDislike:"YesNo",ServiceCalendar:"AgendaActivityServiceAppointment",Airplane:"UpcomingFlight",OpportunityAtRisk:"OpportunityAtRiskSentiment",EventDueToday:"IconDue",ProductCatalog:"AddProductFamily",ProductVariant:"AddProductBundle",Publish:"ProductPublish",DoubleColumn:"CloneProduct",FollowUser:"ConnectionToOther",ProductUpsell:"ProductUpsell",SubscriptionAdd:"SubscriptionAdd",RefreshDevice:"RefreshDevice",BulletListRemove:"BulletListRemove",BulletListAdd:"BulletListAdd",BulletListDownArrow:"BulletListDownArrow",People:"People",CreateQuickCampaign:"CreateQuickCampaign",PageSolid:"PageSolid",Page:"Page",OpportunitiesList:"OpportunitiesList",BrowseCards:"BrowseCards",ScatterChart:"ScatterChart",BarChartHorizontal:"BarChartHorizontal",BarChartVertical:"BarChartVertical",FunnelChart:"FunnelChart",PieDouble:"PieDouble",SendAndClose:"SendClose",DoubleChevronLeftMed:"DoubleChevronLeft",DoubleChevronLeftMedMirrored:"DoubleChevronRight",LineChart:"AreaChart",DonutChart:"DonutChart",TagChart:"TagCloud",SetAction:"Teaser",LineChartMirrored:"AreaChartMirrored",BarChartHorizontalMirrored:"BarChartHorizontalMirrored",BarChartVerticalMirrored:"BarChartVerticalMirrored",Recent:"Recent",SharepointLogoInverse:"SharePointIcon",OneDriveLogo:"OneDriveIcon",FolderShared:"FolderSharedIcon",TeamsLogoInverse16:"MSTeamsIcon",ScrollUpDown:"AreaSwitcher",CRMReport:"Report",ProductList:"ProductPreview",AddFriend:"AddTerritoryMember",UserRemove:"RemoveTerritoryMember",FilterSettings:"EditDefaultFilter",SyncOccurence:"Recurrence",SyncOccurenceEdit:"EditSeries",SyncOccurenceCancel:"EndSeries",TableLink:"TableLink",TableGroup:"TableGroup",Like:"ThumbsUp",Dislike:"ThumbsDown",ChromeMinimize:"ChromeMinimize",ChromeMaximize:"ChromeMaximize",FullScreen:"Expand",Sync:"Sync",LikeSolid:"ThumbsUpSolid",DislikeSolid:"ThumbsDownSolid",SearchAndApps:"CommandChecker",MiniContract:"MiniContract",MiniExpand:"MiniExpand",Print:"Print",Database:"NoDataAvailable",MoreVertical:"MoreVertical",OpenInNewWindow:"OpenInNewWindow",EditEvent:"EditEvent",LinkToCase:"LinkToRecord",LinkToCaseRemove:"UnlinkFromRecord",ReadingMode:"KnowledgeSearch",ChevronDownMed:"ChevronDownMed",OpenFolderHorizontal:"OpenFolderHorizontal",Task:"TaskClipboard",ExpandAll:"ExpandAllRecords",CollapseAll:"CollapseAllRecords",SelectAll:"SelectAll",Embed:"Embed",MailTemplate:"MailTemplate",Diagnostic:"Monitor",Hide2:"HideInSimpleMode",EventAccepted:"EventAccepted",ClosePaneMirrored:"ClosePaneMirrored",RollupQuery:"RollupQuery",FontColor:"FontColor",AlignJustify:"AlignJustify",NumberedList:"NumberedList",Omega:"Omega",LineSpacing:"LineSpacing",Spelling:"Spelling",Strikethrough:"Strikethrough",Code:"Code",IncreaseIndent:"IncreaseIndent",DecreaseIndent:"DecreaseIndent",Subscript:"Subscript",Superscript:"Superscript",AllinOnePC:"AllInOnePC",ButtonControl:"ButtonControl",LineFocus1:"LineFocus1",CodeEdit:"CodeEdit",QRCode:"QRCode",CloudUpload:"CloudUpload",TextAlignLeft:"AlignLeft",TextAlignCenter:"AlignCenter",TextAlignRight:"AlignRight",TextAlignJustify:"AlignJustify",BulletedList:"BulletedList2",Anchor:"Anchor",ClearNight:"ClearNight",SearchCampaigns:"SearchCampaigns",FileCode:"FileCode",DockBottom:"DockBottom",DockLeft:"DockLeft",DockRight:"DockRight",Brightness:"Brightness",AlignHorizontalLeft:"AlignHorizontalLeft",AlignHorizontalCenter:"AlignHorizontalCenter",AlignHorizontalRight:"AlignHorizontalRight",AlignVerticalTop:"AlignVerticalTop",AlignVerticalCenter:"AlignVerticalCenter",AlignVerticalBottom:"AlignVerticalBottom"};var l=n("TBkx"),c=n("Lyxw"),s=n("3/02"),u=n("eD3A");function d(e,t,n,i,r,a){if(e&&Array.isArray(e)&&e.length)try{const l=Object(u.s)(r),d=Object(u.t)(r);for(let u=0;u<e.length;u++)for(const m of e[u]){if(1===m.OnClickEventType&&!l){null==a||a.info(`FCB=EnableAppActionFXFeature is disable, skip AppAction: Name ${m.Name}, UniqueName ${m.UniqueName}`);continue}if(2===m.OnClickEventType&&!d){null==a||a.info(`FCB=EnableAppActionFeature is disable, skip AppAction: Name ${m.Name}, UniqueName ${m.UniqueName}`);continue}if(!T(m.VisibilityFormulaComponentLibrary)&&!l){null==a||a.info(`FCB=EnableAppActionFXFeature is disable, skip AppAction: Name ${m.Name}, UniqueName ${m.UniqueName}`);continue}const e=Object(c.f)(r,s.Mb)?[0,1,2]:[0];if(m.ButtonType in e&&(1===m.Context||0===m.Context&&Object(c.f)(r,s.h))){const e=1===m.Context?m.ContextValue:i,l=n[o[m.Location]+":"+e];if(l){if(!p(m,t,e,l,r,a)){const e=[{name:"UniqueName",value:m.UniqueName},{name:"Button Sequence Priority",value:m.ButtonSequencePriority},{name:"Location",value:o[m.Location]},{name:"Context Value",value:m.ContextValue}];a&&a.error("serializeAppActionDescriptor:Incorrect group index",e);continue}}else{const e=[{name:"UniqueName",value:m.UniqueName},{name:"Context",value:m.Context},{name:"Location",value:o[m.Location]},{name:"Context Value",value:m.ContextValue}];a&&a.error("serializeAppActionDescriptor:Invalid AppActions doesn't match with Ribbons",e)}}}}catch(e){const t=[{name:"Error",value:Object(l.f)(e)}];a&&a.error("serializeAppActionDescriptor:Serializer Failed",t)}}const p=(e,t,n,i,r,a)=>function(e,t,n,i,r,a){var l;const{relationStatus:c}=function(e,t,n,i){var r;let a=[];t.Layout.Tabs.Tab&&(a=a.concat(t.Layout.Tabs.Tab));t.Layout.ContextualTabs.Tab&&(a=a.concat(t.Layout.ContextualTabs.Tab));for(const t of a)if(null===(r=null==t?void 0:t.Groups)||void 0===r?void 0:r.Group)for(const r of t.Groups.Group)for(let t=0;t<r.Controls.Items.length;t++){const a=r.Controls.Items[t].Command.split("|");if(4===a.length){if(a[0]===n&&a[2]===o[e.Location]&&a[3]===e.Name){r.Controls.Items.splice(t,1);const n=[{name:"AppAction UniqueName",value:e.UniqueName},{name:"AppAction Location",value:o[e.Location]},{name:"AppAction Context Value",value:e.ContextValue},{name:"Old Ribbon",value:r.Controls.Items[t].Command}];return i&&i.info("removeRibbonControlIfExist:Remove existing Ribbon ",n),{relationStatus:a[1]}}}else{const e=[{name:"Old Ribbon Command",value:r.Controls.Items[t].Command}];i&&i.warn("Command doesn't exist in the expected format ",e)}}return{relationStatus:"NoRelationship"}}(e,i,n,a);if(e.Hidden)return!0;const s=parseInt(e.ButtonSequencePriority,10),u=(s-s%1e6)/1e6,d=h(e);let p=[];i.Layout.Tabs.Tab&&(p=p.concat(i.Layout.Tabs.Tab));i.Layout.ContextualTabs.Tab&&(p=p.concat(i.Layout.ContextualTabs.Tab));let C=0;for(const s of p)if(null===(l=null==s?void 0:s.Groups)||void 0===l?void 0:l.Group)for(const l of s.Groups.Group){if(C!==u){C++;continue}let s=0;for(;s<l.Controls.Items.length&&!T(l.Controls.Items[s].Sequence)&&parseInt(l.Controls.Items[s].Sequence,10)<=d;)s++;const p=I(n,c,o[e.Location],e.Name),A=m(e,t,n,l.Id,c,i,r,a);s<l.Controls.Items.length?l.Controls.Items.splice(s,0,A):l.Controls.Items.push(A);const g=[{name:"AppAction UniqueName",value:e.UniqueName},{name:"New Command",value:p},{name:"Sequence",value:d},{name:"Group Id",value:l.Id}];return a&&a.info("convertAppActionControl:Add new AppAction Control",g),!0}return!1}(e,(null==t?void 0:t.length)>0?t[0]:null,n,i,r,a);const m=(e,t,n,o,i,r,a,l)=>{if(e&&!0===e.Hidden)return null;const c=v(e,n,o,i,l);switch(e.ButtonType){case 1:return C(e,t,c,n,o,i,r,a,l);case 2:return A(e,t,c,n,o,i,r,a,l);case 0:return g(e,t,c,n,r,a,l);default:return l&&l.error(`createAppActionToRibbon: appAction.AppActionId: ${e.AppActionId} appAction.Name${e.Name} contextValue ${n}`),null}},C=(e,t,n,o,r,a,l,c,s)=>{const u=b(e,l,o,r,a,n.Id,t,c,s),d=Object.assign({ControlType:i.b,Menu:u},n);return S(e,t,l,o,c,s),d},A=(e,t,n,o,r,a,l,c,s)=>{const u=b(e,l,o,r,a,n.Id,t,c,s),d=Object.assign({ControlType:i.c,Menu:u},n);return S(e,t,l,o,c,s),d},g=(e,t,n,o,r,a,l)=>{const c=Object.assign({ControlType:i.a},n);return S(e,t,r,o,a,l),c},h=e=>parseInt(e.ButtonSequencePriority,10)%1e6,v=(e,t,n,i,r)=>{const l=I(t,i,o[e.Location],e.Name),c=h(e),s=((e,t,n,o,i)=>{let r=e.FontIcon;if(r&&r.toLowerCase().startsWith("$clientsvg:")&&(r=a[r.substr("$clientsvg:".length)]),!T(e.IconWebresourceId))if(T(e.IconWebresourceName)){if(o){const r=[{name:"AppAction UniqueName",value:e.UniqueName},{name:"New Command",value:i},{name:"Sequence",value:t},{name:"Group Id",value:n},{name:"Icon WebResourceId",value:e.IconWebresourceId}];o.info("convertAppActionControl:Unable to find WebResource",r)}}else r="$webresource:"+e.IconWebresourceName;return r||" "})(e,c,n,r,l);return{Alt:e.ButtonAccessibilityText,Command:l,Id:l,LabelText:e.ButtonLabelText,ModernImage:s,Sequence:""+c,ToolTipTitle:e.ButtonTooltipTitle,ToolTipDescription:e.ButtonTooltipDesc}},b=(e,t,n,i,r,a,l,c,s)=>{const u={MenuSection:[],Id:a+".Menu",Status:2,MaxWidth:""};if(e)for(let a=0;e.Children&&e.Children[a];a++){const d=e.Children[a];if(d&&!0===d.Hidden)continue;let p="";if(3===d.ButtonType){const e=h(d);p=I(n,r,o[d.Location],d.Name);const a={Items:[],Id:p+".Controls"};if(d)for(let e=0;d.Children&&d.Children[e];e++){const o=d.Children[e];if(o.ButtonType in[0,1]){const e=m(o,l,n,i,r,t,c,s);e&&a.Items.push(e)}else s&&s.error(`createMenu: child.AppActionId: ${o.AppActionId} child.Name${o.Name} child.ButtonType${o.ButtonType} group.AppActionId ${d.AppActionId} group.Name ${d.Name}`)}u.MenuSection.push({Item:a,Id:""+p,Title:d.isGroupTitleHidden?"":d.GroupTitle,Scrollable:!1,Sequence:""+e,DisplayMode:6})}else s&&s.error(`createMenu: group.AppActionId ${d.AppActionId} group.Name ${d.Name} group.ButtonType ${d.ButtonType} appAction.AppActionId ${e.AppActionId} appAction.Name ${e.Name}`)}return u};function S(e,t,n,i,a,l){const u=[],d=[];T(e.VisibilityFormulaFunctionName)?Object(c.f)(a,s.Jb)&&2===e.VisibilityType&&(t?function(e,t,n,o,i,r,a){for(const i of e.EnableRules)f(o,n.EnableRules,i,r,t.EnableRules,e.UniqueName,a);for(const r of e.DisplayRules)f(o,n.DisplayRules,r,i,t.DisplayRules,e.UniqueName,a)}(e,t,n,i,d,u,l):null==l||l.error(`Missing ClassicRules payload for AppAction:  Context Value ${i} uniqueName ${e.UniqueName} Location ${o[e.Location]}`)):(!function(e,t,n){const o={RuleType:48,DefaultValue:!0,InvertResult:!1,FunctionName:e.VisibilityFormulaFunctionName,ComponentName:e.VisibilityFormulaComponentName,Library:e.VisibilityFormulaComponentLibrary},i=e.UniqueName,a={Rules:[o],Id:i};t.EnableRules[n]?t.EnableRules[n][i]=a:t.EnableRules[r.c][i]=a}(e,n,i),u.push(e.UniqueName));let p="";if(!T(e.OnClickEventJavaScriptWebResourceId))if(T(e.OnClickEventJavaScriptWebResourceName)){const t=[{name:"RibbonCommandDefinition Id",value:e.UniqueName},{name:"Ribbon JavaScript WebResourceId",value:e.OnClickEventJavaScriptWebResourceId}];l&&l.info("convertAppActionCommand:Unable to find WebResource",t)}else p="$webresource:"+e.OnClickEventJavaScriptWebResourceName;const m={Id:e.UniqueName,isFirstLevel:!0,EnableRules:u,DisplayRules:d,Actions:(()=>{switch(e.OnClickEventType){case 2:return[R(e,p)];case 1:return[y(e)];case 0:default:return[]}})(),IsAppAction:!0};n.Commands[i]?n.Commands[i][e.Name]=m:n.Commands[r.c][e.Name]=m;const C=[{name:"RibbonCommandDefinition Id",value:e.UniqueName},{name:"AppAction Context Value",value:e.ContextValue},{name:"Ribbon EnableRule DefinitionId",value:u.length>0?u[0]:""}];l&&l.info("convertAppActionCommand:Add new AppAction Command definition",C)}function f(e,t,n,o,i,a,l){if(!i)return void(null==l||l.error(`Missing classic rules for AppAction:  Unique Name ${a} Context Value ${e} RuleName ${n}`));const{entityName:c,definition:s}=function(e,t){for(const n in t)if(t[n][e])return{entityName:n,definition:t[n][e]};return{entityName:null,definition:null}}(n,i);if(c&&s)if("null"===c||e===c){if(t[c]&&!t[c][n])try{const o=JSON.parse(s);t[e]?t[e][n]=o:t[r.c][n]=o}catch(t){return void(null==l||l.error(`Failed RuleDefinition Serialization for AppAction: Unique Name ${a} Context Value ${e} RuleName ${n} Definition ${s}, Exception ${t}`))}o.push(n)}else null==l||l.error(`Incorrect rule context value for AppAction: Unique Name ${a} Context Value ${e} RuleName ${n} RuleContext ${c} Definition ${s}`);else null==l||l.error(`Missing ClassicRule description/EntityName for AppAction: Unique Name ${a} Context Value ${e} RuleName ${n} RuleContext ${c} Definition ${s}`)}function R(e,t){var n;const o={FunctionName:e.OnClickEventJavaScriptFunctionName,Library:t},i=new Array;if(e.OnClickEventJavaScriptParameters){const t=JSON.parse(e.OnClickEventJavaScriptParameters);for(const e of t){const t={ParameterType:e.type,Value:null!==(n=e.value)&&void 0!==n?n:null,Name:P(e.type),ParameterName:null};i.push(t)}}return{ActionType:3,Attributes:o,Parameters:i}}function y(e){return{ActionType:5,Attributes:{FunctionName:e.OnClickEventFormulaFunctionName,ComponentName:e.OnClickEventFormulaComponentName,Library:e.OnClickEventFormulaComponentLibrary},Parameters:new Array}}function I(e,t,n,o){return[e,t,n,o].join("|")}function T(e){return"string"!=typeof e||!e||0===e.length}function P(e){switch(e){case 18:return"BoolParameter";case 19:return"DecimalParameter";case 20:return"IntParameter";case 21:return"StringParameter";case 0:return null;default:return"CrmParameter"}}}}]),window.bundleExecutionMarkers["scripts/AppActionSerializers.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();