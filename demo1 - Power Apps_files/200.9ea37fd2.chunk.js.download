/*! For license information please see 200.9ea37fd2.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[200],{6374:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"IAppOrFlowType",(function(){return o})),t.d(n,"RefreshConnections",(function(){return i})),t.d(n,"RefreshConnectionsActionNames",(function(){return r})),function(e){e[e.App=0]="App",e[e.Flow=1]="Flow"}(o||(o={}));var i="refreshConnections",r={DismissDialog:"dismissDialog",OpenDialog:"openDialog",ExecuteFromDialog:"executeFromDialog",Execute:"execute"}},6398:function(e,n,t){"use strict";t.r(n),t.d(n,"isDataSourceEnvironmentVariableDefinition",(function(){return c})),t.d(n,"isDataSourceChildEnvironmentVariableDefinition",(function(){return a})),t.d(n,"isSecretEnvironmentVariableDefinition",(function(){return s})),t.d(n,"IEnvironmentVariableConnectors",(function(){return o})),t.d(n,"isSharePointApiId",(function(){return l})),t.d(n,"isSQLApiId",(function(){return u})),t.d(n,"isCDSApiId",(function(){return f})),t.d(n,"IEnvironmentVariableSecretStores",(function(){return i}));var o,i,r=t(2830);function c(e){return e&&e.type===r.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&!!e.apiid}function a(e){return c(e)&&!!e._parentdefinitionid_value}function s(e){return e&&e.type===r.EnvironmentVariableDefinitionTypeEnum.Secret}function l(e){return!!e&&e.toLocaleLowerCase()===o.SharePoint}function u(e){return!!e&&e.toLocaleLowerCase()===o.SQL}function f(e){return!!e&&e.toLocaleLowerCase()===o.CDS}!function(e){e.SharePoint="/providers/microsoft.powerapps/apis/shared_sharepointonline",e.SQL="/providers/microsoft.powerapps/apis/shared_sql",e.CDS="/providers/microsoft.powerapps/apis/shared_commondataservice"}(o||(o={})),function(e){e[e.KeyVault=0]="KeyVault"}(i||(i={}))},6400:function(e,n,t){"use strict";t.r(n),t.d(n,"isSharePointEnvironmentVariableDefinition",(function(){return i})),t.d(n,"isSharePointSiteEnvironmentVariableDefinition",(function(){return r})),t.d(n,"isSharePointListEnvironmentVariableDefinition",(function(){return c})),t.d(n,"hasSharePointApiId",(function(){return a}));var o=t(6398);function i(e){return Object(o.isDataSourceEnvironmentVariableDefinition)(e)&&a(e)}function r(e){return i(e)&&"dataset"===e.parameterkey}function c(e){return i(e)&&"table"===e.parameterkey}function a(e){return Object(o.isSharePointApiId)(e.apiid)}},6402:function(e,n,t){"use strict";t.r(n),t.d(n,"isSQLEnvironmentVariableDefinition",(function(){return i})),t.d(n,"isSQLServerEnvironmentVariableDefinition",(function(){return r})),t.d(n,"isSQLDatabaseEnvironmentVariableDefinition",(function(){return c})),t.d(n,"hasSQLApiId",(function(){return a}));var o=t(6398);function i(e){return Object(o.isDataSourceEnvironmentVariableDefinition)(e)&&a(e)}function r(e){return i(e)&&"dataset"===e.parameterkey}function c(e){return i(e)&&"table"===e.parameterkey}function a(e){return Object(o.isSQLApiId)(e.apiid)}},6411:function(e,n,t){"use strict";t.r(n),t.d(n,"getConnectionsOptions",(function(){return m})),t.d(n,"onRenderDropdownOptions",(function(){return C}));var o=t(2844),i=t(217),r=t(2903),c=t(687),a=t(1090),s=t(1452),l=t(245),u=t.n(l),f=t(6374),d=t(6412);function m(e,n,t){return[{key:"Header",text:n,itemType:s.SelectableOptionMenuItemType.Header},{key:"divider",text:"-",itemType:s.SelectableOptionMenuItemType.Divider},...p(e,t)]}function p(e,n){return(e||[]).filter(e=>!n||!e.apiId||e.apiId.toLowerCase()===n.toLowerCase()).map(e=>({key:e.name,text:e.displayName,data:{subtitleText:e.displayName,isAuthError:e.isAuthError,iconUrl:e.iconUri,connection:e}}))}function C(e,n,t,s,l,m,p,C){if(!e)return null;var g=Object(d.getMultiConnectionsPickerStyles)(),h=Object(d.getMultiConnectionsPickerClasses)(),v=e;if(v&&"Header"===v.key){var b=[];s&&b.push("make.restrictNav=true");var y=function(e){var n=(e||"").split("/");return n[n.length-1]||""}(l);y&&b.push("apiName=".concat(y));var S="/environments/".concat(t,"/connections/available").concat(b.length>0?"?".concat(b.join("&")):"");return u.a.createElement(a.Link,{className:h.connectionReferenceDropdownHeader,href:S,target:"_blank",onClick:()=>{Object(i.trackUserActionClickLink)(m,f.RefreshConnections,{action:f.RefreshConnectionsActionNames.OpenDialog}),p(!0)}},u.a.createElement(c.Icon,{iconName:o.fabricIcons.Add}),n(v))}return u.a.createElement("div",{className:h.connectionDropdown},u.a.createElement(c.ImageIcon,{imageProps:{src:v.data.iconUrl,styles:g.connectionReferenceIconStyles},className:"connectionIcon"}),u.a.createElement("div",{className:"labelsContainer"},u.a.createElement("span",{className:"primaryLabel"},v.text),u.a.createElement("span",{className:Object(r.css)(h.regularText,h.grayText,h.connectionReferenceSchemaName)},v.data.subtitleText)),v.data.isAuthError&&u.a.createElement("div",null,u.a.createElement(c.Icon,{iconName:"Error",title:C,style:{paddingLeft:"3px"}})))}},6412:function(e,n,t){"use strict";t.r(n),t.d(n,"getMultiConnectionsPickerClasses",(function(){return c})),t.d(n,"getMultiConnectionsPickerStyles",(function(){return a}));var o=t(3058),i=t(5932),r=t(719),c=()=>Object(r.mergeStyleSets)({regularText:{fontSize:12,fontFamily:i.fonts.segoeUi,lineHeight:16},boldText:{fontWeight:600},grayText:{color:o.fabricColors.lightGray},contentContainer:{paddingTop:"0 !important",marginTop:"16 !important",fontFamily:i.fonts.segoeUi,display:"grid"},subHeaderText:{fontSize:16,fontFamily:i.fonts.segoeUi,fontWeight:600,lineHeight:22},subHeaderContentsTextSmaller:{marginTop:4},connectionReferencesContainer:{borderTop:"1 solid ".concat(o.fabricColors.veryLightGrey),height:"100%",display:"flex",overflowY:"auto"},updatedNeededText:{marginTop:24,marginBottom:16},connectionReferenceContainer:{height:32,marginTop:16,display:"flex",selectors:{".innerContainer":{display:"flex",width:"50%",selectors:{".connectionIcon":{minWidth:32},".labelsContainer":{height:32,marginLeft:16,marginRight:16,flexDirection:"row",flexGrow:1,overflow:"hidden",selectors:{".topLabelContainer":{height:16,selectors:{".moreInfoIconContainer":{verticalAlign:"top",display:"inline-block",textAlign:"center",height:16,width:16,selectors:{button:{marginTop:5}}}}}}}}}}},connectionDropdown:{height:48,alignItems:"center",width:"100%",borderBottom:"1 solid ".concat(o.fabricColors.veryLightGrey),display:"flex",selectors:{".labelsContainer":{height:36,marginLeft:12,textOverflow:"ellipsis",width:"100%",whiteSpace:"nowrap",overflow:"hidden",selectors:{".primaryLabel":{fontFamily:i.fonts.segoeUi,fontSize:14,lineHeight:20}}},".connectionIcon":{overflow:"visible"}}},connectionReferenceCalloutContents:{display:"grid"},connectionReferenceCalloutContentsTitle:{marginBottom:8},connectionReferenceCalloutContentsItemContainer:{display:"flex",marginBottom:3,height:16},connectionReferenceCalloutContentsItem:{marginLeft:8.25},connectionReferenceSchemaName:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},connectionReferenceDropdownHeader:{selectors:{i:{marginRight:8},span:{verticalAlign:"top"}}}}),a=()=>{var e=Object(r.getTheme)();return{connectionReferenceLabelStyles:{root:{fontSize:12,fontFamily:i.fonts.segoeUi,lineHeight:16,fontWeight:600,paddingTop:0,paddingBottom:0,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",color:null==e?void 0:e.palette.neutralDark}},connectionReferenceDropdownStyles:{root:{width:"100%",height:32,display:"inline-block"},dropdownItem:{height:"100%",selectors:{"& .ms-Button-flexContainer":{overflow:"hidden"}},backgroundColor:null==e?void 0:e.palette.white},dropdownItemSelected:{height:"100%",backgroundColor:null==e?void 0:e.palette.neutralLighterAlt},title:{backgroundColor:null==e?void 0:e.palette.white,color:null==e?void 0:e.palette.neutralPrimaryAlt},dropdownItemHeader:{backgroundColor:null==e?void 0:e.palette.white},dropdownDivider:{backgroundColor:null==e?void 0:e.palette.neutralLighter}},connectionReferenceCalloutStyles:{root:{width:300,padding:8},beak:{marginLeft:5}},connectionReferenceMoreInfoIconButtonStyles:{root:{width:10.4,height:10.4}},connectionReferenceMoreInfoIconStyles:{root:{marginLeft:0,marginRight:0}},connectionReferenceIconStyles:{image:{width:32,height:32}},connectionReferenceRefreshButtonStyles:{root:{paddingLeft:0}},connectionReferenceRefreshButtonIconStyles:{root:{marginLeft:0}},appsAndFlowsCalloutIconStyles:{root:{height:14,marginTop:1,marginBottom:1}},confirmDialogRightButtonStyle:{root:{backgroundColor:null==e?void 0:e.palette.neutralLighter}}}}},6695:function(e,n,t){"use strict";t.r(n),t.d(n,"_MultiConnectionsPicker",(function(){return p})),t.d(n,"MultiConnectionsPicker",(function(){return C}));var o=t(2844),i=t(5917),r=t(923),c=t(217),a=t(2903),s=t(684),l=t(245),u=t(6412),f=t(6374),d=t(6696),m=t(6699),p=e=>{var{t:n,connectionReferences:t,onRefreshConnections:r,hideHeader:p}=e,[C,g]=l.useState(!1),h=Object(u.getMultiConnectionsPickerStyles)(),v=Object(u.getMultiConnectionsPickerClasses)();return l.createElement(l.Fragment,null,l.createElement(i.ConfirmDialog,{hidden:!C,shouldKeepButtonEnabledOnConfirm:!0,title:n("MultiConnectionsPicker.NewConnectionPrompt.title"),subText:n("MultiConnectionsPicker.NewConnectionPrompt.content"),confirmButtonText:n("Common.refreshButtonTitle"),cancelButtonText:n("Common.cancel"),onConfirm:()=>{Object(c.trackUserActionClickButton)(e.telemetryScope,f.RefreshConnections,{action:f.RefreshConnectionsActionNames.ExecuteFromDialog}),g(!1),r()},onCancel:()=>{Object(c.trackUserActionClickButton)(e.telemetryScope,f.RefreshConnections,{action:f.RefreshConnectionsActionNames.DismissDialog}),g(!1)},rightButtonStyle:h.confirmDialogRightButtonStyle}),l.createElement("div",{className:v.contentContainer},!m.featureGates.enableInlineConnectionCreation&&l.createElement(s.ActionButton,{onClick:()=>{Object(c.trackUserActionClickButton)(e.telemetryScope,f.RefreshConnections,{action:f.RefreshConnectionsActionNames.Execute}),r()},iconProps:{iconName:o.fabricIcons.Refresh,styles:h.connectionReferenceRefreshButtonIconStyles},ariaLabel:n("Common.refreshButtonTitle"),styles:h.connectionReferenceRefreshButtonStyles},n("Common.refreshButtonTitle")),!p&&l.createElement(l.Fragment,null,l.createElement("span",{className:v.subHeaderText},n("MultiConnectionsPicker.title")),l.createElement("span",{className:Object(a.css)(v.subHeaderContentsTextSmaller,v.regularText)},e.headerContent?e.headerContent:m.featureGates.enableInlineConnectionCreation?n("MultiConnectionsPicker.newContent"):n("MultiConnectionsPicker.content")),l.createElement("span",{className:Object(a.css)(v.updatedNeededText,v.regularText,v.boldText)},n("Common.updatesNeeded",{numberOfUpdates:(null==t?void 0:t.length)||0})))),l.createElement(d.ConnectionReferencesContainer,{t:e.t,tReady:e.tReady,connectionReferences:t,connections:e.connections,connectionTypes:e.connectionTypes,onChangeConnectionSelection:e.onChangeConnectionSelection,onCreateNewConnection:()=>{g(!0)},telemetryScope:e.telemetryScope,environmentName:e.environmentName,restrictNavigationForNewConnection:e.restrictNavigationForNewConnection,setErrorMessage:e.setErrorMessage,connectionReferencesFlowWidgetThemeName:e.connectionReferencesFlowWidgetThemeName,connectionReferencesFlowWidgetStyles:e.connectionReferencesFlowWidgetStyles,setIsLoadingConnectionReferencesFlowWidget:e.setIsLoadingConnectionReferencesFlowWidget}))},C=Object(r.translateService)("PowerAppsConnections")(p)},6696:function(e,n,t){"use strict";t.r(n),t.d(n,"ConnectionReferencesContainer",(function(){return l}));var o=t(245),i=t(6412),r=t(6697),c=t(3569),a=t(6699),s=t(6700),l=e=>{var n=Object(i.getMultiConnectionsPickerClasses)();return o.createElement("div",{className:n.connectionReferencesContainer},a.featureGates.enableInlineConnectionCreation&&e.connectionReferences&&o.createElement(c.ConnectionReferencesFlowWidget,{setErrorMessage:e.setErrorMessage,t:e.t,tReady:e.tReady,connectionReferences:e.connectionReferences,environmentId:e.environmentName,onChangeConnectionSelection:e.onChangeConnectionSelection,themeName:e.connectionReferencesFlowWidgetThemeName,styles:e.connectionReferencesFlowWidgetStyles,setIsLoadingConnectionReferencesFlowWidget:e.setIsLoadingConnectionReferencesFlowWidget}),!a.featureGates.enableInlineConnectionCreation&&o.createElement("div",{style:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",width:"100%"}},e.connectionReferences&&e.connectionReferences.map(n=>{var t=n.connectorid;return o.createElement(o.Fragment,null,o.createElement(r.ConnectionReference,{t:e.t,tReady:e.tReady,key:n.connectionreferencelogicalname,connectionReference:n,connections:Object(s.getIgnoreCase)(e.connections,t),connectionType:Object(s.getIgnoreCase)(e.connectionTypes,t),onChangeConnectionSelection:e.onChangeConnectionSelection,onCreateNewConnection:e.onCreateNewConnection,telemetryScope:e.telemetryScope,environmentName:e.environmentName,restrictNavigationForNewConnection:e.restrictNavigationForNewConnection}))})))}},6697:function(e,n,t){"use strict";t.r(n),t.d(n,"ConnectionReference",(function(){return h}));var o=t(2844),i=t(2903),r=t(684),c=t(790),a=t(1567),s=t(860),l=t(687),u=t(1372),f=t(245),d=t.n(f),m=t(6454),p=t(6412),C=t(6698),g=t(6411),h=e=>{var{connectionReference:n,connections:t,connectionType:h,t:v}=e,b=Object(f.useRef)(null),[y,S]=Object(f.useState)(!1);if(Object(f.useEffect)(()=>{n&&Object(m.isNullOrUndefined)(n.selectedConnectionName)&&t&&1===t.length&&n.selectedConnectionName!==t[0].name&&e.onChangeConnectionSelection(n,t[0].name,t[0])},[t,n]),!n)return d.a.createElement(d.a.Fragment,null);var E=Object(p.getMultiConnectionsPickerStyles)(),w=Object(p.getMultiConnectionsPickerClasses)();return d.a.createElement("div",{className:w.connectionReferenceContainer},d.a.createElement("div",{className:"innerContainer"},d.a.createElement(l.ImageIcon,{className:"connectionIcon",imageProps:{src:h&&h.iconUri,styles:E.connectionReferenceIconStyles}}),d.a.createElement("div",{className:"labelsContainer"},d.a.createElement("div",{className:"topLabelContainer"},d.a.createElement(u.Label,{id:"connectionName",styles:E.connectionReferenceLabelStyles,required:!0},n.connectionreferencedisplayname),!!n.appsAndFlows&&d.a.createElement("div",{className:"moreInfoIconContainer",ref:b,"aria-labelledby":"connectionName"},d.a.createElement(r.IconButton,{onClick:function(){S(!y)},styles:E.connectionReferenceMoreInfoIconButtonStyles,iconProps:{iconName:o.fabricIcons.Info,styles:E.connectionReferenceMoreInfoIconStyles},title:v("MultiConnectionsPicker.calloutTooltip")}))),d.a.createElement("span",{className:Object(i.css)(w.regularText,w.connectionReferenceSchemaName)},n.connectionreferencelogicalname))),d.a.createElement("div",{className:"innerContainer"},d.a.createElement(a.Dropdown,{placeholder:v("MultiConnectionsPicker.selectAConnection"),options:Object(g.getConnectionsOptions)(t||[],v("MultiConnectionsPicker.newConnection")),selectedKey:n.selectedConnectionName,onChange:(t,o)=>{var i=o&&o.data.connection;e.onChangeConnectionSelection(n,null==i?void 0:i.name,i)},responsiveMode:s.ResponsiveMode.large,onRenderOption:(n,t)=>Object(g.onRenderDropdownOptions)(n,t,e.environmentName,e.restrictNavigationForNewConnection,e.connectionReference.connectorid,e.telemetryScope,e.onCreateNewConnection,e.t("Common.connectionErrorCantSignIn",{connectionType:""})),styles:E.connectionReferenceDropdownStyles}),d.a.createElement(c.Callout,{styles:E.connectionReferenceCalloutStyles,role:"alertdialog",gapSpace:0,onDismiss:function(){S(!1)},setInitialFocus:!1,target:b,hidden:!y},d.a.createElement(C.ConnectionReferenceCalloutContents,{t:v,tReady:e.tReady,appsAndFlows:n.appsAndFlows}))))}},6698:function(e,n,t){"use strict";t.r(n),t.d(n,"ConnectionReferenceCalloutContents",(function(){return u}));var o=t(2844),i=t(2903),r=t(687),c=t(245),a=t.n(c),s=t(6412),l=t(6374),u=e=>{var{appsAndFlows:n,t:t}=e,c=Object(s.getMultiConnectionsPickerClasses)(),u=Object(s.getMultiConnectionsPickerStyles)();return a.a.createElement("div",{className:c.connectionReferenceCalloutContents},a.a.createElement("span",{className:Object(i.css)(c.regularText,c.boldText,c.connectionReferenceCalloutContentsTitle)},t("MultiConnectionsPicker.calloutTitle")),n&&n.length>0?n.map(e=>a.a.createElement("div",{key:"".concat(e.displayName,"-container"),className:c.connectionReferenceCalloutContentsItemContainer},a.a.createElement(r.Icon,{iconName:e.type===l.IAppOrFlowType.App?o.fabricIcons.AppIconDefault:o.fabricIcons.Flow,styles:u.appsAndFlowsCalloutIconStyles}),a.a.createElement("span",{key:"".concat(e.displayName,"-label"),className:Object(i.css)(c.regularText,c.connectionReferenceCalloutContentsItem)},e.displayName))):a.a.createElement("span",null,t("MultiConnectionsPicker.noAppsOrFlows")))}},6700:function(e,n,t){"use strict";function o(e,n){var t=[...e.keys()].find(e=>e.toLowerCase()===n.toLowerCase());if(t)return e.get(t)}t.r(n),t.d(n,"getIgnoreCase",(function(){return o}))},6701:function(e,n,t){"use strict";t.r(n),t.d(n,"getConnectionReferencesToBeUpdatedByUser",(function(){return a})),t.d(n,"getConnectionReferencesFromSolutionComponentDetails",(function(){return s})),t.d(n,"mapToPickerConnectionRefereces",(function(){return l})),t.d(n,"getConnectionReferencesFromExistingSolution",(function(){return f})),t.d(n,"getConnectionReferencesFromDataSourceEnvironmentVariables",(function(){return d})),t.d(n,"areAllConnectionsSelected",(function(){return m}));var o=t(6702),i=t(6703),r=t(6704),c=t(6705);function a(e,n){var t=[],o=s(null==e?void 0:e.SolutionComponentsDetails,null==e?void 0:e.ExistingConnectionReferences);if(t.push(...o),n){var i=d(n,o);t.push(...i)}return t.length?t:void 0}function s(e,n){return e?e.filter(e=>{var t=e.Attributes.get("connectionreferencelogicalname")||"";return n?Object(o.isConnectionReference)(e)&&!n[t]:Object(o.isConnectionReference)(e)}).map(u):[]}function l(e){return{connectionreferencedisplayname:e.connectionreferencedisplayname||"",connectionreferencelogicalname:e.connectionreferencelogicalname||"",description:e.description||"",connectorid:e.connectorid||"",selectedConnectionName:void 0,appsAndFlows:void 0}}function u(e){return{connectionreferencedisplayname:e.Attributes.get("connectionreferencedisplayname")||"",connectionreferencelogicalname:e.Attributes.get("connectionreferencelogicalname")||"",description:e.Attributes.get("description")||"",connectorid:e.Attributes.get("connectorid")||"",selectedConnectionName:void 0,appsAndFlows:void 0}}function f(e){var n;return e&&e.SolutionComponentsDetails&&(n=e.SolutionComponentsDetails.filter(n=>{var t=n.Attributes.get("connectionreferencelogicalname")||"";return Object(o.isConnectionReference)(n)&&e.ExistingConnectionReferences[t]}).map(u)).forEach(n=>{n.selectedConnectionName=e.ExistingConnectionReferences[n.connectionreferencelogicalname]}),n}function d(e,n){var t=[],o=new Set,a=function(e){if(!Object(i.isPickerParentConnectorEnvironmentVariableDefinition)(e))return"continue";if(n.find(n=>n.connectorid.toLowerCase()===e.apiid.toLowerCase()))return"continue";if(o.has(e.apiid.toLowerCase()))return"continue";o.add(e.apiid.toLowerCase());var a=void 0;Object(r.isPickerSharePointSiteEnvironmentVariableDefinition)(e)?a="SharePoint":Object(c.isPickerSQLServerEnvironmentVariableDefinition)(e)&&(a="SQL"),t.push({connectionreferencedisplayname:a||"",connectionreferencelogicalname:a||"",description:"",connectorid:e.apiid,selectedConnectionName:void 0,appsAndFlows:void 0,forConnectorEnvironmentVariable:!0})};for(var s of e)a(s);return t}function m(e){return!e||-1===e.findIndex(e=>void 0===e.selectedConnectionName)}},6702:function(e,n,t){"use strict";function o(e){return!!e.SolutionValidationResultType}t.r(n),t.d(n,"isSolutionValidationResult",(function(){return o})),t.d(n,"convertComponentsToManagedWarningMessage",(function(){return c})),t.d(n,"ComponentExistenceStatus",(function(){return i})),t.d(n,"isConnectionReference",(function(){return a})),t.d(n,"isEnvironmentVariableDefinition",(function(){return s})),t.d(n,"isEnvironmentVariableValue",(function(){return l})),t.d(n,"StageRequestStatus",(function(){return r}));var i,r,c="One or more components in the solution already exist in your system as unmanaged components. Importing this solution will convert the components into managed components for this solution. Warning: Any customizations that your organization has made to these components will be lost. After the import operation is complete, managed solutions from other solution publishers will be unable to update these components.";function a(e){return"connectionreference"===e.ComponentTypeName}function s(e){return"EnvironmentVariableDefinition"===e.ComponentTypeName}function l(e){return"EnvironmentVariableValue"===e.ComponentTypeName}!function(e){e.TRUE="True",e.FALSE="False",e.UNKNOWN="UNKNOWN"}(i||(i={})),function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.ONGOING=1]="ONGOING",e[e.FINISHED=2]="FINISHED"}(r||(r={}))},6703:function(e,n,t){"use strict";function o(e){return e.apiid}function i(e){return o(e)&&e.hasOwnProperty("connection")}function r(e){return o(e)&&(e.parentdefinition||e.parentdefinitionid)}t.r(n),t.d(n,"isPickerConnectorEnvironmentVariableDefinition",(function(){return o})),t.d(n,"isPickerParentConnectorEnvironmentVariableDefinition",(function(){return i})),t.d(n,"isPickerChildConnectorEnvironmentVariableDefinition",(function(){return r}))},6704:function(e,n,t){"use strict";t.r(n),t.d(n,"isPickerSharePointSiteEnvironmentVariableDefinition",(function(){return r})),t.d(n,"isPickerSharePointListEnvironmentVariableDefinition",(function(){return c}));var o=t(6703),i=t(6400);function r(e){return Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&Object(i.hasSharePointApiId)(e)&&"dataset"===e.parameterkey}function c(e){return Object(o.isPickerChildConnectorEnvironmentVariableDefinition)(e)&&Object(i.hasSharePointApiId)(e)&&"table"===e.parameterkey}},6705:function(e,n,t){"use strict";t.r(n),t.d(n,"isPickerSQLServerEnvironmentVariableDefinition",(function(){return r})),t.d(n,"isPickerSQLDatabaseEnvironmentVariableDefinition",(function(){return c}));var o=t(6703),i=t(6402);function r(e){return Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&Object(i.hasSQLApiId)(e)&&"dataset"===e.parameterkey}function c(e){return Object(o.isPickerChildConnectorEnvironmentVariableDefinition)(e)&&Object(i.hasSQLApiId)(e)&&"table"===e.parameterkey}},6710:function(e,n,t){"use strict";t.r(n),t.d(n,"useConnectionReferenceBehavior",(function(){return s})),t.d(n,"_organizeConnections",(function(){return l})),t.d(n,"useUpdateConnectionReferenceBehavior",(function(){return f}));var o=t(245),i=t(6377),r=t(2698),c=t(6711),a=t(6703);function s(e,n,t,s,f,d,m){var[p,C]=Object(o.useState)(new Map),{loading:g,datasets:h,errorMessage:v,refetch:b}=Object(i.useConnectionsWithDetailsQuery)(e,{},r.PortalScope,f);Object(o.useEffect)(()=>{g?n(new Map):(n(l(h)),m||function(e,n,t){if(!e||!n)return;var o=[...e];o.forEach(e=>{e.selectedConnectionName&&(n.find(n=>e.selectedConnectionName===n.name)||(e.selectedConnectionName=void 0))}),t(o)}(t,h,s))},[g]);var{loading:y,apis:S,errorMessage:E}=Object(c.useApisQuery)(e,r.PortalScope,f.unknownErrorType);Object(o.useEffect)(()=>{C(y?new Map:u(S))},[y]);return{connectionTypes:p,loadConnectionTypesErrorMessage:E,loadConnectionsErrorMessage:v,isLoadingConnections:g,isLoadingConnectionTypes:y,onRefreshConnections:b,onChangeConnectionSelection:(e,n,o)=>{var i=[...t],r=i.find(n=>n.connectionreferencelogicalname===e.connectionreferencelogicalname);if(r&&(r.selectedConnectionName=n,s(i),d)){var c=[...d.environmentVariableDefinitions.map(e=>{var t,i;return Object(a.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&(null===(t=e.apiid)||void 0===t?void 0:t.toLocaleLowerCase())===(null===(i=r.connectorid)||void 0===i?void 0:i.toLocaleLowerCase())&&(e.connection=o,e.connectionName=n),e})];d.setEnvironmentVariableDefinitions(c)}}}}function l(e,n){var t=new Map;return e&&e.forEach(e=>{var o=e.apiId||"",i=t.get(o);i||(i=[]),i.find(n=>n.displayName===e.displayName)||n&&e.isAuthError||(i.push(e),t.set(o,i))}),t}function u(e){var n=new Map;return n&&(null==e||e.forEach(e=>{var t=e.id;n.set(t,e)})),n}function f(e,n,t){var[a,s]=Object(o.useState)(new Map),{loading:f,datasets:d,errorMessage:m,refetch:p}=Object(i.useConnectionsWithDetailsQuery)(e,{},r.PortalScope,t);Object(o.useEffect)(()=>{n(f?new Map:l(d,!0))},[f]);var{loading:C,apis:g,errorMessage:h}=Object(c.useApisQuery)(e,r.PortalScope,t.unknownErrorType);return Object(o.useEffect)(()=>{s(C?new Map:u(g))},[C]),{connectionTypes:a,loadConnectionTypesErrorMessage:h,loadConnectionsErrorMessage:m,isLoadingConnections:f,isLoadingConnectionTypes:C,onRefreshConnections:p}}},6711:function(e,n,t){"use strict";t.r(n),t.d(n,"useApisQuery",(function(){return l}));var o=t(3152),i=t(217),r=t(245),c=t(3192),a=t(3193),s=t(6712);function l(e,n,t){var l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=a.TelemetryScenarioNames.apisListGraphQl,[f,d]=Object(r.useState)(),[m,p]=Object(r.useState)(""),{loading:C,data:g,error:h}=Object(o.useQuery)(s.ApisQuery,{skip:l,client:e||void 0,onCompleted:e=>{f&&f.complete({apisLength:e&&e.apis&&e.apis.length})},onError:e=>{var n=e.message,o=Object(c.getResponseMessageFromApolloError)(e,t);p(o),f&&f.failure({error:o,clientError:n})}});return Object(r.useEffect)(()=>{C&&d(Object(i.trackLoadScenario)(n,u))},[C]),{loading:C,errorMessage:h&&m,apis:g&&g.apis}}},6712:function(e,n,t){"use strict";t.r(n),t.d(n,"ApisQuery",(function(){return a}));var o,i=t(3128);var r,c,a=t.n(i)()(o||(r=["\n  query Apis {\n    apis {\n      id\n      name\n      primaryRuntimeUrl\n      iconUri\n      apiDisplayName\n    }\n  }\n"],c||(c=r.slice(0)),o=Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(c)}}))))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/200.9ea37fd2.chunk.js.map