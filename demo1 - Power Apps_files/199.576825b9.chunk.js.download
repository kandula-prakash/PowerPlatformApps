(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{5777:function(e,t,n){"use strict";n.r(t),n.d(t,"FieldLabelWithInfoIcon",(function(){return s}));var r=n(245),a=n.n(r),i=n(5778),o=n(3058),s=e=>{var{customLabelId:t,customLabelText:n,calloutContent:r}=e;return a.a.createElement(i.CustomLabel,{id:t||"labelId",label:n,calloutContent:r,iconButtonStyles:l,labelCalloutStackStyles:m,translationFile:"PowerappsPortalEntities"})},l={root:{marginLeft:5,width:20,height:20,fontSize:12,lineHeight:16,color:o.fabricColors.neutralPlum},icon:{fontSize:16}},m={root:{padding:"8px 0 8px 8px",maxWidth:250,textAlign:"left",fontSize:14,lineHeight:16}}},6385:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateEnvironmentFormKeys",(function(){return r})),n.d(t,"EnvironmentType",(function(){return a})),n.d(t,"CreateEnvironmentPanel",(function(){return w}));var r,a,i=n(4013),o=n(5127),s=n(5148),l=n(5466),m=n(1362),c=n(1567),p=n(1090),d=n(1697),v=n(1573),u=n(245),h=n(6386),E=n(5481),g=n(2869),C=n(5493),f=n(6387),P=n(6390),b=n(5777);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.environmentName="environmentName",e.environmentType="environmentType",e.environmentNameLength="environmentNameLength"}(r||(r={})),function(e){e.trial="Trial",e.production="Production"}(a||(a={}));class w extends u.Component{static getDerivedStateFromProps(e,t){return e.locationOptions.length&&void 0===t.selectedLocationOption?{selectedLocationOption:e.locationOptions[0],showPreviewProgramOptIn:Object(h.shouldShowPreviewProgramOptInFromName)(e.locationOptions[0].key)}:e.newEnvironment&&!e.newEnvironmentError?{panelOpenIndex:1}:null}constructor(e){super(e),this.resources=void 0,this.nameIsPristine=void 0,this.nameFormatRegex=/[^A-Z0-9_]+/gi,this.nameField=void 0,this.isFirstRender=!0,this.environmentTypeOptions=void 0,this.setPanelOpenIndex=e=>{this.props.newEnvironment&&0===e&&this.props.onNavigateBack(),this.setState({formResults:this.props.newEnvironment&&0===e?this.getDefaultFormResults():this.state.formResults,panelOpenIndex:this.state.panelOpenIndex!==e?e:this.state.panelOpenIndex})},this.changeRegionsDropdownState=(e,t)=>{this.setState({selectedLocationOption:t})},this._onUpdate=(e,t)=>{var n;e===r.environmentName&&t&&t!==(n=this.state.formResults.displayName&&this.state.formResults.displayName.replace(this.nameFormatRegex,""))&&(this.nameIsPristine=!1);var a=this.state&&this.state.formResults?y({},this.state.formResults):{};a[e]=t,e===r.environmentName&&this.nameIsPristine&&(n=this.state.formResults.displayName.replace(this.nameFormatRegex,""),this.nameField.current.setValue(n)),this.setState({formResults:a})},this.onDismiss=()=>{this.props.newEnvironmentInProgress||this.props.onPanelClose()},this.isDirty=()=>{this.setState({errorVisible:!0})},this.onPreviewOptInChecked=(e,t)=>{this.setState({joinPreviewProgram:t})},this.resources=Object(g.getResources)(),this.state={selectedLocationOption:void 0,showPreviewProgramOptIn:!1,joinPreviewProgram:!1,panelOpenIndex:0,formResults:this.getDefaultFormResults(),isValidForm:{},isCalloutVisible:!1,errorVisible:!1},this.environmentTypeOptions=[{key:a.trial,text:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.trialType},{key:a.production,text:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.productionType}]}componentDidMount(){this.props.onMount()}componentDidUpdate(){this.isFirstRender=!1}render(){var e={headerText:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.title,headerClassName:P.createEnvironmentPanelStyles.createEnvironmentPanelHeader,hasCloseButton:!0,closeButtonType:i.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,type:v.PanelType.smallFixedFar,messageBar:this.getMessageBar()},t=this.props.doesUserHaveActiveP2Plan?[this.getCreateEnvironmentPanel(e),this.getEnvironmentCreatedPanel(e)]:[this.getInlineTrialPanel(e)];return u.createElement(l.MultistepPanel,S({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},this.props.defaultPanelProps,{onDismiss:this.onDismiss,panelsListProps:t,panelOpenIndex:this.state.panelOpenIndex,setPanelOpenIndex:this.setPanelOpenIndex}))}getDefaultFormResults(){return{environmentType:a.trial}}getCreateEnvironmentPanel(e){var t=u.createElement(p.Link,{href:"Links.environmentRegionLink",target:"_blank"},this.resources.Common.learnMore),n=u.createElement("div",{className:"field-label-info"},u.createElement(b.FieldLabelWithInfoIcon,{customLabelId:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.region+"id",customLabelText:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.region,calloutContent:u.createElement("div",{className:P.createEnvironmentPanelStyles.tooltipContent},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.regionHelp," ",t)})),i=u.createElement("div",{className:"field-label-info"},u.createElement(b.FieldLabelWithInfoIcon,{customLabelId:"idEnvironmentTypeHelpText",customLabelText:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.environmentType,calloutContent:u.createElement("div",{className:P.createEnvironmentPanelStyles.tooltipContent},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.typeHelp)})),l=this.state.showPreviewProgramOptIn?u.createElement("div",{className:P.createEnvironmentPanelStyles.previewOptInSection},u.createElement("div",{className:"formInput"},u.createElement("div",{className:"input-label"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.previewOptIn.title),u.createElement("div",{className:"input-sublabel"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.previewOptIn.subtitle),u.createElement("div",{className:"input-sublabel"},u.createElement(p.Link,{href:E.default.environmentsHelpLink,target:"_blank"},this.resources.Common.learnMore)),u.createElement("div",{className:"preview-region-checkbox"},u.createElement(m.Checkbox,{label:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.previewOptIn.checkBoxLabel,onChange:this.onPreviewOptInChecked,checked:!!this.state.joinPreviewProgram})))):null,d=u.createElement(c.Dropdown,{options:this.props.locationOptions,required:!0,title:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.regionTextboxTitle,selectedKey:void 0!==this.state.selectedLocationOption&&void 0!==this.state.selectedLocationOption.key?this.state.selectedLocationOption.key:void 0,onChange:this.changeRegionsDropdownState,ariaLabel:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.regionTextboxTitle}),v=u.createElement(p.Link,{href:E.default.environmentsHelpLink,target:"_blank"},this.resources.Common.learnMore),h=u.createElement("div",{className:P.createEnvironmentPanelStyles.createEnvironmentSection},u.createElement("div",{className:"panel-subtitle"},u.createElement("div",{className:"panel-subtitle-text"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.subtitle," ",v)),u.createElement(o.Form,{onUpdated:this._onUpdate,showErrorsWhenPristine:!0},u.createElement("div",{className:"panel-environment-field"},u.createElement(o.FormTextInput,{textFieldProps:{label:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.environmentName,required:!0,onChange:this.isDirty},inputKey:r.environmentName,componentRef:this.nameField,validators:this.state.errorVisible?[this.valueConditionalValidator(s.required(this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Error.Required),r.environmentName),this.valueConditionalValidator(s.maxLength(100,e=>this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Error.LessOrEqual100),r.environmentNameLength)]:void 0})),u.createElement("div",{className:"panel-environment-field"},u.createElement("div",{className:"panel-environment-field-label"},u.createElement("div",{className:"panel-subtitle-text"},n)),d,u.createElement("div",{id:"regionMessage",className:"panel-environment-field-sublabel"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.regionMessage)),u.createElement("div",{className:"panel-environment-field"},u.createElement("div",{className:"panel-environment-field-label"},u.createElement("div",{className:"panel-subtitle-text"},i)),u.createElement(o.FormDropdown,{inputKey:r.environmentType,dropdownProps:{options:this.environmentTypeOptions,required:!0,title:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.environmentTextboxTitle,ariaLabel:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.environmentTextboxTitle,defaultSelectedKey:a.trial}}))),l);return y(y({},e),{},{children:h,footerButtons:this.getEnvironmentFooterButtons()})}getInlineTrialPanel(e){var t=u.createElement("div",{className:P.createEnvironmentPanelStyles.createEnvironmentPanelInlineTrial},u.createElement(f.InlineTrialContainer,{scenarioDescription:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.InlineTrial.message}));return y(y({},e),{},{children:t,footerButtons:this.getEnvironmentFooterButtons()})}getEnvironmentCreatedPanel(e){var t=u.createElement("div",{className:P.createEnvironmentPanelStyles.environmentCreatedSection},u.createElement("div",{className:"environment-created-content"},u.createElement("div",{className:"environment-created-text"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.title,u.createElement("div",{className:"recommended"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.recommended),u.createElement("div",{className:"features"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.message),u.createElement("div",{className:"features"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.feature1),u.createElement("div",{className:"features"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.feature2),u.createElement("div",{className:"features"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.feature3),u.createElement("div",{className:"features"},this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.Database.Confirm.feature4)),u.createElement("div",{className:"environment-created-image"},u.createElement("img",{src:C.default.getPaths().database,role:"presentation","aria-hidden":"true"}))));return y(y({},e),{},{children:t,footerButtons:this.getDatabaseFooterButtons()})}valueConditionalValidator(e,t){return n=>{if(!this.isFirstRender){var r=e(n);return this.setState({isValidForm:y(y({},this.state.isValidForm),{},{[t]:void 0===r})}),r}}}getEnvironmentFooterButtons(){return[{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,disabled:this.props.newEnvironmentInProgress,className:P.createEnvironmentPanelStyles.createEnvironmentPanelButton,navigateableOnClick:e=>(this.props.onPanelClose(),e)},{primary:!0,ariaLabel:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.createEnvironmentButtonLabel,text:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.createEnvironmentButtonLabel,disabled:this.isCreateEnvironmentDisabled(),className:P.createEnvironmentPanelStyles.createEnvironmentPanelButton,navigateableOnClick:e=>(this.onCreateNewEnvironmentClicked(),e)}]}getDatabaseFooterButtons(){return[{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,disabled:!1,className:P.createEnvironmentPanelStyles.createEnvironmentPanelButton,navigateableOnClick:e=>(this.props.onPanelClose(),e)},{primary:!0,ariaLabel:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.createDatabaseButtonLabel,text:this.resources.Shared.Environments.Create.CreateEnvironmentPanel.createDatabaseButtonLabel,className:P.createEnvironmentPanelStyles.createEnvironmentPanelButton,navigateableOnClick:e=>(this.props.onPanelClose(),this.props.onCreateDatabase(),e)}]}isCreateEnvironmentDisabled(){return this.props.newEnvironmentInProgress||!this.state.isValidForm.environmentName||!this.state.isValidForm.environmentNameLength}getMessageBar(){var e="",t=null;return this.props.newEnvironment?(e=this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.created,t=d.MessageBarType.success):this.props.newEnvironmentInProgress?(e=this.resources.Shared.Environments.Create.CreateEnvironmentPanel.Create.creatingEnvironment,t=d.MessageBarType.info):this.props.newEnvironmentError&&(e=this.props.newEnvironmentError,t=d.MessageBarType.error),e?{messageBarProps:{messageBarType:t},onRenderBody:()=>u.createElement("span",null,e)}:null}onCreateNewEnvironmentClicked(){var e=this.state&&this.state.formResults?y({},this.state.formResults):{},t=e[r.environmentName],n=this.state.selectedLocationOption.key,a=e[r.environmentType];this.props.onCreateNewEnvironment({name:t,region:n,type:a})}}},6386:function(e,t,n){"use strict";n.r(t),n.d(t,"shouldShowPreviewProgramOptInFromName",(function(){return a}));var r=n(5638);function a(e){return Object(r.equalsIgnoreCase)(e,"unitedstatesfirstrelease")}},6387:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return m})),n.d(t,"mapDispatchToProps",(function(){return c})),n.d(t,"InlineTrialContainer",(function(){return p}));var r=n(5437),a=n(6388),i=n(5630),o=n(5474),s=n(6389),l=n(5626),m=(e,t)=>{var n=Object(l.newP2TrialPlanSelector)(e),r=Object(l.newP2TrialPlanInProgressSelector)(e),a=Object(l.newP2TrialPlanErrorSelector)(e);return{scenarioDescription:t.scenarioDescription,newP2TrialPlan:n,newP2TrialPlanInProgress:r,newP2TrialPlanError:a}};function c(e){return{upgradePlan:()=>{e(Object(i.logAction)(Object(o.signUpForP2TrialRequest)(),s.InlineTrialEvents.InlineTrialSignUpClick.eventName))}}}var p=Object(r.connect)(m,c)(a.InlineTrial)},6388:function(e,t,n){"use strict";n.r(t),n.d(t,"InlineTrial",(function(){return d}));var r=n(3161),a=n(1090),i=n(1201),o=n(245),s=n(5628),l=n(2879),m=n(5481),c=n(2869),p=n(2880);class d extends o.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(c.getResources)()}render(){var e;return e=this.props.newP2TrialPlanInProgress?o.createElement("div",{className:"inline-trial-spinner"},o.createElement(i.Spinner,{size:i.SpinnerSize.large})):o.createElement("div",{className:"inline-trial"},o.createElement(r.EmptyState,this.getEmptyStateProps())),o.createElement("div",{className:"inline-trial"},e)}getEmptyStateProps(){return{icon:l.fabricIcons.PowerAppsLogo,className:"inline-trial-upgrade",primaryMessage:this.resources.InlineTrial.upgradePlan,secondaryMessage:this.resources.InlineTrial.upgradePlanDescription,learnMoreLabel:this.resources.InlineTrial.learnMore,learnMoreProps:{href:m.default.openInlineTrialLink,target:"_blank"},maxWidth:s.emptyStateMaxWidth}}getInlineTrialActionElement(){var e=[e=>o.createElement("b",null,e),e=>o.createElement(a.Link,{href:m.default.termsOfUse,target:"_blank"},e),e=>o.createElement(a.Link,{href:m.default.privacyAndCookies,target:"_blank"},e)];return Object(p.formatResourceStringToElement)(this.resources.InlineTrial.subtext2,(t,n)=>e[n](t))}}},6389:function(e,t,n){"use strict";n.r(t),n.d(t,"InlineTrialEvents",(function(){return r}));var r={InlineTrialSignUpClick:{eventName:"Inline.Trial.SignUp.Clicked"}}},6390:function(e,t,n){"use strict";n.r(t),n.d(t,"createEnvironmentPanelStyles",(function(){return o}));var r=n(5932),a=n(719),i=n(3058),o=Object(a.mergeStyleSets)({createEnvironmentPanelHeader:{fontFamily:r.fonts.segoeUi,fontSize:"21px",lineHeight:"25px",color:i.fabricColors.neutralPrimary,marginLeft:"6px",fontWeight:"normal",letterSpacing:"-0.01px"},createEnvironmentSection:{fontFamily:r.fonts.segoeUi,fontSize:"14px",lineHeight:"16px",marginLeft:"7px",letterSpacing:"-0.01px",".panel-subtitle":{color:i.fabricColors.neutralPrimary,paddingBottom:"25px"},".panel-environment-field":{paddingBottom:"25px",".panel-environment-field-label":{".panel-subtitle-text":{paddingBottom:"3px",button:{height:"20px",marginLeft:"-5px"},".field-label-info":{marginLeft:-6,button:{marginLeft:6}}}},".panel-environment-field-sublabel":{marginTop:"4px",color:i.fabricColors.doveGray,fontSize:"13px",fontFamily:r.fonts.segoeUiSemilight}}},environmentCreatedSection:{".header-title":{paddingBottom:"20px"},".environment-created-content":{".environment-created-text":{".recommended":{paddingBottom:"20px"}},".environment-created-image":{paddingLeft:"75px",paddingTop:"50px"}}},createEnvironmentPanelInlineTrial:{marginTop:"30px"},createEnvironmentPanelButton:{whiteSpace:"nowrap",marginRight:"15px","@media (max-width: @screen-sm-min)":{whiteSpace:"normal"}},previewOptInSection:{marginLeft:"6px",".formInput":{marginBottom:"24px",display:"block",".input-label":{fontSize:"17px",fontFamily:r.fonts.segoeUi,color:i.fabricColors.neutralPrimary,marginBottom:"8px","&.bold":{fontWeight:"500",marginBottom:"12px"}},".checkbox-label":{marginLeft:"5px"},".input-sublabel":{marginTop:"4px",color:i.fabricColors.doveGray,fontSize:"13px",fontFamily:r.fonts.segoeUiSemilight},label:{fontWeight:"normal",display:"inline-block",marginTop:"10px",width:"200px"},".preview-region-checkbox":{marginLeft:"-3px",".ms-Checkbox-checkbox":{display:"inline-flex"}}}},tooltipContent:{margin:10}})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/199.576825b9.chunk.js.map