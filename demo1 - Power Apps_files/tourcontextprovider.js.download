(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/tourcontextprovider.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[171,143],{ELzy:function(e,t,n){"use strict";n.r(t),n.d(t,"flushTourStepSync",(function(){return i})),n.d(t,"moveActiveTourToNextStepSync",(function(){return u})),n.d(t,"moveActiveTourToPreviousStepSync",(function(){return a}));var o=n("Z6+u"),r=n("nOdx"),s=n("aKhm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e=!1){return{type:o.g,sync:!0,execute({dispatch:t,getState:n}){const c=Object(s.a)(n());if(!c)return;const u=Object(r.a)().getTourProgressRecord(c.msdyn_path),a=(null==u?void 0:u.currentStepIndex)+(e?-1:1);t({type:o.g,payload:{tourId:c.msdyn_tourid,stepIndex:a}})}}}function u(){return c()}function a(){return c(!0)}function i(){return{type:o.f,payload:void 0}}},"Htl/":function(e,t,n){"use strict";n.r(t),n.d(t,"TourContextProvider",(function(){return $}));var o=n("u+q+"),r=n("arV0"),s=n("oT5e"),c=n("mMyr"),u=n("QBtP"),a=n("E5IU"),i=n("unFF"),d=n("Znsu"),l=n("z0a7"),p=n("e5YD"),b=n("SAYH"),m=n("5LEP"),g=n("+cdD"),O=n("nOdx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=e=>e.dialogContextIds.length>0,y=(e,t,n,o)=>{const r=Object(O.a)().getTourProgressRecord(e.msdyn_path);return!!Number.isInteger(null==r?void 0:r.currentStepIndex)&&((n=>{var r,s,c;const u=null===(r=e.tourSteps[n])||void 0===r?void 0:r.tourStepContext,a=null!==(c=null===(s=null==u?void 0:u.trim())||void 0===s?void 0:s.split("/"))&&void 0!==c?c:[],i=a.length;return i>3?a&&b.a.toString(o)===a[i-1]:a&&t===a[i-1]})(r.currentStepIndex)||!e.tourSteps.some(e=>e.tourStepContext)&&e.msdyn_path===n)};var j=n("Z6+u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const h=["PowerTours.Footer.StepOf","PowerTours.Next.ButtonText","PowerTours.Previous.ButtonText","PowerTours.Done.ButtonText","PowerTours.Dismiss.ButtonText","PowerTours.ExpandContent.ButtonText","PowerTours.ExpandContent.AnnouncementText"];var T=n("IqkD"),w=n("7tM0"),x=n("KOTC"),f=n("hBHB"),S=n("kxAB"),P=n("ruPX"),C=n("MTWl");const E=c.memo(e=>{const t=c.useContext(u.a).Router,n=Object(o.c)(),r=unescape(e.href),s=t.isURLSupportedForNavigation(r),a=e.target&&"_blank"===e.target?"newWindow":"inline",i=e=>{switch(e.preventDefault(),a){case"newWindow":t.navigateToNewWindow(r);break;default:n(Object(P.a)(r))}};return s?c.createElement(C.a,Object.assign({style:{color:"white"},onClick:i},e)):c.createElement(C.a,Object.assign({style:{color:"white"}},e),e.children)}),B={block:"nearest",alignToTop:!1,behavior:"smooth"},I=()=>{const e=Object(f.a)(S.a);return t=>c.createElement(e,Object.assign({slots:{a:{component:E}}},t))},_=(e,t,n,o)=>[{name:d.q,value:null==e?void 0:e.msdyn_displayname},{name:d.p,value:null==e?void 0:e.msdyn_tourid},{name:d.m,value:t},{name:d.v,value:n},{name:d.t,value:o}];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var k=n("ELzy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const A=(e,t)=>e.replace(d.x,(e,n)=>t[n]);var R=n("aKhm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const F=e=>null==e?void 0:e.some(e=>e.headline.match(d.x)||e.content.match(d.x)),N=(e,t,n)=>{return(t&&F(e)||!F(e))&&(o=n,!h.some(e=>!o[e]));var o};const z=c.memo(({tour:e,tourKey:t,renderContextFully:r,allowContextToBeRenderedNormally:s})=>{const a=(e=>null==e?void 0:e.tourSteps)(e),i=Object(g.a)(a,d.d),m=Object(l.a)(h),O=c.useContext(u.a).EventManager,v=Object(o.d)(T.q),y=Object(o.d)(t=>Object(w.b)(t,Object(g.c)(e))),f=Object(o.c)(),S=b.a.newGuid().guid,P=c.createRef(),C=Object(o.d)(t=>Object(R.f)(t,e.msdyn_tourid)),E=c.useCallback((t,n)=>(o=null)=>{s(),t!==d.k&&t!==d.l||f({type:j.i,payload:{tourId:e.msdyn_tourid}});const r=_(e,o,n,S);O.ReportComponentSuccess(`${d.g}.${t}`,r)},[e,O,s]),F=c.useCallback(t=>(n,o)=>{f({type:j.h,payload:{tourId:e.msdyn_tourid}}),n.type!==d.j||document.querySelector(n.targetElement)||r();const s=_(e,o,t,S);O.ReportComponentSuccess(`${d.g}.${d.u}`,s)},[O,e,r]),[z,D]=c.useState(window.innerWidth>window.innerHeight),M=()=>{D(window.innerWidth>window.innerHeight)};if(c.useEffect(()=>(window.addEventListener("resize",M,!0),()=>{window.removeEventListener("resize",M,!0)}),[]),c.useEffect(()=>{Number.isInteger(C)&&(C>=0&&C<e.tourSteps.length?P.current.navigateToStep(C):C>=0&&C===e.tourSteps.length&&P.current.complete(),f(Object(k.flushTourStepSync)()))},[P,C,f,e]),!N(a,y,m))return null;((e,t)=>{for(const n of e)n.headline=A(n.headline,t),n.content=A(n.content,t)})(a,y);const L=function(e,t){return{subComponentStrings:{[t]:t=>({closeButtonAriaLabel:Object(p.b)(e,"PowerTours.Dismiss.ButtonText"),footerText:""+Object(p.b)(e,"PowerTours.Footer.StepOf").replace("{0}",(t.stepIndex+1).toString()).replace("{1}",t.totalSteps.toString()),nextStepButtonText:t.stepIndex<t.totalSteps-1?""+Object(p.b)(e,"PowerTours.Next.ButtonText"):""+Object(p.b)(e,"PowerTours.Done.ButtonText"),previousStepButtonText:Object(p.b)(e,"PowerTours.Previous.ButtonText"),expandContentButtonText:Object(p.b)(e,"PowerTours.ExpandContent.ButtonText"),modalOpenedAnnouncementText:Object(p.b)(e,"PowerTours.ExpandContent.AnnouncementText"),focusInAnnouncementText:Object(p.b)(e,"PowerTours.FocusInAnnouncementText"),focusOutAnnouncementText:Object(p.b)(e,"PowerTours.FocusOutAnnouncementText")})}}}(m,i?d.c:d.a);return c.createElement(c.Fragment,null,i&&(({tourSteps:e,primaryButtonAction:t,secondaryButtonAction:o},r,s,u,a,i,l,p)=>{const b=l?{headerTextLineCount:1,contentTextLineCount:1}:{headerTextLineCount:2,contentTextLineCount:3};return c.createElement(x.a,{key:"tourplayer",loader:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(29),n.e(36),n.e(59),n.e(183),n.e(157)]).then(n.bind(null,"4bpV")).then(e=>e.withLocalStorageProgressTracking(e.withDrawerSteps(e.Tour),d.z)),props:{steps:e,tourKey:r,userKey:u,componentRef:p,modal:!1,onAbort:a(d.k,e.length),onComplete:a(d.l,e.length),resumeIfInProgress:!0,abortOnUnmount:!1,onStepChange:i,strings:s,drawerStepProps:{drawerProps:Object.assign(Object.assign(Object.assign({},b),t&&{primaryButtonOnClick:t}),o&&{secondaryButtonOnClick:o})}}})})(e,t,L,b.a.toString(v),E,F(a.length),z,P),!i&&(({tourSteps:e,subcomponentProps:t,primaryButtonAction:o,secondaryButtonAction:r},s,u,a,i,l,p)=>c.createElement(x.a,{key:"tourplayer",loader:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(29),n.e(36),n.e(59),n.e(183),n.e(157)]).then(n.bind(null,"4bpV")).then(e=>e.withLocalStorageProgressTracking(e.withBalloonSteps(e.Tour),d.z)),props:{steps:e,tourKey:s,userKey:a,componentRef:p,modal:!1,onAbort:i(d.k,e.length),onComplete:i(d.l,e.length),resumeIfInProgress:!0,abortOnUnmount:!1,onStepChange:l,strings:u,balloonStepProps:{autoScrollOptions:B,teachingBubbleProps:Object.assign(Object.assign(Object.assign({focusTrapZoneProps:{disabled:!0}},t),o&&{primaryButtonProps:Object.assign(Object.assign({},null==t?void 0:t.primaryButtonProps),{onClick:o})}),r&&{secondaryButtonProps:Object.assign(Object.assign({},null==t?void 0:t.secondaryButtonProps),{onClick:r})})},balloonStepAs:I()}}))
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t,L,b.a.toString(v),E,F(a.length),P))});var D=n("99zj"),M=n("FdKt"),L=n("NjDY");var K=n("nrNG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function U(e){return()=>{const{tour:t,children:n}=e,r=Object(o.c)(),{TraceManager:s}=c.useContext(u.a),a=Object(o.d)(e=>Object(R.c)(e,t.msdyn_tourid)),i=Object(o.d)(e=>Object(R.b)(e,t.msdyn_tourid));return c.useEffect(()=>{if(((e,t)=>e&&(void 0===t||t===m.a.Uninitialized))(t,a))try{const e=[];r(Object(K.b)(t.msdyn_tourid,m.a.Initializing)),i.forEach(t=>e.push(t())),Promise.all(e).then(()=>r(Object(K.b)(t.msdyn_tourid,m.a.Initialized)))}catch(e){r(Object(K.b)(t.msdyn_tourid,m.a.Failed));s.getTracer(d.g).error("Initializing webresources failed: "+e)}},[t,i,a,r,s]),c.createElement(c.Fragment,null,a===m.a.Initialized&&n)}}var W=n("n3bs"),q=n("0boP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $=c.memo(()=>{const e=Object(o.d)(e=>{var t;return null===(t=e.tours)||void 0===t?void 0:t.tours}),t=Object(o.c)(),n=Object(o.d)(s.f),l=null==n?void 0:n.pageId,p=Object(o.d)(e=>Object(r.j)(e,l)),h=Object(o.d)(e=>Object(g.b)(e,l)),w=Object(o.d)(a.o),x=Object(o.d)(i.a),f=c.useContext(u.a),S=f.EventManager,P=null==p?void 0:p.pageType,C=(e=>["",d.i,e].join(d.s))(w),E=Object(o.d)(e=>Object(r.p)(e,l)),B=Object(o.d)(e=>Object(T.s)(e)),I=Object(o.d)(e=>Object(L.D)(e).languageCode),_=Object(o.d)(e=>Object(R.h)(e)),k=f.Router,A=f.IntersectionObserverManager,F=Object(g.d)(w,P,h),N=(e=>{const t=Object(o.c)(),[n,r]=c.useState({width:0,height:0});return c.useEffect(()=>{const t=document.getElementById(e);if(!t)return()=>{};const n=new ResizeObserver(e=>{if(e[0]&&e[0].contentRect){const{contentRect:t}=e[0];r({width:t.width,height:t.height})}});return n.observe(t),()=>{n.disconnect()}},[t,e]),n})(d.A),K=Object(o.d)(T.q),$=P===W.a.ENTITY_RECORD?p.id:void 0,[H,Y]=c.useState(void 0),[G,Z]=c.useState(F);Object(o.d)(e=>e.browsingContexts),Object(o.d)(e=>e.sessions);const V=c.useCallback(()=>{var e;try{const n=E&&k.getPageMappings().getFactoryForPage({pageName:E});null===(e=null==n?void 0:n.forceRenderPage)||void 0===e||e.call(n,t,p,w,A)}catch(e){}},[t,k,A,w]),J=c.useCallback(()=>{var e;try{const n=E&&k.getPageMappings().getFactoryForPage({pageName:E});null===(e=n.revertForceRenderOfPage)||void 0===e||e.call(n,t,p,w,A)}catch(e){}},[t,k,A,w]);c.useEffect(()=>{
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var e;t((e=N,{type:j.e,payload:{containerDimensions:e}}))},[t,N]),c.useEffect(()=>{Object(M.b)(async()=>{const e=await t(Object(q.retrieveToursAsync)()),n=((e,t)=>{const n=[];return null==e||e.forEach(e=>{const o=Object(g.c)(e);if(!o)return;const r=`${o}.${t.toString()}.resx`;n.includes(r)||n.push(r)}),n})(e,B||I);await t(Object(D.d)(n));const o=[{name:"RetrievedTours",value:null==e?void 0:e.length}];S.ReportComponentSuccess(d.g,o)},"Retrieve tours")},[w,t,f,S,B,I]),c.useEffect(()=>{Object(O.b)(K).then(({abortOtherInProgressTours:t})=>{const n=((e,t,n,o,r)=>e.find(e=>t[e.msdyn_tourid].isActive&&y(e,o,n,r))||e.find(e=>{const t=Object(O.a)().getTourProgressRecord(e.msdyn_path);return e.msdyn_path===n&&!(null==t?void 0:t.currentStepIndex)}))(e.filter(e=>e.msdyn_path.startsWith(C)).filter(e=>((e,t)=>{var n;return(null===(n=null==t?void 0:t[e.msdyn_tourid])||void 0===n?void 0:n.status)!==m.a.Failed})(e,_)),_,F,h,$);(null==n?void 0:n.msdyn_tourid)!==(null==H?void 0:H.msdyn_tourid)&&h!==b.a.EMPTYGUIDSTRING&&((null==n?void 0:n.msdyn_tourid)&&t(n.msdyn_path),Z(null==n?void 0:n.msdyn_path),Y(n))})},[e,_,C,F,h,H,t,K,$]);const Q=c.useMemo(()=>U({tour:H,children:c.createElement(z,{tour:H,tourKey:G,theme:x,renderContextFully:V,allowContextToBeRenderedNormally:J})}),[H,G,x,V,J]),X=((e,t)=>e&&!v(t))(H,n)?c.createElement(Q,null):null;return c.createElement("div",{key:d.A,id:d.A,route:F},X)})}}]),window.bundleExecutionMarkers["scripts/tourcontextprovider.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();