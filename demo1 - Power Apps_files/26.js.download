(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/26.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[26],{"0HUS":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n="PowerBI.Report",i="PowerBI.Dashboard",a=[n,i]},Gn6i:function(e,t,r){"use strict";r.d(t,"a",(function(){return pr})),r.d(t,"c",(function(){return fr})),r.d(t,"b",(function(){return hr}));var n=r("SAYH"),i=r("odYE"),a=r("lY/Z"),o=r("5Oca"),s=r("OWbt"),c=r("NPZ3"),l=r("XVX7"),u=r("wNQP"),d=r("y60j"),b=r("EY5k"),m=r("MktZ"),p=r("f/sd"),h=r("ZXdP"),f=r("2yvP"),g=r("arV0"),O=r("4Us1"),v=r("+nNZ"),y=r("dHD5"),j=r("zI6t"),P=r.n(j),I=r("pEXn"),C=r("ghNp"),S=r("rdSB"),w=r("LbMF"),T=r("UqyN"),F=r("IaGr"),N=r("qshH"),R=r("/A0C"),_=r("mIxf");function E(e){const t={};for(const r in e){const n={fieldName:r,value:e[r]};t[r]=n}return t}var D=r("AFlp"),k=r("k1f1"),V=r("ycdb"),A=r("Lohl"),x=r("Lyxw"),B=r("XhkN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const W=B.b+".sync";function L(e,t){return{type:W,sync:!0,execute(r,n){r.dispatch(function(e,t){const r={workflowObjectModelLibraryLoaded:t};return{type:B.b,payload:r,meta:{pageId:e}}}(e,t))}}}var U=r("504W"),M=r("iZ7K"),z=r("PUjk"),H=r("D4Jo"),Q=r("JF0K"),q=r.p+"scripts/WorkflowObjectModel.js?v=1.4.3886-master",G=r("7LBy"),K=r("jq7Z"),Y=r("i1f0"),Z=r("fh2P"),J=r("3/02");function X(e,t,r,a,s,c,l,u,d,b,m){const p=Object(o.e)(e(),c),h=c&&c.etn||"",f=Object(M.p)(e(),h),g=c&&c.id?n.a.toString(c.id):"",v=u.correlationId,y={};y[I.b.BpfProcessControlRenderParameters.ProcessId]=n.a.toString(l),y[I.b.BpfProcessControlRenderParameters.BusinessProcessFlowInstanceId]=Object(U.a)(p)?"":n.a.toString(p),y[I.b.BpfProcessControlRenderParameters.EntityTypeCode]=Object(U.a)(f)?"":f.toString(),y[I.b.BpfProcessControlRenderParameters.EntityId]=g,y[I.b.BpfProcessControlRenderParameters.CorrelationId]=v,y[I.b.BpfProcessControlRenderParameters.PageId]=a,P.a.addKeyPerformanceIndicator("BPF.RenderProcessControl",y);const j=[{name:"CorrelationId",value:v},{name:"ContextId",value:u.contextId},{name:"ActionStack",value:u.stack},{name:"entityTypeCode",value:f},{name:"entityId",value:g}],C=d.AssetLoader.loadScript(q),S=t(Object(O.a)(l,c,b));return Promise.all([C,S]).then(u=>{t(L(a,!0));const d=u[1];if(!d)return;r.info("retrieveBusinessProcessFlow promise resolved successfully.");const p=e();let h=Promise.resolve();const f=[];if(Object(x.f)(p,J.Sb)&&(Object(U.a)(b)||b.then(()=>{h=function(e,t,r,a,s,c){let l=Promise.resolve(),u=c;if(t&&t.businessProcessFlows&&Object.keys(t.businessProcessFlows).length>0){if(u===n.a.EMPTY&&!Object(U.a)(s)){const r=Object(o.b)(s)(e,s.etn);u=r&&r.businessProcessFlowId?r.businessProcessFlowId:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId}const c=u!==n.a.EMPTY?t.businessProcessFlows[u.guid].businessProcessFlowUniqueName:null;if(Object(U.a)(c)){if(!Object(U.a)(t)&&!Object(U.a)(t.businessProcessFlows)&&Object.keys(t.businessProcessFlows).length>0){const e=[];e.push({name:"BPF Id",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowId.guid},{name:"BPF UniqueName",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowUniqueName},{name:"currentProcessId",value:u?u.guid:""},{name:"BPF Name",value:t.businessProcessFlows[Object.keys(t.businessProcessFlows)[0]].businessProcessFlowName}),a.error("BPF descriptor does not contain unique name which is required to load BPF Entity form descriptor",e)}}else l=r(Object(A.d)(new i.a(c),null))}return l}(p,d,t,r,c,l)})),c.id===n.a.EMPTY){const i=Object(G.a)(m),u=Object(G.b)(m);if(f.push(t(Object(V.b)(!1,c))),i&&u)return f.push(t(Object(D.b)(i,c))),f.push(t(Object(k.b)(u,c))),Promise.all(f).then(n=>$(c,s,a,t,e,r));let d=l;if(n.a.isNullOrEmpty(d)&&(d=Object(o.d)(p,c.etn)),!n.a.isNullOrEmpty(d))return f.push(t(Object(D.b)(d,c))),f.push(t(Object(k.b)(n.a.EMPTY,c))),Promise.all(f).then(n=>$(c,s,a,t,e,r,!0))}return Promise.all([b,h]).then(()=>$(c,s,a,t,e,r))}).then(()=>{const e=Object(z.a)(a);e&&(j.push(...e.getTelemetryParams()),Object(H.c)(Q.q,j,d))}).catch(t=>{const n=m&&m.entityTypeName?new i.a(m.entityTypeName,m.id):null,o=Object(H.a)(e(),n,a,d);return o&&(j.push(...o),r.error("Error while executing loadBusinessProcessFlow in the retrieveBusinessProcessFlow promise.",j),Object(H.b)(Q.q,t,null,j,d,c,e())),null})}function $(e,t,r,i,a,s,c=!1){var l,u;const d=[];let b=Promise.resolve();const m=a(),p=Object(o.e)(m,e);if(!n.a.isNullOrEmpty(p)){const n=Object(v.a)(m,p);if(n&&n.businessProcessFlowStepEntityAttributeControls){s.debug("BusinessProcessFlowDescriptor is valid.",d);const o=n.businessProcessFlowStepEntityAttributeControls[e.etn];if(o&&Object.keys(o).length){d.push({name:"bpfControls.length",value:Object.keys(o).length}),s.debug("bpfControls is valid.",d);const n=Object(y.w)(t),p=Object(K.a)(m,r),h=p&&p.metadata&&p.metadata[n]&&p.metadata[n].attributes,g={};for(const t in o){const r=o[t].DataFieldName;if(g[r]||h&&r in h)continue;const n=Object(w.a)(m,e.etn,r);n&&(g[r]=n)}i(Object(S.c)(t,r,g));const O=ee(new Set(Object.keys(null!==(u=null===(l=Object(Y.fb)(a(),r,t))||void 0===l?void 0:l.controls)&&void 0!==u?u:{})),o,!0);i(Object(S.d)(a(),t,r,O));const v=function(e,t,r,n){const i=e(Object(C.b)(r,n));return Object(f.b)("bpf.initialization",()=>{if(i&&i.data&&i.ui){const e=i.ui,r=new Set;return e.controls.forEach(e=>r.add(e.getName())),ee(r,t)}return t})}(i,o,r,t);b=i(function(e,t,r,n,i,a=!1){return{type:"clientapi.add.controls",execute(o,s){try{return Object(f.b)("bpf.initialization",()=>{const s=o.dispatch(Object(C.b)(t,e));if(s&&s.data&&s.ui){const c=s.data.entity,l=s.ui;if(c&&c.attributes){if(r){const n=c.attributes;for(const s in r){const u=r[s];let d=n.get(s);if(!d){const i=Object(T.b)(o,e,t,s,c,l,r[s]);i&&(n.add(s,i),d=n.get(s))}if(u&&d){const e=u.Type===R.a.PickList&&0===u.OptionSetType&&u.DefaultValue&&u.DefaultValue>-1,r=u.Type===R.a.Boolean&&3===u.OptionSetType&&u.DefaultValue;if(a&&(e||r)&&!d.getValue()){const e={};e[s]=u.DefaultValue;const r=E(e);o.dispatch(Object(_.a)(t,r,!0,!0))}}else{const e=[];e.push({name:"BpfAttribute",value:s}),i.debug("BPF Attribute cannot be null.",e)}}}n&&l.addControls(n)}}}),Promise.resolve()}catch(t){const r=N.a.getInstance().getEventParameters(e);throw F.a.getInstance().eventManager.ReportComponentFailure("ClientApi.AddBpfFieldsToXrmCollection.addBpfFieldsToXrmCollection",t,null,r),t}},shouldReceiveFullStore:!0}}(t,r,g,v,s,c))}else s.debug("bpfControls is invalid.",d)}else s.debug("BusinessProcessFlowDescriptor is invalid.",d)}return b}function ee(e,t,r=!1){let i={};if(t){const a=Object.keys(t);if((null==a?void 0:a.length)>0){const o=a.filter(t=>!e.has(t));let s={};o.forEach(e=>{s={[e]:t[e]},i=Object.assign(Object.assign({},i),s)});const c=Z.b;return!r||e.has(c)||o.includes(c)||(i[c]={Id:null,Label:null,Name:c,ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:n.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")}),i}}return t}var te=r("8nT0"),re=r("M0zh"),ne=r("nmJf"),ie=r("Bo7t"),ae=r("nC8a"),oe=r("Bj/n"),se=r("3tOH"),ce=r("uCpV"),le=r("X37l"),ue=r("1HWW"),de=r("Izjb"),be=r("wF0i"),me=r("SZCI"),pe=r("Or4W"),he=r("MoY7"),fe=r("fMBw"),ge=r.n(fe),Oe=r("ZFRl"),ve=r("O7zD"),ye=r("Xi8U"),je=r("Uv1Y"),Pe=r("AF/G"),Ie=r("VqBP"),Ce=r("Z/4N"),Se=r("CYtR");function we(e,t,r){let n=e.controls[t];n||(n=e.controls[t]={numPresent:0,numVisible:0}),n.numPresent++,r&&n.numVisible++}function Te(e,t,r,n,i){if(n){const a=n.ParentSectionName;a&&-1===r.sections.indexOf(a)&&r.sections.push(a);let o=Object(Pe.F)(n.ClassId);const s=Object(Ce.c)(e,n.UniqueId,t);s===Se.c?o=Se.c:n.IsUnbound&&function(e,t,r){let n=e.unboundControls[t];n||(n=e.unboundControls[t]={numPresent:0,numVisible:0}),n.numPresent++,r&&n.numVisible++}(r,s,n.Visible),we(r,o,n.Visible),function(e,t,r){t&&r&&r[t.Name]&&(t.Parameters&&"true"===t.Parameters[Ie.a]?we(e,"QuickFormCardsByParameter",t.Visible):we(e,"QuickFormsByParameter",t.Visible))}(r,n,i)}}var Fe=r("PidC"),Ne=r("5iTp"),Re=r("dJ44");class _e{constructor(){this._numControls=0}updateFormComponentCount(e,t,r){Object(Ce.c)(e,null==t?void 0:t.UniqueId,r)===Se.c&&this._numControls++}getFormComponentCount(){return this._numControls}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ee(e,t,r,n,i,a,o,s){var c;!function(e,t,r,n){const i=Object(M.h)(e,t);i&&n.push({name:"IsCustomEntity",value:i.IsCustomEntity},{name:"IsActivityEntity",value:i.IsActivity});if(r){const t=Object(M.k)(e,r);n.push({name:"HasEntityImage",value:null!=t&&t.trim().length>0})}}(e,i,a,s),function(e,t,r,n,i){const a=Object(d.c)(e,n,t);if(a){const o=Object.keys(a),s={},c=Object(d.p)(e,n),l=new _e;o.forEach(i=>{const o=a[i];l.updateFormComponentCount(e,o,n),function(e,t,r,n,i,a,o){if(a&&i&&a.ParentTabId){const s=a.ParentTabId;let c=i[s];if(!c){const n=Object(Y.Sc)(e,t,s,r);c={tabName:s,sections:[],controls:{},unboundControls:{},contentType:"cardSections"},(null==n?void 0:n.contentType)&&(c.contentType=n.contentType),i[s]=c}Te(e,n,c,a,o)}}(e,t,r,n,s,o,c)});const u=Object(Y.Q)(e,n,t),b=Object(Y.Cc)(e,t,r);i.push({name:"defaultTabId",value:u},{name:"selectedTabId",value:b},{name:"FormComplexitiesByTab",value:JSON.stringify(s)},{name:"NumFormComponentControls",value:l.getFormComponentCount()})}}(e,t,r,n,s),function(e,t){e&&null!=e.bodyOnly&&t.push({name:"BodyOnly",value:e.bodyOnly})}(o,s);const l=Object(d.u)(e,n);null!=l&&s.push({name:"NumTabs",value:l});const u=Object(d.s)(e,n);null!=u&&s.push({name:"NumSections",value:u});const b=Object(d.h)(e,n);b&&s.push({name:"HeaderDensity",value:b.HeaderDensity});let m=0;const p=Object(d.d)(e,n,t);if(null!=p){const n=[];for(const i of p)i.Name!==Z.b&&(n.push(i),Object(Y.v)(e,{id:t,controlName:i.Name},r)&&m++);s.push({name:"NumHeaderFields",value:n.length}),s.push({name:"NumReadOnlyHeaderFields",value:m});const i=n.filter(e=>!Object(Fe.j)(e));s.push({name:"NumHeaderV2UnsupportedControls",value:i.length})}const h=Object(Fe.e)(e,t,r);h&&(s.push({name:"HeaderCommandBarVisible",value:h.commandBarVisible}),s.push({name:"HeaderBodyVisible",value:h.bodyVisible}),s.push({name:"HeaderTabNavigatorVisible",value:h.tabNavigatorVisible}));const f=Object(Ne.a)(e,t,r);f&&s.push({name:"FooterVisible",value:f.visible});const g=Object(d.b)(e,n,t);null!=g&&s.push({name:"NumFooterFields",value:g.length});const O=Object(Re.b)(e);s.push({name:"HighDensityPageHeaderEnabledForApp",value:O});const v=Object(Re.a)(e);s.push({name:"HeroIconLengthInHighDensityPageHeaderInTeams",value:v}),s.push({name:"UnfilteredFormSelectorIds",value:null===(c=e.metadata.formSelectorUnfilteredIdsCountByEntity)||void 0===c?void 0:c[i]});const y=Object(d.l)(e,i),j=y?Object.keys(y).length:0;s.push({name:"FilteredFormSelectorIds",value:j})}var De=r("uWQm"),ke=r("+zjj"),Ve=r("meVR"),Ae=r("E8F2"),xe=r("VpHT"),Be=r("69Qu"),We=r("pp6D"),Le=r("YxC/"),Ue=r("sptG"),Me=r("jTSi"),ze=r("Zzxs"),He=r("SnEr"),Qe=r("WA3M"),qe=r("txdA"),Ge=r("dtbk"),Ke=r("TBkx"),Ye=r("ldGr"),Ze=r("bT7G"),Je=r("sozv"),Xe=r("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class $e{constructor(e){this.type=e.type,this.raw=Object.assign({},e.raw),this.attributes=Object.assign({},e.attributes),this.error=e.error,this.errorMessage=e.errorMessage,this.errorCode=e.errorCode,this.security=Object.assign({},e.security),this.timerParameterAttributeValues=Object.assign({},e.timerParameterAttributeValues),this.timerParameters=Object.assign({},e.timerParameters),this.timerState=e.timerState,this.serverTimeDifferenceInSeconds=e.serverTimeDifferenceInSeconds,this.timerControlId=e.timerControlId,this.telemetryParameters=Object.assign({},e.telemetryParameters)}}var et=r("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var tt,rt;!function(e){e[e.CancelCondition=0]="CancelCondition",e[e.FailureCondition=1]="FailureCondition",e[e.FailureTimeField=2]="FailureTimeField",e[e.PauseCondition=3]="PauseCondition",e[e.SuccessCondition=4]="SuccessCondition",e[e.WarningCondition=5]="WarningCondition"}(tt||(tt={})),function(e){e[e.NoPrivilege=0]="NoPrivilege",e[e.NotSet=1]="NotSet",e[e.InProgress=2]="InProgress",e[e.Warning=3]="Warning",e[e.Violated=4]="Violated",e[e.Succeeded=5]="Succeeded",e[e.Unsucceeded=6]="Unsucceeded",e[e.Canceled=7]="Canceled",e[e.Paused=8]="Paused"}(rt||(rt={}));class nt{constructor(e,t,r){this._entityName="",this._propValue=new $e({type:"",raw:null,attributes:{},error:!1,errorMessage:"",security:{},timerParameterAttributeValues:{},timerParameters:{},timerState:rt.NotSet,serverTimeDifferenceInSeconds:null!=r?r:0,timerControlId:t,telemetryParameters:{}})}_getTimeRemainingInMilliseconds(e){const t=(new Date).toUTCString();return new Date(e).getTime()-new Date(t).getTime()+1e3*this._propValue.serverTimeDifferenceInSeconds}_getTimerParameterAttributes(){const e=[];let t;return this._propValue&&(t=this._propValue.timerParameters)?(e.push(t.CancelConditionName),e.push(t.FailureConditionName),e.push(t.FailureTimeField),e.push(t.PauseConditionName),e.push(t.SuccessConditionName),e.push(t.WarningConditionName),e):e}_updateTimerContext(e,t,r,n){let i,a=!0;const o={},s=this._getTimerParameterAttributes(),c=Object(Y.hc)(e,r,n);i=0;for(const t of s){if(Object(U.b)(t)){i++;continue}const r=t;if(Object(U.b)(o[r])){const t=Object(Ze.e)(e,c,this._entityRef,r),n=Object(w.a)(e,this._entityName,r);null!=n&&null!=n.IsValidForRead&&(a=n.IsValidForRead&&a),o[r]=t}this._updateTimerParameterAttributeValues(i++,o[r])}this._updateTimerState(a)}_updateTimerParameterAttributeValues(e,t){const r=this._propValue.timerParameterAttributeValues;switch(e){case tt.CancelCondition:const e=t;r.CancelConditionAttributeValue=e&&e.valueString;break;case tt.FailureCondition:const n=t;r.FailureConditionAttributeValue=n&&n.valueString;break;case tt.FailureTimeField:const i=t;r.FailureTimeFieldAttributeValue=i&&i.value;break;case tt.PauseCondition:const a=t;r.PauseConditionAttributeValue=a&&a.valueString;break;case tt.SuccessCondition:const o=t;r.SuccessConditionAttributeValue=o&&o.valueString;break;case tt.WarningCondition:const s=t;r.WarningConditionAttributeValue=s&&s.valueString}this._propValue.timerParameterAttributeValues=r}_updateTimerState(e){let t,r,n=rt.Violated;this._propValue&&(t=this._propValue.timerParameters)&&(r=this._propValue.timerParameterAttributeValues)&&(n=e?null==t.FailureTimeField||Object(U.b)(r.FailureTimeFieldAttributeValue)?rt.NotSet:Object(U.b)(t.FailureConditionName)||Object(U.b)(t.FailureConditionValue)||r.FailureConditionAttributeValue!==t.FailureConditionValue?Object(U.b)(t.CancelConditionName)||Object(U.b)(t.CancelConditionValue)||r.CancelConditionAttributeValue!==t.CancelConditionValue?Object(U.b)(t.SuccessConditionName)||Object(U.b)(t.SuccessConditionValue)||r.SuccessConditionAttributeValue!==t.SuccessConditionValue?Object(U.b)(t.PauseConditionName)||Object(U.b)(t.PauseConditionValue)||r.PauseConditionAttributeValue!==t.PauseConditionValue?this._getTimeRemainingInMilliseconds(r.FailureTimeFieldAttributeValue)>0?Object(U.b)(t.WarningConditionName)||Object(U.b)(t.WarningConditionValue)||r.WarningConditionAttributeValue!==t.WarningConditionValue?rt.InProgress:rt.Warning:rt.Violated:rt.Paused:rt.Succeeded:rt.Canceled:rt.Unsucceeded:rt.NoPrivilege,this._propValue.timerState=n)}getLatestData(){return this._propValue}linkToParameter(e,t){}getTimerData(e,t,r,a,s,c){let l=null,u=n.a.EMPTY;const b=a.Parameters[e];let m=n.a.EMPTY;if(!b||!this._propValue)return this._propValue;const p=0===b.Usage,h=r.id,f=b&&b.TimerParameters;if(!p||!f)return this._propValue;if(this._propValue.type=b.Type,this._propValue.timerParameters=f,r.formInfo&&(u=new n.a(r.formInfo.FormId),l=r.formInfo.EntityName,m=new n.a(r.formInfo.RecordId)),n.a.isNullOrEmpty(u)&&(u=Object(et.b)(t,r.id)),Object(U.b)(l)&&s&&(l=s.entityTypeName),n.a.isNullOrEmpty(m)&&s&&(m=s.id),n.a.isNullOrEmpty(u)||n.a.isNullOrEmpty(m)||Object(U.b)(l))return this._propValue;if(this._entityName=l,this._entityRef=new i.a(l,m),!this._entityRef)return this._propValue;if(!Object(Je.b)(t,u)){const e=Object(o.b)(this._entityRef)(t,this._entityRef.etn);if(!e||!Object(Xe.b)(e.initialized))return this._propValue}if(this._updateTimerContext(t,r,h,c),r.descriptor.Parameters.timerState=this._propValue.timerState,null!=t){if(t.organization&&(t.organization.organizationId&&(this._propValue.telemetryParameters.OrgId=t.organization.organizationId.guid),t.organization.organizationSettings&&null!=t.organization.organizationSettings.isTrialOrganization&&(this._propValue.telemetryParameters.IsTrialOrganization=t.organization.organizationSettings.isTrialOrganization.toString())),t.user&&t.user.userId&&(this._propValue.telemetryParameters.UserId=t.user.userId.guid),!Object(U.b)(l)&&t.metadata&&(t.metadata.entities&&t.metadata.entities[l]&&(null!=t.metadata.entities[l].IsActivity&&(this._propValue.telemetryParameters.IsActivity=t.metadata.entities[l].IsActivity.toString()),null!=t.metadata.entities[l].IsCustomEntity&&(this._propValue.telemetryParameters.IsCustomEntity=t.metadata.entities[l].IsCustomEntity.toString()),"true"===this._propValue.telemetryParameters.IsCustomEntity?this._propValue.telemetryParameters.EntityName="":this._propValue.telemetryParameters.EntityName=l,t.metadata.entities[l].ObjectTypeCode&&(this._propValue.telemetryParameters.EntityTypeCode=t.metadata.entities[l].ObjectTypeCode.toString())),!n.a.isNullOrEmpty(u))){const e=Object(d.h)(t,u);e.FormType&&(this._propValue.telemetryParameters.FormType=e.FormType.toString()),this._propValue.telemetryParameters.FormId=u.guid}this._propValue.telemetryParameters.IsSLAEnabled=""}return this._propValue}}var it=r("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const at="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimerSelector";function ot(){const e={},t={},r={};return(i,a,o,s,c,l)=>{it.a.info(o.controlId+"."+at+": createGetTimerData started");let u,d=!1;u=o.formInfo&&o.formInfo.RecordId?new n.a(o.formInfo.RecordId):c.id,t.hasOwnProperty(i)&&t[i]&&!n.a.isNullOrEmpty(u)||(t[i]=new nt(i,o.controlId,function(e){if(e&&e.currentServerTime)return e.currentServerTime.serverTimeDiffInSeconds;return 0}(a)));const b=t[i],m=b.getTimerData(i,a,o,s,c,l);var p,h;return null!=m?r.hasOwnProperty(i)&&r[i]&&(p=m,h=r[i],p.timerControlId===h.timerControlId&&p.timerState===h.timerState&&p.timerParameterAttributeValues.FailureTimeFieldAttributeValue===h.timerParameterAttributeValues.FailureTimeFieldAttributeValue)||(d=!0):null!=r[i]&&(d=!0),d&&(r[i]=new $e(m),e[i]=b),it.a.info(o.controlId+"."+at+": createGetTimerData finished"),r[i]}}var st=r("izYK"),ct=r("Co7m");function lt(){const e={};return(t,r,n,i,a)=>{it.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+n.id+": createGetBusinessProcessFlowData started");if(!e[t]||ct.a.Instance.hasChanged(r,a,e[t].ProcessWrapper,n.id)){const r=ct.a.Instance.getBusinessProcessFlowWrapper(n.id,a);(!r||r.stages&&r.stages.length>0)&&(e[t]={ProcessWrapper:r,Type:st.a.BusinessProcessFlow})}return it.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlBusinessProcessSelector PageId."+n.id+": createGetBusinessProcessFlowData finished"),e[t]}}var ut=r("npAL"),dt=r("g03H");class bt{getComponentNameByControlId(e){throw new Error("Not initialized.")}getComponentPropsByControlId(e){throw new Error("Not initialized.")}addSessionTab(e,t){throw new Error("Not initialized.")}closeSessionTab(e,t){throw new Error("Not initialized.")}updateSessionTab(e,t){throw new Error("Not initialized")}closeAllSessionTabs(e){throw new Error("Not initialized.")}dismissMessage(e){throw new Error("Not initialized.")}cleanReferencePanelState(e){throw new Error("Not initialized.")}initializeReferencePanelControl(e,t){throw new Error("Not initialized.")}markActiveTab(e,t,r){throw new Error("Not initialized.")}}var mt=r("unFF"),pt=r("BJ7u"),ht=r("GYEz"),ft=r("eOoD"),gt=r("w1eR"),Ot=r("16wZ"),vt=r("P6DH"),yt=r("9fGf"),jt=r("5DN6"),Pt=r("BFlg"),It=r("NjDY");class Ct{constructor(){this.objectWrapperType=1,this._referencePanelQuickFormCollectionControl="b68b05f0-a46d-43f8-843b-917920af806a",this._quickFormComponentName="MscrmControls.Containers.QuickForm",this._quickForm_Type="Form.QuickForm",this._searchWidgetComponentName="MscrmControls.KbSearchControl.KbSearchControl",this._searchWidget_Type="SearchWidget.SearchWidget",this._searchWidget_ControlId="KbSearchControl|",this._subGridType="subgrid",this._enableIndex="EnableJumpBar",this._enableViewSelector="EnableViewPicker",this._enableQuickFind="EnableQuickFind",this._memoizedComponents={},this.previousReferencePanelParameter=null}retrieveReferencePanelObject(e,t,r,n){var a,o;this._pageId=t.id;const s=new i.a(r.entityTypeName,r.id),c=Object(et.b)(e,t.id),l=Object(d.h)(e,c),u=Object(mt.a)(e);let b,m=null,p="",h="";const f=Object(Y.rb)(e,this._pageId,n,c);f&&Object.keys(f).map(t=>{Object(Y.Sb)(e,t)&&(m=f[t],p=t)});const g=Object(jt.c)(e,t.id);if(h=this._isActiveTabHidden(e,t.id,c,g,n)?this._getNextVisibleControlId(e,t.id,c,n,g.controlNames):g.activeTabId,b=m&&m.Height?Number.parseInt(m.Height,10):10,b*=u.sizes.Section.cellHeightInRem,!this.previousReferencePanelParameter){const r=new bt;r.formDescriptor=Object.assign({},l),r.referencePanelSectionName=p,r.height=b,r.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,l,e,s,t,n),r.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,l,e);const i=Object(ht.a)(e),c=Object(ht.e)(e),u=[];return f&&(null==m?void 0:m.Name)&&(null===(o=null===(a=f[m.Name])||void 0===a?void 0:a.Rows)||void 0===o||o.forEach(r=>{var a;return null===(a=null==r?void 0:r.Cells)||void 0===a?void 0:a.forEach(r=>{const a=l.Controls[r.ControlName],o=Object(Y.E)(e,t.id,r.ControlName,n),s=Object(Y.v)(e,{id:t.id,controlName:r.ControlName},n);if((i!==gt.a.MobileApplication||Object(Ot.a)(a.Parameters.ShowOnMobileClient)||"true"===a.Parameters.ShowOnMobileClient)&&(c!==ft.a.Phone||Object(Ot.a)(r.AvailableForPhone)||r.AvailableForPhone)&&r.Visible){const e=this._cloneControlWithControlState(a,o,s);u.push(e)}})})),r.activeTabId=h,r.controls=u,r.pageId=this._pageId,r.addSessionTab=null,r.updateSessionTab=null,r.closeAllSessionTabs=null,r.closeSessionTab=null,r.dismissMessage=null,r.markActiveTab=null,r.initializeReferencePanelControl=null,r.cleanReferencePanelState=null,r.sessionTabs=[],this.previousReferencePanelParameter=r,this.previousReferencePanelParameter}if(g&&(this.previousReferencePanelParameter.activeTabId!==g.activeTabId||null!==this.previousReferencePanelParameter.messageId&&null===g.messageId||null===this.previousReferencePanelParameter.messageId&&null!==g.messageId||this.previousReferencePanelParameter.messageId&&g.messageId&&this.previousReferencePanelParameter.messageId!==g.messageId||this.previousReferencePanelParameter.pageId!==g.pageId||this._sessionTabsChanged(g)||this._staticTabsChanged(e,t.id,c,g)||this._quickViewFormChanged(l,e,s,g.activeTabId,t,n)||this._controlStateChanged(g,e,t.id,n))){const r=new bt;r.sessionTabs=g.sessionTabs.slice(),r.activeTabId=h,r.messageId=g.messageId;const i=g.controlNames&&g.controlNames.length?g.controlNames:this.previousReferencePanelParameter.controls.map(e=>e.Name);r.controls=i.map(r=>{const i=Object(d.a)(e,t.id,c,r),a=Object(Y.E)(e,t.id,r,n),o=Object(Y.v)(e,{id:t.id,controlName:r},n);return this._cloneControlWithControlState(i,a,o)}),r.formDescriptor=Object.assign({},l),r.height=b,r.pageId=g.pageId,r.referencePanelSectionName=p,r.addSessionTab=this.previousReferencePanelParameter.addSessionTab,r.updateSessionTab=this.previousReferencePanelParameter.updateSessionTab,r.closeAllSessionTabs=this.previousReferencePanelParameter.closeAllSessionTabs,r.closeSessionTab=this.previousReferencePanelParameter.closeSessionTab,r.dismissMessage=this.previousReferencePanelParameter.dismissMessage,r.markActiveTab=this.previousReferencePanelParameter.markActiveTab,r.initializeReferencePanelControl=this.previousReferencePanelParameter.initializeReferencePanelControl,r.cleanReferencePanelState=this.previousReferencePanelParameter.cleanReferencePanelState,this.previousReferencePanelParameter=r}return this.previousReferencePanelParameter.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,l,e),this.previousReferencePanelParameter.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,l,e,s,t,n),this.previousReferencePanelParameter}_controlStateChanged(e,t,r,n){if(!e||!e.controlNames||0===e.controlNames.length||!this.previousReferencePanelParameter)return!1;for(let i=0;i<e.controlNames.length;i++){const a=e.controlNames[i],o=Object(Y.E)(t,r,a,n),s=Object(Y.v)(t,{id:r,controlName:a},n);if(this.previousReferencePanelParameter.controls[i].Visible!==(null==o?void 0:o.visible)||this.previousReferencePanelParameter.controls[i].Label!==(null==o?void 0:o.label)||this.previousReferencePanelParameter.controls[i].Disabled!==s)return!0}return!1}_isActiveTabHidden(e,t,r,n,i){for(const a of n.controlNames){const o=Object(d.a)(e,t,r,a),s=Object(Y.I)(e,{id:t,controlName:a},i);if((null==o?void 0:o.Id)===n.activeTabId&&!0!==s)return!0}return!1}_getNextVisibleControlId(e,t,r,n,i){var a;if(!i||!i.length)return null;for(const o of i){if(Object(Y.I)(e,{id:t,controlName:o},n))return null===(a=Object(d.a)(e,t,r,o))||void 0===a?void 0:a.Id}return null}_staticTabsChanged(e,t,r,n){for(let i=0;i<n.controlNames.length;i++){const a=n.controlNames[i];if(Object(d.a)(e,t,r,a).Id!==this.previousReferencePanelParameter.controls[i].Id)return!0}return!1}_sessionTabsChanged(e){if(null!==this.previousReferencePanelParameter.sessionTabs&&null===e.sessionTabs||null===this.previousReferencePanelParameter.sessionTabs&&null!==e.sessionTabs||this.previousReferencePanelParameter.sessionTabs&&e.sessionTabs&&this.previousReferencePanelParameter.sessionTabs.length!==e.sessionTabs.length)return!0;for(let t=0;t<e.sessionTabs.length;t++)if(e.sessionTabs[t].id!==this.previousReferencePanelParameter.sessionTabs[t].id)return!0;return!1}_quickViewFormChanged(e,t,r,n,i,a){if(this._isQuickViewFormControl(e.Controls[n])){const s=Object(Y.hc)(t,i.id,a);return Object(o.j)(t,r,e.Controls[n].DataFieldName)!==Object(Ze.e)(t,s,r,e.Controls[n].DataFieldName)}return!1}_isQuickViewFormControl(e){return e&&e.ClassId&&e.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl}linkToParameter(e,t){const r=t.addSessionTab;e.addSessionTab=this.executeAddSessionTab.bind(this,r);const n=t.updateSessionTab;e.updateSessionTab=this.executeUpdateSessionTab.bind(this,n);const i=t.closeAllSessionTabs;e.closeAllSessionTabs=this.executeCloseAllSessionTabs.bind(this,i);const a=t.closeSessionTab;e.closeSessionTab=this.executeCloseSessionTab.bind(this,a);const o=t.dismissMessage;e.dismissMessage=this.executeDismissMessage.bind(this,o);const s=t.markActiveTab;e.markActiveTab=this.executeMarkActiveTab.bind(this,s);const c=t.initializeReferencePanelControl;e.initializeReferencePanelControl=this.executeInitializeReferencePanelControl.bind(this,c);const l=t.cleanReferencePanelState;e.cleanReferencePanelState=this.executeCleanReferencePanelState.bind(this,l)}executeAddSessionTab(e,t){e(t,this._pageId)}executeUpdateSessionTab(e,t){e(t,this._pageId)}executeInitializeReferencePanelControl(e,t){e(t,this._pageId)}executeCloseSessionTab(e,t){e(t,this._pageId)}executeCloseAllSessionTabs(e){e(this._pageId)}executeDismissMessage(e){e(this._pageId)}executeCleanReferencePanelState(e){e(this._pageId)}executeMarkActiveTab(e,t,r){e(t,r,this._pageId)}getComponentNameByControlId(e,t,r){const n=e.Controls[r];if(!St(e,r))return n.UniqueId;if(n.ClassId&&n.ClassId.guid.toString()===this._referencePanelQuickFormCollectionControl)return this._quickFormComponentName;const i=Tt(e,t,r);return Object(dt.B)(i)}getComponentPropsByControlId(e,t,r,n,i,a,o=!1){var s;it.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId started"),this._memoizedComponents[a]||(this._memoizedComponents[a]={controlId:a});const c=this._memoizedComponents[a];let l;const u=e.Controls[a],b=wt(t,e,u);if(St(e,a)||o||!e.ControlConfigurations[u.UniqueId].CustomControls[0]||b)if(a&&!u)if(a.indexOf(this._searchWidget_ControlId)>=0)l={FormFactor:2,CustomControlId:this._searchWidgetComponentName,Name:a.replace(this._searchWidget_ControlId,""),DisplayNameKey:a.replace(this._searchWidget_ControlId,""),Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._searchWidget_Type}},ShouldOverrideControlVisible:!1};else{const e=a.split("|")[0],r=Object(pt.a)(6),n=Object(d.f)(t,e,r);l={FormFactor:2,CustomControlId:this._quickFormComponentName,Name:a,DisplayNameKey:a,Version:"1.0.0",Parameters:{value:{Static:!1,Type:this._quickForm_Type,Value:n.guid+":quick|"+a}},ShouldOverrideControlVisible:!1}}else l=Tt(e,t,a);else l=e.ControlConfigurations[u.UniqueId].CustomControls[0];if(this._isQuickViewFormControl(u)){const e=Object(Y.hc)(t,n.id,i),a=Object(Ze.e)(t,e,r,u.DataFieldName),o="entityname";if(a&&a.validationResult&&a.validationResult.isValueValid){const e=(new DOMParser).parseFromString(u.Parameters[0].Value,"text/xml").getElementsByTagName("QuickFormId");for(let t=0;t<e.length;t++)if(e[t].attributes[o]&&e[t].attributes[o].nodeValue===(null===(s=a.reference)||void 0===s?void 0:s.etn)){l.Parameters.value.Value=e[t].textContent+"|"+u.DataFieldName;break}}}const m={configuration:l,descriptor:u};return(u&&u.ClassId&&"02d4264b-47e2-4b4c-aa95-f439f3f4d458"===u.ClassId.guid.toString()||b)&&this._updateConfigurationForSubGridControl(m),c.componentProps&&m.configuration===c.componentProps.configuration&&m.descriptor===c.componentProps.descriptor||(c.componentProps=m),it.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: getComponentPropsByControlId finished"),c.componentProps}_updateConfigurationForSubGridControl(e){const t=e.configuration.Parameters.hasOwnProperty(Pt.l)?Pt.l:Pt.m,r={DataSetUIOptions:{displayCommandBar:!0,displayIndex:e.descriptor.Parameters[this._enableIndex],displayQuickFind:e.descriptor.Parameters[this._enableQuickFind],displayViewSelector:e.descriptor.Parameters[this._enableViewSelector]}};Object.assign(e.configuration.Parameters[t],r),e.decorators=Object.assign(Object.assign({},e.decorators),{referencePanel:{isInReferencePanel:!0}}),e.contextString=this._subGridType}_cloneControlWithControlState(e,t,r){return Object.assign(Object.assign({},e),{Label:null==t?void 0:t.label,Visible:null==t?void 0:t.visible,Disabled:r})}getLatestData(){return this.previousReferencePanelParameter}}function St(e,t){const r=e.Controls[t];return!r||!r.UniqueId||!e.ControlConfigurations[r.UniqueId]}function wt(e,t,r){return t&&t.ControlConfigurations&&r&&r.UniqueId&&t.ControlConfigurations[r.UniqueId]&&t.ControlConfigurations[r.UniqueId].CustomControls&&Object(vt.Bb)(e,t.ControlConfigurations[r.UniqueId].CustomControls[0],Object(yt.b)(e))}function Tt(e,t,r){it.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration started");const i=e.Controls[r],a=e.EntityLogicalName,o=Object(Ie.b)(t,a,i),s=wt(t,e,i)?"02d4264b-47e2-4b4c-aa95-f439f3f4d458":i.ClassId&&n.a.toString(i.ClassId);it.a.info("CustomControlFramework.Models.Wrapper.ReferencePanelObjectWrapper: _getDefaultControlConfiguration finished");const{pcfDatasetGridEnabled:c}=Object(It.D)(t);return Object(dt.s)(i.Id,i.DataFieldName,o,i,a,s,c)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ft(){it.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData started");const e={},t={},r={};return(n,i,a,o,s,c)=>{let l=!1;t.hasOwnProperty(n)&&t[n]||(t[n]=new Ct);const u=t[n],d=u.retrieveReferencePanelObject(i,a,s,c);return r.hasOwnProperty(n)&&r[n]&&d===r[n]||(l=!0),l&&(r[n]=d,e[n]=u),it.a.info("CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlReferencePanelSelector: createGetReferencePanelData finished"),e[n]}}var Nt=r("p8cR"),Rt=r("IqkD"),_t=r("QiMq"),Et=r("mHvI"),Dt=r("Exmh"),kt=r("nJrx"),Vt=r("K7RF"),At=r("hAdb"),xt=r("4gfk");var Bt=r("TYIz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Wt(e,t,r){return{type:"tab.expandinitial.sync",sync:!0,execute({dispatch:n}){n(Lt(t,r)),n({type:Bt.a,payload:!1,meta:{pageId:t,contextKey:Object(y.w)(r),tabId:e}})}}}function Lt(e,t){return{type:"tab.collapseinitial.sync",sync:!0,execute({dispatch:r,getState:n}){var i,a;const o=n(),s=Object(K.a)(o,e),c=Object(y.w)(t),l=null===(a=null===(i=null==s?void 0:s.forms)||void 0===i?void 0:i[c])||void 0===a?void 0:a.tabs;if(l)for(const t in l)if(!l[t].collapsed){r({type:Bt.a,payload:!0,meta:{pageId:e,contextKey:c,tabId:t}});break}}}}var Ut=r("SDQ8");var Mt=r("5zU4"),zt=r("tT9w"),Ht=r("gQ5I"),Qt=r("gDO8"),qt=r("wL2W"),Gt=r("7yvg"),Kt=r("Tz6o"),Yt=r("lq82"),Zt=r("5UJb"),Jt=r.n(Zt),Xt=r("09am"),$t=r("sZ+8");var er=r("6lVV"),tr=r("e3W2"),rr=r("Zpd/"),nr=r("vlcQ"),ir=r("mhYf"),ar=r("4U8P"),or=r("nIfK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const sr=new Set([Pe.E.guid,Pe.qb.guid,Pe.ab.guid,Pe.ub.guid,Pe.vb.guid,Pe.C.guid,Pe.h.guid]);function cr(e,t){return{type:"hideControls.BulkEditForm.sync",sync:!0,execute({dispatch:r,getState:n},i){var a;if(!Object(Y.Hb)(n(),e))return;r(Object(ar.b)(e,t,!1));const o=Object(Y.hb)(n(),e,t),s=Object(et.b)(n(),e),c=Object(g.j)(n(),e),l=null==c?void 0:c.entityTypeName;if(!l)return;const u={},b=Object(d.h)(n(),s),m=Object(yt.b)(n()),p=[];for(const i in o){const c=o[i];if(!c)continue;let p,h=!1;(null==c?void 0:c.dataFieldName)&&Object(Y.hd)(n(),l,c.dataFieldName)&&(r(Object(rr.b)(e,i,t,!0)),h=!0,p="File or image controls are not supported on the bulk edit form.");if(!Object(Y.I)(n(),{id:e,controlName:i},t))continue;const f=Object(d.a)(n(),e,s,i);if(!h&&Object(or.f)(n(),b,f)){const e=Object(Ce.a)(f,b,m);h=(null==e?void 0:e.Parameters)&&Object(vt.yb)(e.Parameters),p=h&&"Editable grids are hidden on the bulk edit form."}if(!h&&(null===(a=null==f?void 0:f.ClassId)||void 0===a?void 0:a.guid)&&sr.has(f.ClassId.guid)){h=!0;p=Object(Pe.F)(f.ClassId)+" controls are hidden on the bulk edit form."}h&&(u[i]=p,r(Object(tr.c)(e,i,t,!1,p+" This is by design.")))}p.push({name:"bulkEditHiddenControls",value:JSON.stringify(u)}),i.EventManager.ReportComponentSuccess("Forms.BulkEdit.HiddenControls",p),function(e,t,r,n,i){const a=Object(Y.rb)(e(),r,i,n),o=a&&Object.keys(a),s=null==o?void 0:o.filter(t=>Object(Y.Sb)(e(),t));if(null==s?void 0:s.length)for(const e of s)t(Object(nr.c)(r,i,e,!1,"Reference Panel is not supported on bulk edit form. This is by design."))}(n,r,e,s,t),function(e,t,r,n,i){var a;const o=Object(d.h)(e(),n),s=Object(Y.hb)(e(),r,i);if(!(null==o?void 0:o.Controls)||!s||!(null===(a=Object.keys(s))||void 0===a?void 0:a.length))return;for(const a in s){const s=o.Controls[a];Object(Ce.c)(e(),s.UniqueId,n)===Se.c&&t(Object(tr.c)(r,a,i,!1,"Form Component is not supported on bulk edit form. This is by design."))}}(n,r,e,s,t),function(e,t,r,n,i){var a;const o=Object(Y.sb)(e(),n,r);if(!(null==o?void 0:o.length))return;for(const s of o){if(!(null===(a=null==s?void 0:s.Columns)||void 0===a?void 0:a.length))continue;const o=s.Columns.find(t=>{var n;return(null===(n=null==t?void 0:t.SectionNames)||void 0===n?void 0:n.length)&&t.SectionNames.find(t=>Object(Y.Bc)(e(),{id:r,sectionName:t},i))}),c=Object(Y.J)(e(),r,n,s.Id,i),l=c&&Object.keys(c),u=(null==l?void 0:l.length)&&l.find(t=>Object(Y.I)(e(),{id:r,controlName:t},i));if(!o||!u){const e=`This tab is hidden on the bulk edit form because ${o?"no sections on the tab are visible":"no controls on the tab are visible"}. You may also look into ${nr.a} and ${tr.a} Operations for additional information. This is by design.`;t(Object(ir.b)(r,s.Id,i,!1,e))}}}(n,r,e,s,t)}}}var lr=r("95Ij"),ur=r("FZDd"),dr=r("v+zG"),br=r("RIoc"),mr=r("0HUS");function pr(e){const t=[];return f=>({type:"initialize.editFormAction.async",execute({dispatch:O,getState:j},C,S){const w=j(),T=Object(Y.Ob)(w,e),F=Object(ae.a)(w,e),N=C.TraceManager.getTracer(Object(Y.V)(T,"initializeAction")),R=Object(Y.U)(T,"initializeAction");!function(e){Object(Nt.b)(ot,st.a.Timer),Object(Nt.b)(lt,st.a.BusinessProcessFlow),Object(Nt.b)(Object(ut.a)(e),st.a.SearchWidget,st.a.ReferencePanelSearchWidget),Object(Nt.b)(Ft,st.a.ReferencePanel),Object(Nt.b)(he.a,st.a.PowerBI),Object(Nt.b)(br.a,...mr.c)}(O),function(e,t,r){if(!r){const r=function(e){return(t,r)=>(Object(Ut.b)(e),Promise.resolve())}(e);t.Router.registerPreCloseHandler(e,r)}}(e,C,F);const _=Object(g.j)(j(),e);let E=_.formId;const D=n.a.toString(E),k=_.entityTypeName,V=_.id,A=Object(Y.Hb)(w,e),B=Object(Y.kd)(j(),e),W=n.a.toString(V),L=_.selectedRelatedEntity,U=re.g+k;let z=_.selectedTabId;!function(e,t,r,n,i){if(e||t)return;const a="form.recordSetQueryKey";if(r.recordSetQueryKey)n(Object(Yt.b)(a,{queryKey:r.recordSetQueryKey,entityTypeName:r.entityTypeName}));else{const e=n(Object(Yt.a)(a));(null==e?void 0:e.queryKey)&&e.entityTypeName===r.entityTypeName&&null!=r.id&&n(Object(Kt.d)(Object.assign(Object.assign({},r),{recordSetQueryKey:e.queryKey}),i))}}(T,F,_,O,e);const H=new i.a(k,V);let Q,q,G,K,Z,ee;t.push({name:"CorrelationId",value:S.correlationId},{name:"ContextId",value:S.contextId},{name:"ActionStack",value:S.stack},{name:"InitialFormId",value:D},{name:"EntityName",value:k},{name:"entityId",value:W},{name:"PageId",value:e},{name:"IsMainFormDialog",value:T.toString()},{name:"isBulkEditForm",value:A}),N.info("Executing edit form initialize action.",t);const fe=Object(y.j)(j(),e);t.push({name:"ContextToken",value:JSON.stringify(fe)}),O(Object(We.b)(fe,e,_.entityTypeName,V));const Pe=function(e,t,r,i,a){if(r&&r.error)return Promise.reject(r.error);if(r&&!0===r.noFormsFound)return Promise.reject(2200000017);const o=r&&r.updatedFormId;if(!o||n.a.equals(o,n.a.EMPTY)){const e="Form descriptor is null or not defined";throw t.error(e,a),new je.a(e)}return e(Object(pe.c)(o,i)).then(()=>o)}(O,N,f,k,t),Ie=Object(Et.a)(w,e),we=O(Object(b.e)(Ie)).then(()=>{t.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),N.info("Got resource strings",t)}),Te=F?Promise.resolve():O(Object(ne.a)(U,e)),Fe=Object(ye.f)(j());return Pe.then(r=>{r!==E&&t.push({name:"FormId",value:n.a.toString(r)});const b=Object(s.e)(j,O,N,S,V,k,e);if(E=r,H.id===n.a.EMPTY&&O(Object(He.b)(H)),_.selectedTabName&&!z){const t=Object(Y.o)(j(),Object(d.h)(j(),E),e);for(const e of t)if(e.Name===_.selectedTabName){z=e.Id;break}}const f=Object(Y.Q)(j(),E,e),R=z||(L?L.id:f);O(Object(_t.b)(e,R)),R&&(!function(e,t,r,n,i,a){const o=Object(Y.gb)(e(),r,n,!1,(e,t)=>Object(Y.J)(e,r,t,i,a)),s=Object(d.h)(e(),n);let c=null;for(const t in s.Controls){const r=s.Controls[t];if(Object(Ce.c)(e(),r.UniqueId,n)===Se.c){c={[t]:r};break}}const l=Object(Y.nc)(e(),n,i).map(t=>Object(Y.gb)(e(),r,t));l.push(o),c&&l.push(Object(Y.gb)(e(),r,n,!1,()=>c));const u=l.reduce((e,t)=>{for(const r in t)e[r]=t[r];return e},{}),b=[];for(const e in u)b.push(t(Object(xe.a)(u[e])));Promise.all(b)}(j,O,e,E,R,fe),Object(de.b)(j(),e,E,H,k,R,fe,!1)),q=Object(c.a)(j(),k);const D=Object(d.h)(j(),E);K=Object(pe.d)(O,D.InlineQuickForms,w,C);const W=O(Object(a.g)(D.FormLibraries));return b.then(()=>we.then(()=>(function(e,t,r,i){var a;if(!e||!r||!r.Controls)return;if(!(Object(At.e)(e,xt.a)||e.clientHost&&e.clientHost.subtype===ft.a.Phone))return;if(Object(ae.a)(e,i))return;const o=r.Controls.notescontrol;if(!o||!o.ParentSectionName)return;const s=null===(a=o.Parameters)||void 0===a?void 0:a.UClientShowOnNewTabForMobile;if("false"===s||Object(x.f)(e,J.kf)&&(!s||"default"===s))return;const c=r.Tabs[0];let l;const u=c.Columns.findIndex(e=>(l=e.SectionNames.indexOf(o.ParentSectionName),l>-1));if(u<0)return;const d=c.Columns[u],b=Object.assign(Object.assign({},d),{SectionNames:[o.ParentSectionName]});d.SectionNames.length>1?d.SectionNames.splice(l,1):c.Columns.splice(u,1);const m=Object.assign({},r);m.Tabs.push(Object.assign(Object.assign({},c),{Id:"tab_"+n.a.newGuid().guid,Name:"TIMELINEWALL_TAB_SYSTEM_GENERATED",Label:Object(Le.b)(e,"L_InteractionWall_Title"),Columns:[b],DomId:Object(kt.a)(),LabelId:null})),m.TabNames.splice(1,0,"TIMELINEWALL_TAB_SYSTEM_GENERATED");const p={};p[n.a.toString(m.Id)]=m;const h={forms:p};t({type:Vt.a,payload:h})}(j(),O,D,e),O(Object(s.i)(E,e,fe,Fe)).then(()=>{G=O(Object(ue.b)(_.entityTypeName,E)).then(t=>O(Object(ue.c)(e,fe,t))),N.info("initializeForm promise resolved successfully."),O(Object(m.b)(e,p.a.MetadataRetrieved))}))).catch(e=>{t.push({name:"loadResourceStringsBeforeInitializeForm.reason",value:Object(Ke.f)(e)}),N.error("Could not load resource strings prior to InitializeForm",t),Object(je.b)(e)})).then(()=>{const r=fr(_,e,j,O,N,t),b=Object(Gt.a)(j(),n.a.tryParse(null==_?void 0:_.processId),null==H?void 0:H.etn);b&&q.push(...b);const G=r.then(()=>function(e,t,r,o,s,c,l,u){const d=Object(ae.a)(e,r)?null:function(e,t){const r=n.a.tryParseOrNull(e.processId),a=n.a.tryParseOrNull(e.processInstanceId);if(t&&t.etn&&t.id&&r&&a){const e=i.a.toLegacyEntityReference(new i.a("businessprocessflowinstance",r)),n=i.a.toLegacyEntityReference(new i.a("businessprocessflowinstance",a));return new Dt.a(i.a.toLegacyEntityReference(t),e,n)}return new Dt.a(i.a.toLegacyEntityReference(t),null,null)}(l,s);return t(Object(a.f)(s,c,d,u,!0)).then(()=>{ge.a.createEvent("DataLoaded",me.j).createMarker()}).catch(e=>{const t=[{name:"retrieveRecordDataForForm.Reason",value:Object(Ke.f)(e)}];Object(Ae.a)(e,t),o.error("Error while executing retrieveRecordDataForForm promise defined in loadRecordData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",t),Object(je.b)(e)})}(j(),O,e,N,H,E,_,q)),K=_&&_.data&&_.data[te.t],re=(A?Promise.resolve():Object(s.d)(j(),O,k,e,C,S,K)).then(()=>F||Object(Y.p)(w)||A?Promise.resolve():X(j,O,N,e,fe,H,n.a.tryParse(_.processId),S,C,G,_)),ne=Object(qe.d)(j(),e,E,fe,R,!1,!1,B);Z=Object(Qe.a)(j,O,N,C.EventManager,e,D,V,ne).inProgress,Promise.all([G,...Z]).then(be.d),ee=Promise.all([r,...Z]);const oe=C.ScriptManager.initializeContainerForClientApi(e,!Object(ae.a)(j(),e));return function(e,t,r,n,i,a){if(t)e(Object(ie.b)(r,a,t)),e(Wt(t,r,a));else if(n){const{id:t,title:i,entityName:o,relationshipName:s,ordinal:c}=n,l=Object(y.a)(a,s,c),u={id:t,title:i,entityName:o,isSelected:!0,relationshipName:s};e(Object(Ve.a)(r,l,u)),e(Lt(r,a))}else i&&(e(Object(ie.b)(r,a,i)),e(Wt(i,r,a)))}(O,z,e,L,f,fe),oe.then(()=>function(e,t,r,n,i,a,o,c){return i.info("createXrmForm promise resolved successfully."),Object(s.k)(e,t,r,n,a,o,i,c).then(()=>{i.info("loadScripts promise defined in loadScriptsAfterClientApi() function resolved successfully.",c)}).catch(e=>{c.push({name:"loadScripts.reason",value:Object(Ke.f)(e)}),i.error("Error while executing loadScripts promise defined in loadScriptsAfterClientApi() function.",c)})}(j(),C,O,fe,N,E,e,t).then(()=>G.then(()=>{N.info("loadRecordData promise resolved successfully."),function(e,t,r,a){if(r.id===n.a.EMPTY)return;const s=Object(M.h)(e,r.etn),c=Object(Y.lc)(e,r.etn,r.id);if(!c){const t=[];if(t.push({name:"title",value:""+c}),t.push({name:"identifier.etn",value:r.etn}),t.push({name:"identifier.id",value:n.a.toString(r.id)}),s){const n=new i.a(r.etn,r.id),a=Object(o.j)(e,n,s.PrimaryNameAttribute);t.push({name:"entityDetails.PrimaryNameAttribute",value:s.PrimaryNameAttribute}),t.push({name:"nonFormattedPrimaryNameAttributeValue has value",value:!!a})}else t.push({name:"entityDetails",value:""+s});a.EventManager.ReportComponentFailure("MRU.EditForm.InitializeAction",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why Title is empty.",t)}const l={RecordType:le.a.Entity,EntityTypeName:r.etn,LastAccessed:new Date,ObjectId:r.id,Title:c,IconPath:Object(M.j)(e,r.etn,r.id),HasPrimaryImageField:s&&!!s.PrimaryImageAttribute};t(Object(ce.b)(l))}(j(),O,H,C);const r=hr(j,_,e,fe,O);if(O(Object(dr.a)(e,fe,H)),Q=function(e,t,r,i,s,l,u,b,m,p){const h=[],f=Object(Y.mc)(e,i,s),g=Object(Y.nc)(e,u,b);for(const u in f){const b=Object(Y.E)(e,i,u,s),O=b?b.dataFieldName:null,v=Object(o.j)(e,l,O);if(v){const o=v.reference;if(!o)break;const l=f[u][o.etn];if(!n.a.isNullOrEmpty(l)){const n=g.indexOf(l)>=0;if(n){const n=Object(M.h)(e,o.etn),i=[];n&&!!n.PrimaryImageAttribute&&i.push(Object(ve.a)(n.PrimaryImageAttribute,null,null));const s=Object(c.b)(e,o.etn);(null==s?void 0:s.length)&&i.push(...s);const u=t(Object(a.f)(o,l,null,i,!0)).catch(e=>{const t=o.id?o.id.guid:"Invalid associated recordId.";m.push({name:"retrieveRecordDataForForm.Reason",value:Object(Ke.f)(e)},{name:"associatedRecordId",value:t},{name:"entityRef.etn",value:o.etn}),r.error("Error while executing dataPromise promise by calling loadQuickFormsData() function. Check EventContext for retrieveRecordDataForForm.Reason to see which catch block this error occurred.",m),Object(je.b)(e)});h.push(u)}if(Object(Be.c)(e)){const a=Object(qe.j)(e,i,[l],s,n);if(o.id&&a&&Object.keys(a).length>0){const n=Object(d.h)(e,l),s=Object(Qe.a)(()=>e,t,r,p.EventManager,i,n,o.id,a).inProgress;h.push(...s)}}}}}return Promise.all(h).then(()=>{h.length<=0&&r.warn("No dataPromises within EditForm while calling loadQuickFormsData() function.",m)}).catch(e=>{m.push({name:"Promise.all.Reason",value:Object(Ke.f)(e)}),r.error("Error with dataPromises in EditForm while calling loadQuickFormsData() function. Check EventContext for Promise.all.Reason to see which catch block this error occurred.",m)})}(j(),O,N,e,fe,H,E,R,t,C),O(Object(h.a)(e,fe)),B){const r=Object(d.h)(j(),E),n=[te.s,te.x,te.y,te.z].concat(r.Attributes);Object(s.c)(j(),O,k,e,n,r.Attributes,fe,N,t)}return re.then(()=>{if(Object(x.f)(j(),J.pb)&&O(Object(Ye.c)(k,e,fe)),B){const r=Object(d.h)(j(),E),n=Object(o.e)(j(),H),i=Object(v.c)(j(),n,H),a=new Set(r.Attributes);let c;i&&(c=i.filter(e=>!a.has(e))),c&&Object(s.c)(j(),O,k,e,c,r.Attributes,fe,N,t)}return W.then(()=>{O(Object(m.b)(e,p.a.OnLoadReady)),A&&O(cr(e,fe));const a=Jt.a.trackWork("runFormOnload");return Object(s.l)(j(),C,O,fe,e,N,t).then(()=>{if(B){C.ScriptManager.getContainer(e).getEventManager().addOnProcessChangeEvent(fe,()=>{!F&&O(function(e){return{type:"Forms.EditForm.InjectBPFFields",sync:!0,execute({dispatch:t,getState:r},n,a){const s=r(),c=Object(g.j)(s,e);if(c){const a=c.id,l=new i.a(c.entityTypeName,a),u=Object(y.j)(s,e);if(Object(o.e)(s,l)){const i=n.TraceManager.getTracer("initializeNewBpf.editFormAction.async");return $(l,u,e,t,r,i)}}}}}(e)),O(Object(Ye.c)(k,e,fe))})}O(Object(l.a)(!0,e,fe)),!A&&!F&&!Object(Y.s)(w)&&O(Object(u.a)(U,e,e,fe)),ge.a.createEvent(de.a,me.j).createMarker(),O(Object(m.b)(e,p.a.EditReady)),P.a.addCommonKpiParameters({[I.b.FormId]:n.a.toString(E),[I.b.FormParameters.PageId]:e,[I.b.FormParameters.IsMainFormDialog]:T.toString()}),r.then(t=>{if(!t){const t=Object(ve.c)(e,k,j(),fe);t&&O(Object(Oe.c)(e,t))}})}).catch(e=>{t.push({name:"runFormOnLoadScripts.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)}).finally(()=>{a()})}).catch(e=>{t.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)})}).catch(e=>{t.push({name:"loadBusinessProcessFlow.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)})}).catch(e=>{t.push({name:"loadRecordData.Reason",value:Object(Ke.f)(e)}),N.error("Error while executing loadRecordData promise. Check EventContext for retrieveRecordDataForOrganization.Reason, loadBusinessProcessFlow.Reason and loadRecordData.Reason to see which catch block this error occurred.",t),Object(je.b)(e)})).catch(e=>{t.push({name:"loadScriptsAfterClientApi.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)})).catch(e=>{t.push({name:"initializeContainer.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)})}).catch(e=>{const r=e;r&&r.getNegativeErrorCode&&-2147220969===r.getNegativeErrorCode()&&O(Object(De.c)(V,Object(Be.c)(j()))),t.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(Ke.f)(e)}),Object(je.b)(e)})}).then(()=>Promise.all([we,Te,Q,G,K]).then(()=>{!function(e,t,r,n){const i=Object(g.j)(e,r);Object(Y.nb)(e,{id:r},t)&&i.isOfflineSyncError&&(n(Object(Me.b)(t,r,ze.d)),n(Object(oe.c)(t,r,Object(Le.b)(e,Ue.h),se.a.error,"osn_"+(new Date).getMilliseconds())))}(j(),fe,e,O)})).then(()=>{Ee(j(),e,fe,E,k,H,_,t),C.EventManager.ReportComponentSuccess(R,t),O(Object(m.b)(e,p.a.FullLoad)),_.forceOfflineDataSync&&ee.then(()=>{Object(Kt.d)(Object.assign(Object.assign({},_),{forceOfflineDataSync:void 0}),e)}),Object(Mt.b)(j,N,t,e,fe,H,Object(d.h)(w,E)),A&&O(Object(lr.e)(e,fe)),function(e,t,n,i){Object(qt.a)()&&(r.e(83).then(r.bind(null,"QKPk")).then(r=>{e(r.runRelatedMenuChecker(t))}),r.e(82).then(r.bind(null,"XVSa")).then(r=>{e(r.runControlStateChecker(t,n,i.etn))}),r.e(161).then(r.bind(null,"NErG")).then(r=>{e(r.runBpfChecker(t,n,i))}),r.e(162).then(r.bind(null,"phLR")).then(t=>{e(t.runControlDefaultValueChecker())}))}(O,e,fe,H),function(e,t,r,n,i){const a=Object(d.h)(e,t);if(null==a?void 0:a.Footer){const t=Object(s.h)(a.Footer);Object(qt.a)()&&Object(Ne.b)(e)&&t.length>0&&i(Object(oe.c)(r,n,Object(Le.b)(e,Ue.c),se.a.warning,ze.a))}}(j(),E,fe,e,O),Promise.all(Z).catch(()=>{N.warn("Executing edit form initialize action : controlPromises.",t)})}).catch(async r=>{if(Ee(j(),e,fe,E,k,H,_,t),2200000017===r){const t=await async function(e,t,r,n){await e(Object(ur.f)(n,!1,[]));const i=Object(M.h)(r(),n),a=i&&!i.IsCustomEntity&&!1===i.CanCreateForms;return Object(Ae.b)(r(),t,a?2200000019:2200000017)}(O,e,j,k);O(Object(zt.b)(t,!0,e)).then(()=>{O(Object(Ht.e)(e,"dismiss"))})}else O(Object(Qt.b)(e,Object(je.c)(r))),Object(Ae.h)(j(),e,r,t,C,R),Object(je.b)(r)})},getFailureParameters:e=>(Object(Ae.a)(e,t),t)})}function hr(e,t,r,n,i){let a=[];const o=Object(ke.f)()(e(),{id:r,isFromInitializeAction:!0});if(o){let s=null,c=null;o.forEach(e=>{if(e&&e.relatedItems&&(a=a.concat(e.relatedItems),t.id&&t.navItemId))for(const r of e.relatedItems)if(r.id.toLowerCase()===t.navItemId.toLowerCase()){c={id:r.id,title:r.title,isSelected:!0,entityName:r.entityName,relationshipName:r.relationshipName},s=Object(y.a)(n,r.relationshipName,r.ordinal);break}});const l=Object(Rt.x)(e()),u=l?l.languageId:null;if(i(Object(Ge.b)(r,a,u)),c&&s)return i(Object(Bt.b)(r,void 0,n)),i(Object(Ve.a)(r,s,c)).then(a=>{if(t.bodyOnly){const o=Object(ve.b)(r,t.entityTypeName,e(),a,n);if(o)return i(Object(Oe.c)(r,o)),!0}})}return Promise.resolve(!1)}async function fr(e,t,r,a,o,s){if(null==s||s.push({name:"forceOfflineDataSync",value:e.forceOfflineDataSync}),e.forceOfflineDataSync&&!Object(ae.a)(r(),t)){o.info("Calling initiateOfflineDataSync for "+e.entityTypeName);const s=(await
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function e(t,r,a,o,s){var c,l,u,b,m,p;const h=new Set,f=Object(d.h)(t(),o);if(!f)return Promise.resolve([]);const g=[],O=f.EntityLogicalName;h.add(O);for(const o in f.Controls){const d=f.Controls[o];if((null===(c=null==d?void 0:d.Parameters)||void 0===c?void 0:c.TargetEntityType)&&h.add(d.Parameters.TargetEntityType),null==d?void 0:d.DataFieldName){const e=Object(w.a)(t(),O,null==d?void 0:d.DataFieldName);(null==e?void 0:e.Targets)&&e.Targets.forEach(e=>e&&h.add(e))}if(Object(Ce.c)(t(),d.UniqueId,f.Id)===Se.c){const o=Object(Ce.b)(t(),d.UniqueId,f.Id),c=Object(yt.b)(t()),p=null===(m=null===(b=null===(u=null===(l=null==o?void 0:o.CustomControls)||void 0===l?void 0:l[c])||void 0===u?void 0:u.Parameters)||void 0===b?void 0:b.QuickForms)||void 0===m?void 0:m.Value;if(p){const o=Object(Xt.a)(p);for(const c in o)if(Object($t.n)(t(),c)){const l=n.a.tryParseOrNull(o[c]);h.add(c),g.push(r(Object(A.d)(new i.a(c),l)).then(()=>r(Object(pe.c)(l,c))).then(()=>{e(t,r,a,l,s).then(e=>e.forEach(e=>e&&h.add(e)))}).catch(()=>(a.error("Error retrieving form components for offline sync"),null)))}}}}if(f.InlineQuickForms)for(const n in f.InlineQuickForms){const i=f.InlineQuickForms[n];for(const n in i){const o=i[n];h.add(n),e(t,r,a,o,s).then(e=>e.forEach(e=>e&&h.add(e)))}}const v=null!==(p=Object(ke.f)()(t(),{id:s}))&&void 0!==p?p:[];for(const e of v)for(const t of e.relatedItems)t.entityName&&h.add(t.entityName);return Promise.allSettled(g).then(()=>Array.from(h).sort())}(r,a,o,Object(et.b)(r(),t),t)).filter(e=>Object($t.n)(r(),e)),c="initiateOfflineEntitySync"+t;return a(Object(er.e)(s,c))}}},MoY7:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("aF78"),i=r("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function o(){return(e,t,r,o,s)=>{i.a.info(r.controlId+"."+a+": createGetPowerBIData started");const c=new n.a(e);return c.retrievePowerBIObject(t,r,o,s),i.a.info(r.controlId+"."+a+": createGetPowerBIData finished"),c}}},RIoc:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("5ZBI"),i=r("aF78"),a=r("aRLb"),o=r("h34H");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e){this.pbi_UniqueName=e}getMetadata(){return{boundParameter:null,parameterTypes:{pbi_UniqueName:{typeName:"Edm.String",structuralProperty:1}},operationName:"pbi_RetrieveReportEmbeddingDetails",operationType:1}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function c(e,t){var r,n,i;return null!==(i=null===(n=null===(r=e.powerbi)||void 0===r?void 0:r.reports)||void 0===n?void 0:n[t])&&void 0!==i?i:null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function l(e){return{type:o.b,sync:!1,async execute({dispatch:t,getState:r}){if(c(r(),e))return;const n=new s(e),i=await t(Object(a.b)(n)),l=await i.json(),u={Id:l.pbi_Id,ReportEmbedUrl:l.pbi_ReportEmbedUrl,ReportName:l.pbi_ReportName,ReportObjectId:l.pbi_ReportObjectId,ReportWebUrl:l.pbi_ReportWebUrl,WorkspaceObjectId:l.pbi_WorkspaceObjectId};return t(function(e,t){return{type:o.c,payload:Object.assign({},t),meta:{[o.a]:e}}}(e,u)),u}}}var u=r("sjKS"),d=r("0HUS");class b{constructor(e,t){this.objectWrapperType=6,this._retrievalStatus="uninitialized",this._uniqueName=e,this._type=t,this._initializePreviousReturnWithEmptyData()}async _fetchPowerBISolutionComponentMetadata(){this._retrievalStatus="fetching";try{const{dispatch:e}=Object(u.a)();switch(this._type){case d.b:await e(l(this._uniqueName))}this._retrievalStatus="fetched"}catch(e){this._retrievalStatus="error",n.a.error("PowerBISolutionComponentObjectWrapperEvent._fetchPowerBISolutionComponentMetadata",[{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"uniqueName",value:this._uniqueName},{name:"type",value:this._type}])}}retrievePowerBISolutionComponentObject(e,t,r){const n=this._getCachedPowerBISolutionComponentComponentMetadata(e);return n?this._previousReturnNeedsUpdate(n)&&this._updatePreviousReturn(e,n,null==t?void 0:t.id,r):"uninitialized"===this._retrievalStatus&&this._fetchPowerBISolutionComponentMetadata(),this._previousReturn}getLatestData(){return this._previousReturn}_previousReturnNeedsUpdate(e){switch(this._type){case d.b:const t=e;return this._previousReturn.Id!==(null==t?void 0:t.Id)||this._previousReturn.ReportEmbedUrl!==(null==t?void 0:t.ReportEmbedUrl)||this._previousReturn.ReportName!==(null==t?void 0:t.ReportName)||this._previousReturn.ReportObjectId!==(null==t?void 0:t.ReportObjectId)||this._previousReturn.ReportWebUrl!==(null==t?void 0:t.ReportWebUrl);default:return!1}}_getCachedPowerBISolutionComponentComponentMetadata(e){switch(this._type){case d.b:return c(e,this._uniqueName);default:return null}}_initializePreviousReturnWithEmptyData(){switch(this._type){case d.b:this._previousReturn={Id:"",ReportEmbedUrl:"",ReportName:"",ReportObjectId:"",ReportWebUrl:"",WorkspaceObjectId:""}}}_updatePreviousReturn(e,t,r,n){var a;switch(this._type){case d.b:const o=null===(a=n.Parameters.PowerBIFilter)||void 0===a?void 0:a.Value;this._previousReturn=Object.assign(Object.assign({},t),{PowerBIContextualFilter:o?Object(i.b)(e,r,o):""})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const m="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISolutionComponentSelector";function p(){const e={[d.b]:{},[d.a]:{}};return(t,r,i,a,o)=>{n.a.info(i.controlId+"."+m+": createGetPowerBISolutionComponentData started");const s=a.Parameters[t].Value,c=a.Parameters[t].Type;e[c][s]||(e[c][s]=new b(s,c));const l=e[c][s];return l.retrievePowerBISolutionComponentObject(r,i,a),n.a.info(i.controlId+"."+m+": createGetPowerBISolutionComponentData finished"),l}}},WA3M:function(e,t,r){"use strict";r.d(t,"a",(function(){return z}));var n=r("Yx7Y"),i=r("SAYH"),a=r("eXjw"),o=r("arV0"),s=r("69Qu"),c=r("FZDd"),l=r("iZ7K"),u=r("nmJf"),d=r("odYE"),b=r("Lohl"),m=r("BJ7u"),p=r("a72m"),h=r("BFlg"),f=r("d0w6"),g=r("nIfK"),O=r("HfZT"),v=r("6Qf/"),y=r("P6DH"),j=r("jAuy"),P=r("dQnL"),I=r("d0Pd"),C=r("3/02"),S=r("Lyxw"),w=r("ANW1"),T=r("fSnw"),F=r("CngE"),N=r("ngeo"),R=r("g03H"),_=r("5R5s"),E=r("G4xW"),D=r("85o3"),k=r("IqkD"),V=r("pEXn"),A=r("Uv1Y");var x=r("vNXc"),B=r("fYtF"),W=r("37s6"),L=r("Gn6i"),U=r("+cBJ"),M=r("i1f0");function z(e,t,r,z,Q,q,G,K,Y=(()=>7),Z,J,X=!0,$=!1){const ee=[],te=[],re=function(e,t,r,E,z,Q,q,G,K,Y=!0,Z=!1){const J=Object(o.p)(e(),E),X={},$=function(e,t,r){const n=[],a=[],o={},s={};return(c,l,u)=>{const d=[],b=l.controlParameters,m=i.a.tryParseOrNull(l.viewId)?i.a.tryParseOrNull(l.viewId):i.a.tryParseOrNull(b.ViewId),h=i.a.toString(m),g=i.a.tryParseOrNull(b.VisualizationId),O=i.a.toString(g);if("true"===b.EnableChartPicker&&-1===n.indexOf(l.entityLogicalName)){n.push(l.entityLogicalName);const e=c(Object(P.a)(l.entityLogicalName,l.chartType)),i=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve chart dispatched",i),d.push(e)}if(Object(S.f)(e(),C.R)&&"true"===b.EnableViewPicker&&-1===a.indexOf(l.entityLogicalName)){a.push(l.entityLogicalName);const e=c(Object(p.a)(l.entityLogicalName,f.a.MAIN_APPLICATION_VIEW,void 0,void 0,!0)),n=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve view dispatched",n),d.push(e)}return O&&(o[O]||(o[O]=c(Object(P.a)(l.entityLogicalName,l.chartType,g)).catch(e=>{const n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"VisualizationId",value:O},{name:"ChartType",value:l.chartType},{name:"ErrorCode",value:Object(R.l)(n)?"":"0x"+N.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",i)})),u.push(o[O]),d.push(o[O])),h&&(s[h]||(s[h]=c(Object(p.a)(l.entityLogicalName,void 0,l.viewType,m)).catch(e=>{const n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),i=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"ViewId",value:h},{name:"ViewType",value:l.viewType},{name:"ErrorCode",value:Object(R.l)(n)?"":"0x"+N.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",i)})),u.push(s[h]),d.push(s[h])),d}}(e,t,J),ee=function(e,t,r,n,a,o){const s=[],c={},l=Object(g.c)(e,n,a,o);return(a,o)=>{const u=o.controlParameters,d=Object(g.e)(o);let b,m=c[d];if(!m){const t=e(),r=o.entityLogicalName,n=Object(k.q)(t);if(t&&r&&n){const e=Object(S.f)(t,C.ag),i=Object(_.a)(r,n,o.contextToken,e,null,!0).getFilterAndLinkedEntities(D.a,!0);if(i){if(o.getCustomFilter){const e=o.getCustomFilter();if(e&&e.filter){const t=i.filter,r={conditions:[],filterOperator:0,filters:[e.filter,t]};i.filter=r}e&&e.linkEntities&&i.linkEntities.push(...e.linkEntities)}o.getCustomFilter=()=>i}}m=l(o),c[d]=m}const p=u.ChartDrillDownParameters;if(p&&p.length>0){const n=p[p.length-1];b=new w.a(e,i.a.tryParse(u.VisualizationId),i.a.tryParse(o.viewId),o.chartType,o.viewType,n.groupByAttribute.name,n.groupByAttribute.relatedEntityName,n.chartType);const a=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:u.VisualizationId},{name:"DrilldownAttributeName",value:n.groupByAttribute.name},{name:"DrilldownChartType",value:n.chartType}];t.info(r+" page, retrieve chart drilldown data dispatched",a)}else{b=new T.a(e,i.a.tryParse(u.VisualizationId),i.a.tryParse(o.viewId),o.chartType,o.viewType);const n=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:u.VisualizationId}];t.info(r+" page, retrieve chart data dispatched",n)}const h=Object(y.tb)(e(),i.a.tryParse(o.viewId),n),f=Object(F.a)(e(),i.a.tryParse(u.VisualizationId));return f&&f.DataDescription&&(m&&m.fetchXml||h&&h.fetchXML)&&(b.initialize(f.DataDescription,m.fetchXml?m.fetchXml:h.fetchXML,f.PresentationDescription,h.title,h.entityLogicalName,f.Name,f.PrimaryEntityTypeCode,!i.a.isNullOrEmpty(f.WebResourceId)),b.setupAggregationQueries()),-1===s.indexOf(b.getStorageKey())?(s.push(b.getStorageKey()),a(Object(I.a)(b,o.entityLogicalName,n,!1))):null}}(e,t,J,E,z,Q),te=function(e,t,r,a,o){const c=[],l={},h={},g={};return(O,v,y,j)=>{var P,I;const w=[],T=v.entityLogicalName,F=v.controlParameters;if(v.ribbonContext){const e=v.ribbonContext+T;if(-1===c.indexOf(e)){c.push(e);const n=O(Object(u.a)(e,j));w.push(n);const i=[{name:"TargetEntityType",value:T},{name:"RibbonContext",value:v.ribbonContext}];t.info(r+" page, retrieve ribbon dispatched",i)}}const N=v.cardFormId;if(N&&(!i.a.equals(N,n.a)||"activitypointer"!==T)){const e=i.a.equals(N,n.a)?null:N,a=e?e.guid:v.entityLogicalName;if(!l[a]){const n=O(Object(b.d)(new d.a(T),e,Object(m.a)(11)));l[a]=n,w.push(n);const i=[{name:"TargetEntityType",value:T},{name:"FormId",value:N&&N.guid}];t.info(r+" page, retrieve card form dispatched",i)}y.push(l[a])}if(!(1===v.gridType||"true"!==F.EnableViewPicker||g[T]&&g[T].allViews)){g[T]||(g[T]={allViews:!1,viewIds:[]});const n=g[T],a=F.ViewIds,c=a&&a.split(",");if(c&&0!==c.length){for(const e of c)if(-1===n.viewIds.indexOf(e)){n.viewIds.push(e);const a=i.a.tryParseOrNull(e);if(a){const n=O(Object(p.a)(T,void 0,void 0,a,void 0,o));w.push(n);const i=[{name:"TargetEntityType",value:T},{name:"ViewId",value:e}];t.info(r+" page, retrieve view dispatched",i)}}}else{if(n.allViews=!0,0===v.gridType){const e=O(Object(p.a)(T,f.a.SUB_GRID,void 0,void 0,void 0,o));w.push(e)}const i=e(),a=Object(S.f)(i,C.Fc)&&Object(s.c)(i)&&!(null===(I=null===(P=i.metadata)||void 0===P?void 0:P.formUserViewsRetrievedByEntity)||void 0===I?void 0:I[T]);a&&O(Object(U.b)(T,!0));const c=O(Object(p.a)(T,f.a.MAIN_APPLICATION_VIEW,void 0,void 0,!!a||void 0,o,void 0,!!a||void 0)).catch(e=>{throw O(Object(U.b)(T,!1)),e});w.push(c);const l=[{name:"TargetEntityType",value:T}];t.info(r+" page, retrieve all views dispatched",l)}}const R=v.viewId;if(h[R])v.viewId=h[R];else{const e="true"===F.IsUserView?f.b.userview:f.b.savedview,n=v.pinnedEntityLogicalName;let o=0===v.gridType?f.a.SUB_GRID:f.a.MAIN_APPLICATION_VIEW,s=n||T;v.quickFindSearchString&&(o=f.a.QUICKFIND_SEARCH,s=v.quickFindEntityIfActivity||s);const c=O(function(e,t,r,n){return{type:"view.retrieveornull.async",execute({dispatch:i,getState:a},o,s){const c=i(Object(p.a)(e,t,r,n));return new Promise(i=>{c.then(e=>i(e),a=>{const s=o.TraceManager.getTracer("view.retrieveornull.async"),c=[{name:V.b.EntityName,value:e},{name:V.b.ViewId,value:n&&n.guid||""},{name:"ViewType",value:r},{name:"SavedQueryType",value:t}];return s.warn("Retrieve view or null : retrieve of view failed : "+Object(A.d)(a),c),i(null)})})}}}(s,o,e,i.a.tryParseOrNull(R))).then(e=>{if(R&&!e&&a){t.warn("Pinned view retrieval failed. Loading default view.");return O(Object(p.a)(T,f.a.MAIN_APPLICATION_VIEW)).then(e=>r(e))}return r(e);function r(e){const t=e&&e.guid;if(v.viewId=t,h[R]=t,v.onViewRetrieve)return v.onViewRetrieve(e)}});w.push(c),y.push(c);const l=[{name:"TargetEntityType",value:T},{name:"ViewId",value:R}];t.info(r+" page, retrieve view dispatched from retrieveControlMetadataAndData",l)}return w}}(e,t,J,Y,Z),re=function(e,t,r,n,i,o){const s={},c=Object(g.b)(e,n,i,o);return(i,o,l,u,d)=>{var b,m;const p=[],h=o.entityLogicalName,f=o.viewId;if(f){const j=Object(g.e)(o);let P=s[j];if(!P){const l=c(o);if(P=P instanceof x.a?l&&l.getQueryState():l&&l.getQueryState(e),!P)return p;s[j]=P,Object(B.c)(P,null===(b=o.contextToken)||void 0===b?void 0:b.contextTokenType,null===(m=o.control)||void 0===m?void 0:m.Id);const d=!Object(S.f)(e(),C.dh)||!Object(M.fd)(e(),n,o.control);if(u&&d){i(Object(O.e)(P,n)).catch(()=>{const e={lists:{[P.key]:{initialized:a.a.Error,lastRetrieved:new Date,pageSize:l.pageSize}}};i({type:O.b,payload:e})});const e=[{name:"TargetEntityType",value:h},{name:"ViewId",value:f}];t.info(r+" page, retrieve grid data dispatched",e)}}if(d){const t=o.controlParameters.RelationshipName,r=Object(y.gb)(e(),h,t),a=i(Object(v.d)(P,h,n,o.contextToken,o.control,t,r,void 0,l));if(p.push(a),o.onInitializeGrid){const e=a.then(o.onInitializeGrid);p.push(e)}}else if(o.onInitializeGrid){const e=o.onInitializeGrid();p.push(e)}const I=[{name:"TargetEntityType",value:h},{name:"ViewId",value:f}];return t.info(r+" page, initialize grid dispatched",I),p}}}(e,t,J,E,z,Q),ne=function(e){if(e&&e.FormType){const t=Object(m.a)(e.FormType);return`${h.N}.${h.O}.${t}`}return""}(z),ie=H(q,2),ae=H(q,4);return n=>({type:"retrieveControlMetadataAndData.loadControl",execute:({dispatch:u})=>{const d=function(e,t){if(e&&t&&t.hasGrid&&t.control&&t.controlParameters){const r=[];return r.push({name:"FormId",value:i.a.toString(e.Id)}),r.push({name:"ViewId",value:t.viewId}),r.push({name:"IsUserView",value:t.controlParameters.IsUserView}),r.push({name:"ControlId",value:t.control.Id}),r}return null}(z,n),b=ae(n)&&Object(W.E)(e())?Object(s.b)(e()):Object(s.c)(e()),m=[],p=[],h=n.hasGrid&&n.ribbonContext&&n.contextToken&&Object(j.c)(E,n.contextToken),f=n.entityLogicalName;let g=X[f];if(!g){const e=G&&G(f);g=u(Object(c.f)(f,e,[])),X[f]=g}const O=[],v=n.hasChart&&b&&$(u,n,O);p.push(...O),v&&m.push(...v);const y=[],P=n.hasGrid&&te(u,n,y,E);p.push(...y),P&&(m.push(...P),0===n.gridType&&Promise.all(y).catch(e=>{r.ReportComponentFailure(ne,e,null,d)}));const I=K&&K(n,p);I&&m.push(...I);const C=Promise.all([g,...p]).then(()=>{const r=Object(o.j)(e(),E);return Object(L.c)(r,E,e,u,t,d)}).then(()=>{const t=Object(l.h)(e(),f);if(t&&t.Initialized===a.a.Initialized&&!t.IsEnabledInUnifiedInterface)return;const i=(Object(W.E)(e())?Object(s.b)(e()):Object(s.c)(e()))&&b,o=[],c=n.hasChart&&i&&ee(u,n);c&&o.push(c);const m=n.hasGrid&&re(u,n,h,ae(n),ie(n));return m&&(o.push(...m),0===n.gridType&&Promise.all(m).then(()=>{r.ReportComponentSuccess(ne,d)},e=>{r.ReportComponentFailure(ne,e,null,d)})),Promise.all(o)});return m.push(C),Promise.all(m)}})}(e,r,z,Q,q,G,Y,Z,J,X,$),ne=H(Y,1),ie=H(Y,0);for(const e in K){const r=K[e];if(ne(r))ee.push(t(re(r)));else if(!ie(r)){const e=Object(E.a)(re(r));te.push(t(e))}}return{inProgress:ee,preload:te}}function H(e,t){return 0===t?t=>0===e(t):r=>!!(e(r)&t)}},aF78:function(e,t,r){"use strict";r.d(t,"a",(function(){return P})),r.d(t,"b",(function(){return I}));var n=r("arV0"),i=r("xhhr"),a=r("dHD5"),o=r("odYE"),s=r("i1f0"),c=r("Lyxw"),l=r("3/02"),u=r("NjDY"),d=r("b8TU"),b=r("unFF"),m=r("bT7G"),p=r("WPtp"),h=r("SAYH"),f=r("6QGX"),g=r("uhZ3"),O=r("jq7Z"),v=r("zmL5"),y=r("5ZBI"),j=r("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class P{constructor(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:T,beginSecureSessionForResource:T},this._propKey=e}linkToParameter(e,t){const r=t.setPowerBISignedInState;e.setPowerBISignedInState=e=>r(this._pageId,e);const n=t.beginSecureSessionForResource;e.beginSecureSessionForResource=n}retrievePowerBIObject(e,t,r,n){var a,o;this._pageId=t.id;const s=t.descriptor.Parameters,m=Object(i.b)(e),p=r.Parameters[this._propKey],h=Object(u.F)(e);let f,g,y;Object(c.f)(e,l.Sf)&&(g=s.PowerBIReportId,y=p.PowerBIReportId,s.PowerBIFilter&&(f=I(e,this._pageId,s.PowerBIFilter)));const j=Object(O.a)(e,this._pageId).powerBISignedInState,P=Object(v.b)(e,this._pageId),C=Object(d.c)(e),S=Object(b.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(a=p.EnableInMobile)||void 0===a?void 0:a.toString().toLowerCase())||"true"===(null===(o=s.EnableInMobile)||void 0===o?void 0:o.toString().toLowerCase()),PowerBIGroupId:p.PowerBIGroupId||s.PowerBIGroupId,PowerBIDashboardId:p.PowerBIDashboardId||s.PowerBIDashboardId,PowerBIReportId:y||g,PowerBIFilter:f,TileId:p.TileId||s.TileId,TileUrl:p.TileUrl||s.TileUrl,PowerBIType:parseInt(p.PowerBIType,10)||parseInt(s.Type,10)||0,IsPowerBIEnabled:m.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:m.firstPartyIntegrationSiteUrl,PowerBISignedInState:j,Tenant:h,ForceMobile:C<=S.sizes.Breakpoints.DimensionS,FormId:P,setPowerBISignedInState:T,beginSecureSessionForResource:T},this.previousReturn}getLatestData(){return this.previousReturn}}function I(e,t,r){const{entityTypeName:i,id:c}=Object(n.j)(e,t),l=Object(a.j)(e,t),u=Object(s.hc)(e,t,l),d=new o.a(i,c);try{const t=JSON.parse(r);let n=t.Filter;const i=t.Alias;for(const t in i){const r=i[t],a=Object(m.e)(e,u,d,r),o=a&&w(a)||null;if(Array.isArray(o)){const e=o.map(e=>S(e,!1)).join(",");n=n.split(t).join(e)}else n=C(n,[{placeholder:`"${t}"`,value:S(o,!0)},{placeholder:`'${t}'`,value:null===o?S(o,!0):`'${encodeURIComponent(o)}'`},{placeholder:t,value:S(o,!1)}])}return n}catch(e){return void y.a.error(j.m,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:r}])}}function C(e,t,r=0){const{placeholder:n,value:i}=t[r],a=e.split(n),o=r+1;if(o<t.length)for(const e in a)a[e]=C(a[e],t,o);return e=a.join(i)}function S(e,t){if(!t&&(null==e?void 0:e.length)>0){const t=Number(e);if(!isNaN(t)&&t.toString()===e)return JSON.stringify(t)}return JSON.stringify(e)}function w(e){if(Object(p.i)(e))return e.valueString;if(Object(p.g)(e))return h.a.toString(e.id);if(Object(p.k)(e))return e.reference&&h.a.toString(e.reference.id);if(Object(p.j)(e))return!Object(g.a)(e.value)&&e.value.toString();if(Object(p.h)(e)){const t=Object(f.h)(e);if(t){return t.map(e=>h.a.toString(h.a.fromExternalGuid(e.id)))}}else if(Object(p.f)(e)&&e.innerValue)return w(e.innerValue)}function T(){throw new Error("Not Replaced")}},npAL:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("dHD5"),i=r("5d8d"),a=r("uxy2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e){Object.assign(this,e)}executeNotifyHandlersThatEventOccurred(e){throw new Error("Not Replaced")}executeUpdateCurrentSearchText(e){throw new Error("Not Replaced")}executeUpdateSearchResults(e){throw new Error("Not Replaced")}executeUpdateSelectedResult(e){throw new Error("Not Replaced")}}var s=r("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{constructor(e,t){this.objectWrapperType=2,this.previousReturn=new o({pageId:null,controlId:null,contextToken:null,showLabel:!1,isOnPremises:!1,label:"",records:null,isKnowledgeManagementEnabled:!1,currentSearchText:"",entityDisplayName:"",isControlDisabled:!1,urlQueryParams:null,filterQueryParams:null,entityReference:null,searchWidgetActionResult:null,hideSearchOnRecordLoad:!1,blockClick:!1,descriptors:{numberOfResults:10,showArticleStatusFilter:!1,articleStatusFilter:"",showLanguageFilter:!1,languageFilter:"",isAutoSuggestionsEnabled:!1,enableRating:"",showRatingUsing:"",selectDefaultLanguage:"",selectPrimaryCustomer:"",mappedFields:[],enableMDF:!1,allowDisablingMDFOnUI:!1,showContextualActions:"",actionList:[]},executeNotifyHandlersThatEventOccurred:null,executeUpdateCurrentSearchText:null,executeUpdateSearchResults:null,executeUpdateSelectedResult:null}),this._previousControlStateId={},this._propKey=t,this._executeUpdateCurrentSearchText=(t,r)=>e(Object(a.d)(t,r)),this._executeUpdateSearchResults=(t,r)=>e(Object(a.f)(t,r)),this._executeUpdateSelectedResult=(t,r)=>e(Object(a.g)(t,r))}linkToParameter(e,t){const r=t.executeNotifyHandlersThatEventOccurred;e.executeNotifyHandlersThatEventOccurred=this.executeNotifyHandlersThatEventOccurred.bind(this,r),e.executeUpdateCurrentSearchText=this._executeUpdateCurrentSearchText,e.executeUpdateSearchResults=this._executeUpdateSearchResults,e.executeUpdateSelectedResult=this._executeUpdateSelectedResult}retrieveSearchWidgetObject(e,t,r,a,c){const l="hideSearchOnRecordLoad"in t.descriptor&&!!t.descriptor.hideSearchOnRecordLoad,u={};let d=!1;const b=l?t.descriptor.contextToken:Object(n.o)(c,t.controlId),m=Object(n.w)(b),p=e.searchWidget.list&&e.searchWidget.list[m];this._searchWidgetDescriptor=t.descriptor;const h=Object(i.j)(a);if(t.descriptor){u[this._propKey]=new o({pageId:t.id,controlId:t.controlId,contextToken:b,records:p?e.searchWidget.list[m].records:null,label:this._searchWidgetDescriptor.Label,showLabel:this._searchWidgetDescriptor.ShowLabel,isOnPremises:Object(i.i)(e),urlQueryParams:h?null:this._getUrlQueryParams(a),filterQueryParams:p?e.searchWidget.list[m].filterQueryParams:null,blockClick:h?!!p&&e.searchWidget.list[m].blockClick:p&&!Object(s.a)(e.searchWidget.list[m].blockClick)?e.searchWidget.list[m].blockClick:a.blockClick,descriptors:l?t.descriptor.descriptors:{articleStatusFilter:this._searchWidgetDescriptor.Parameters.FilterResults,showArticleStatusFilter:"true"===this._searchWidgetDescriptor.Parameters.AllowChangingFiltersOnUI,languageFilter:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,showLanguageFilter:"true"===this._searchWidgetDescriptor.Parameters.ShowLanguageFilter,numberOfResults:this._searchWidgetDescriptor.Parameters.NumberOfResults,isAutoSuggestionsEnabled:this._searchWidgetDescriptor.Parameters.EnableAutoSuggestions,enableRating:this._searchWidgetDescriptor.Parameters.EnableRating,showRatingUsing:this._searchWidgetDescriptor.Parameters.ShowRatingUsing,selectDefaultLanguage:this._searchWidgetDescriptor.Parameters.SelectDefaultLanguage,selectPrimaryCustomer:this._searchWidgetDescriptor.Parameters.SelectPrimaryCustomer,mappedFields:this._searchWidgetDescriptor.Parameters.hasOwnProperty("MappedFields")?JSON.parse(this._searchWidgetDescriptor.Parameters.MappedFields):[],enableMDF:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("EnableMDF")&&"true"===this._searchWidgetDescriptor.Parameters.EnableMDF.toLowerCase(),allowDisablingMDFOnUI:!!this._searchWidgetDescriptor.Parameters.hasOwnProperty("AllowDisablingMDFOnUI")&&"true"===this._searchWidgetDescriptor.Parameters.AllowDisablingMDFOnUI.toLowerCase(),showContextualActions:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ShowContextualActions")?this._searchWidgetDescriptor.Parameters.ShowContextualActions:"",actionList:this._searchWidgetDescriptor.Parameters.hasOwnProperty("ActionList")&&this._searchWidgetDescriptor.Parameters.ActionList?this._searchWidgetDescriptor.Parameters.ActionList.split(",").map(e=>parseInt(e,10)):[]},isKnowledgeManagementEnabled:!h||Object(i.h)(e,a.entityTypeName),entityDisplayName:h?Object(i.b)(e,a.entityTypeName):"",isControlDisabled:!!p&&e.searchWidget.list[m].isControlDisabled,hideSearchOnRecordLoad:!1,currentSearchText:p?e.searchWidget.list[m].currentSearchText:null,entityReference:{Id:h?a.id:"",Name:h&&e.metadata.entities[a.entityTypeName]?e.metadata.entities[a.entityTypeName].PrimaryNameAttribute:null,LogicalName:h?a.entityTypeName:""},searchWidgetActionResult:p?e.searchWidget.list[m].searchWidgetActionResult:null,executeNotifyHandlersThatEventOccurred:e=>{},executeUpdateCurrentSearchText:e=>{},executeUpdateSearchResults:e=>{},executeUpdateSelectedResult:e=>{}});let r=!1;"hideSearchOnRecordLoad"in t.descriptor&&t.descriptor.hideSearchOnRecordLoad&&p&&(u[this._propKey].hideSearchOnRecordLoad=t.descriptor.hideSearchOnRecordLoad,u[this._propKey].kbSearchResultActions=t.descriptor.kbSearchResultActions,u[this._propKey].records=[],u[this._propKey].records.push(t.descriptor.records[0]),r=!0),this._searchWidgetDescriptor&&(!this.previousReturn||!p||this._previousControlStateId[m]!==e.searchWidget.list[m].controlStateId||this.previousReturn.label!==u[this._propKey].label||this.previousReturn.showLabel!==u[this._propKey].showLabel||this.previousReturn.currentSearchText!==u[this._propKey].currentSearchText||this._filterQueryParamsHaveChanged(u[this._propKey].filterQueryParams)||this.previousReturn.blockClick!==u[this._propKey].blockClick||this._descriptorsHaveChanged(u[this._propKey].descriptors)||!this.previousReturn.entityReference&&u[this._propKey].entityReference||this.previousReturn.entityReference&&!u[this._propKey].entityReference||this.previousReturn.entityReference&&u[this._propKey].entityReference&&this.previousReturn.entityReference.Id!==u[this._propKey].entityReference.Id||this.previousReturn.searchWidgetActionResult!==u[this._propKey].searchWidgetActionResult)&&(r=!0),d=r}return d&&(this.previousReturn=u[this._propKey],p&&(this._previousControlStateId[m]=e.searchWidget.list[m].controlStateId)),this.previousReturn}getLatestData(){return this.previousReturn}executeNotifyHandlersThatEventOccurred(e,t,r){e(t,r)}_getUrlQueryParams(e){return{queryString:e.query,sort:e.sort,enableSelection:e.enableSelection,enableContextualActions:e.enableContextualActions}}_filterQueryParamsHaveChanged(e){return!this.previousReturn.filterQueryParams&&!!e||!!this.previousReturn.filterQueryParams&&!e||!!this.previousReturn&&!!e&&(this.previousReturn.filterQueryParams.command!==e.command||this.previousReturn.filterQueryParams.value!==e.value)}_descriptorsHaveChanged(e){return this.previousReturn.descriptors.articleStatusFilter!==e.articleStatusFilter||this.previousReturn.descriptors.showArticleStatusFilter!==e.showArticleStatusFilter||this.previousReturn.descriptors.languageFilter!==e.languageFilter||this.previousReturn.descriptors.showLanguageFilter!==e.showLanguageFilter||this.previousReturn.descriptors.numberOfResults!==e.numberOfResults}}var l=r("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const u="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlSearchWidgetSelector";function d(e){return()=>{const t={},r={},n={};return(i,a,o,s,d,b)=>{l.a.info(o.controlId+"."+u+": createGetSearchWidgetData started");let m=!1;n.hasOwnProperty(i)&&n[i]||(n[i]=new c(e,i));const p=n[i],h=p.retrieveSearchWidgetObject(a,o,s,d,b);return r.hasOwnProperty(i)&&r[i]&&h===r[i]||(r[i]=h,m=!0),m&&(t[i]=p),l.a.info(o.controlId+"."+u+": createGetSearchWidgetData finished"),t[i]}}}}}]),window.bundleExecutionMarkers["scripts/26.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();